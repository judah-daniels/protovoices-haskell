<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Deterministic and probabilistic values</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Numeric.Probability.Distribution</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.Probability.Show.html"><span class="hs-identifier">Numeric.Probability.Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Show.html#showR"><span class="hs-identifier">showR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Numeric.Probability.Shape.html"><span class="hs-identifier">Numeric.Probability.Shape</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Shape</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Applicative</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.HT</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ListHT</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tuple.HT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapFst</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord.HT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Eq.HT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">equating</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- * Events</span><span>
</span><span id="line-24"></span><span class="hs-keyword">type</span><span> </span><span id="Event"><span class="annot"><a href="Numeric.Probability.Distribution.html#Event"><span class="hs-identifier hs-var">Event</span></a></span></span><span> </span><span id="local-6989586621679064458"><span class="annot"><a href="#local-6989586621679064458"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679064458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span id="local-6989586621679064792"><span class="annot"><a href="Numeric.Probability.Distribution.html#oneOf"><span class="hs-identifier hs-type">oneOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064792"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-27"></span><span id="oneOf"><span class="annot"><span class="annottext">oneOf :: forall a. Eq a =&gt; [a] -&gt; Event a
</span><a href="Numeric.Probability.Distribution.html#oneOf"><span class="hs-identifier hs-var hs-var">oneOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span id="local-6989586621679064784"><span class="annot"><a href="Numeric.Probability.Distribution.html#just"><span class="hs-identifier hs-type">just</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064784"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064784"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064784"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-30"></span><span id="just"><span class="annot"><span class="annottext">just :: forall a. Eq a =&gt; a -&gt; Event a
</span><a href="Numeric.Probability.Distribution.html#just"><span class="hs-identifier hs-var hs-var">just</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; Event a
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- * Distributions</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">{- |
Probability disribution

The underlying data structure is a list.
Unfortunately we cannot use a more efficient data structure
because the key type must be of class 'Ord',
but the 'Monad' class does not allow constraints for result types.
The Monad instance is particularly useful
because many generic monad functions make sense here,
monad transformers can be used
and the monadic design allows to simulate probabilistic games in an elegant manner.

We have the same problem like making &quot;Data.Set&quot; an instance of 'Monad',
see &lt;http://www.randomhacks.net/articles/2007/03/15/data-set-monad-haskell-macros&gt;

If you need efficiency, you should remove redundant elements by 'norm'.
'norm' converts to 'Data.Map' and back internally
and you can hope that the compiler fuses the lists with the intermediate Map structure.

The defined monad is equivalent to
@WriterT (Product prob) [] a@.
See &lt;http://www.randomhacks.net/articles/2007/02/21/refactoring-probability-distributions&gt;.
-}</span><span>
</span><span id="line-59"></span><span class="hs-keyword">newtype</span><span> </span><span id="T"><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-var">T</span></a></span></span><span> </span><span id="local-6989586621679064782"><span class="annot"><a href="#local-6989586621679064782"><span class="hs-identifier hs-type">prob</span></a></span></span><span> </span><span id="local-6989586621679064781"><span class="annot"><a href="#local-6989586621679064781"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cons"><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span></span><span> </span><span class="hs-special">{</span><span id="decons"><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var hs-var">decons</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064782"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679064777"><span id="local-6989586621679064778"><span class="annot"><a href="Numeric.Probability.Distribution.html#certainly"><span class="hs-identifier hs-type">certainly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064778"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064778"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064777"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-62"></span><span id="certainly"><span class="annot"><span class="annottext">certainly :: forall prob a. Num prob =&gt; a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#certainly"><span class="hs-identifier hs-var hs-var">certainly</span></a></span></span><span> </span><span id="local-6989586621679064442"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064442"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064442"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064437"><span id="local-6989586621679064768"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064768"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064768"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679064433"><span class="annot"><span class="annottext">return :: forall a. a -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#certainly"><span class="hs-identifier hs-var">certainly</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679064431"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064431"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679064430"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. T prob a -&gt; (a -&gt; T prob b) -&gt; T prob b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679064429"><span class="annot"><span class="annottext">a -&gt; T prob b
</span><a href="#local-6989586621679064429"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064428"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064427"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064425"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064424"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064424"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064425"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064425"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064431"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064428"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064428"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064427"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064427"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; T prob b
</span><a href="#local-6989586621679064429"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064424"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064413"><span id="local-6989586621679064415"><span id="local-6989586621679064417"><span id="local-6989586621679064423"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064423"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064423"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679064410"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#certainly"><span class="hs-identifier hs-var">certainly</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679064408"><span class="annot"><span class="annottext">T prob (a -&gt; b)
</span><a href="#local-6989586621679064408"><span class="hs-identifier hs-var">fm</span></a></span></span><span> </span><span id="local-6989586621679064407"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. T prob (a -&gt; b) -&gt; T prob a -&gt; T prob b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679064406"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064406"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064403"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064402"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064405"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064405"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064402"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064402"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="annot"><span class="annottext">T prob (a -&gt; b)
</span><a href="#local-6989586621679064408"><span class="hs-identifier hs-var">fm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064404"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064403"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064403"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064406"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">{-
Dist cannot be an instance of MonadPlus,
because there is no mzero
(it would be an empty list of events, but their probabilities do not sum up to 1)
and thus it breaks the normalization for the &gt;&gt;= combinator.
See for instance the Boys example:

   do f &lt;- family
      guard (existsBoy f)
      return f

mplus is not associative because we have to normalize the sum of probabilities to 1.

instance MonadPlus Dist where
  mzero      = Cons []
  mplus d d' =
     if isZero d || isZero d'
       then mzero
       else unfoldD $ choose 0.5 d d'

isZero :: Dist a -&gt; Bool
isZero (Cons d) = null d
-}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064399"><span id="local-6989586621679064753"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064753"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679064397"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; T prob a -&gt; T prob b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679064396"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064396"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064395"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064395"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064396"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064394"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064393"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064394"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064394"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064393"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064393"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064395"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679064743"><span class="annot"><a href="Numeric.Probability.Distribution.html#errorMargin"><span class="hs-identifier hs-type">errorMargin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679064743"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064743"><span class="hs-identifier hs-type">prob</span></a></span></span><span>
</span><span id="line-103"></span><span id="errorMargin"><span class="annot"><span class="annottext">errorMargin :: forall prob. RealFloat prob =&gt; prob
</span><a href="Numeric.Probability.Distribution.html#errorMargin"><span class="hs-identifier hs-var hs-var">errorMargin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064374"><span class="annot"><span class="annottext">eps :: prob
</span><a href="#local-6989586621679064374"><span class="hs-identifier hs-var hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">floatRadix</span></span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064374"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">floatDigits</span></span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064374"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-105"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064374"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">{- |
Check whether two distributions are equal when neglecting rounding errors.
We do not want to put this into an 'Eq' instance,
since it is not exact equivalence
and it seems to be too easy to mix it up with @liftM2 (==) x y@.
-}</span><span>
</span><span id="line-113"></span><span id="local-6989586621679064734"><span id="local-6989586621679064735"><span class="annot"><a href="Numeric.Probability.Distribution.html#approx"><span class="hs-identifier hs-type">approx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679064735"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064734"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-114"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064735"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064735"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-116"></span><span id="approx"><span class="annot"><span class="annottext">approx :: forall prob a.
(RealFloat prob, Ord a) =&gt;
T prob a -&gt; T prob a -&gt; Bool
</span><a href="Numeric.Probability.Distribution.html#approx"><span class="hs-identifier hs-var hs-var">approx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064353"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064353"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064352"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064352"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064349"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064349"><span class="hs-identifier hs-var">xse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064348"><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064348"><span class="hs-identifier hs-var">xsp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var">norm'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064353"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679064343"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064343"><span class="hs-identifier hs-var">yse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064342"><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064342"><span class="hs-identifier hs-var">ysp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var">norm'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064352"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064349"><span class="hs-identifier hs-var">xse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; Event a
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064343"><span class="hs-identifier hs-var">yse</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-120"></span><span>       </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064339"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064339"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064339"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall prob. RealFloat prob =&gt; prob
</span><a href="Numeric.Probability.Distribution.html#errorMargin"><span class="hs-identifier hs-var">errorMargin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064348"><span class="hs-identifier hs-var">xsp</span></a></span><span> </span><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064342"><span class="hs-identifier hs-var">ysp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- ** Auxiliary functions for constructing and working with distributions</span><span>
</span><span id="line-124"></span><span id="local-6989586621679064719"><span id="local-6989586621679064720"><span class="annot"><a href="Numeric.Probability.Distribution.html#lift"><span class="hs-identifier hs-type">lift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064720"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-125"></span><span>   </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064720"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064720"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064720"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064720"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064719"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-127"></span><span id="lift"><span class="annot"><span class="annottext">lift :: forall prob a.
Num prob =&gt;
([(a, prob)] -&gt; [(a, prob)]) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#lift"><span class="hs-identifier hs-var hs-var">lift</span></a></span></span><span> </span><span id="local-6989586621679064333"><span class="annot"><span class="annottext">[(a, prob)] -&gt; [(a, prob)]
</span><a href="#local-6989586621679064333"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(a, prob)] -&gt; [(a, prob)]
</span><a href="#local-6989586621679064333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621679064712"><span id="local-6989586621679064713"><span class="annot"><a href="Numeric.Probability.Distribution.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064713"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064712"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-130"></span><span id="size"><span class="annot"><span class="annottext">size :: forall prob a. T prob a -&gt; Int
</span><a href="Numeric.Probability.Distribution.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679064707"><span id="local-6989586621679064708"><span class="annot"><a href="Numeric.Probability.Distribution.html#check"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679064708"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064708"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064708"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064707"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064708"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064707"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="check"><span class="annot"><span class="annottext">check :: forall prob a. (RealFloat prob, Show prob) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#check"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064311"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; [(a, prob)] -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-var">sumP</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall prob. RealFloat prob =&gt; prob
</span><a href="Numeric.Probability.Distribution.html#errorMargin"><span class="hs-identifier hs-var">errorMargin</span></a></span><span>
</span><span id="line-135"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-136"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Illegal distribution: total probability = &quot;</span></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; [(a, prob)] -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-var">sumP</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | can fail because of rounding errors, better use 'fromFreqs'</span><span>
</span><span id="line-139"></span><span id="local-6989586621679064696"><span id="local-6989586621679064697"><span class="annot"><a href="Numeric.Probability.Distribution.html#cons"><span class="hs-identifier hs-type">cons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621679064697"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064697"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064697"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064697"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064696"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-140"></span><span id="cons"><span class="annot"><span class="annottext">cons :: forall prob a.
(RealFloat prob, Show prob) =&gt;
[(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#cons"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (RealFloat prob, Show prob) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621679064702"><span id="local-6989586621679064703"><span class="annot"><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-type">sumP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064703"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064702"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064703"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064703"><span class="hs-identifier hs-type">prob</span></a></span></span></span><span>
</span><span id="line-143"></span><span id="sumP"><span class="annot"><span class="annottext">sumP :: forall prob a. Num prob =&gt; [(a, prob)] -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-var hs-var">sumP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679064685"><span id="local-6989586621679064686"><span class="annot"><a href="Numeric.Probability.Distribution.html#sortP"><span class="hs-identifier hs-type">sortP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064686"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064686"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064686"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-146"></span><span id="sortP"><span class="annot"><span class="annottext">sortP :: forall prob a. Ord prob =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortP"><span class="hs-identifier hs-var hs-var">sortP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679064293"><span id="local-6989586621679064294"><span class="annot"><a href="Numeric.Probability.Distribution.html#sortPDesc"><span class="hs-identifier hs-type">sortPDesc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064294"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064293"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064294"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064293"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064294"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-149"></span><span id="sortPDesc"><span class="annot"><span class="annottext">sortPDesc :: forall prob a. Ord prob =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortPDesc"><span class="hs-identifier hs-var hs-var">sortPDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679064674"><span id="local-6989586621679064675"><span class="annot"><a href="Numeric.Probability.Distribution.html#sortElem"><span class="hs-identifier hs-type">sortElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064674"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064674"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-152"></span><span id="sortElem"><span class="annot"><span class="annottext">sortElem :: forall a prob. Ord a =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortElem"><span class="hs-identifier hs-var hs-var">sortElem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- ** Normalization = grouping</span><span>
</span><span id="line-156"></span><span id="local-6989586621679064669"><span id="local-6989586621679064670"><span class="annot"><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-type">norm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064670"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064670"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064669"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064670"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064669"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-157"></span><span id="norm"><span class="annot"><span class="annottext">norm :: forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var hs-var">norm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a.
Num prob =&gt;
([(a, prob)] -&gt; [(a, prob)]) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var">norm'</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621679064726"><span id="local-6989586621679064727"><span class="annot"><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-type">norm'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064727"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064727"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064727"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-160"></span><span id="norm%27"><span class="annot"><span class="annottext">norm' :: forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var hs-var">norm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>   </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679064272"><span id="local-6989586621679064273"><span class="annot"><a href="Numeric.Probability.Distribution.html#norm%27%27"><span class="hs-identifier hs-type">norm''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064273"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064273"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064273"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-164"></span><span id="norm%27%27"><span class="annot"><span class="annottext">norm'' :: forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27%27"><span class="hs-identifier hs-var hs-var">norm''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064261"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064261"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064261"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>         </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679064260"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064260"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(a, prob)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064260"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064261"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>         </span><span class="annot"><span class="annottext">[(a, prob)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Probability.Distribution.norm'': every sub-list in groupBy must be non-empty&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-169"></span><span>   </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">ListHT.groupBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Eq b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">equating</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a prob. Ord a =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortElem"><span class="hs-identifier hs-var">sortElem</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | pretty printing</span><span>
</span><span id="line-173"></span><span id="local-6989586621679064653"><span id="local-6989586621679064654"><span class="annot"><a href="Numeric.Probability.Distribution.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064654"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064654"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064653"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064653"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-174"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064653"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064653"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064654"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-175"></span><span id="pretty"><span class="annot"><span class="annottext">pretty :: forall a prob.
(Ord a, Show a, Num prob, Ord prob) =&gt;
(prob -&gt; [Char]) -&gt; T prob a -&gt; [Char]
</span><a href="Numeric.Probability.Distribution.html#pretty"><span class="hs-identifier hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><span class="annottext">prob -&gt; [Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Impossible&quot;</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Numeric.Probability.Distribution.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span id="local-6989586621679064248"><span class="annot"><span class="annottext">prob -&gt; [Char]
</span><a href="#local-6989586621679064248"><span class="hs-identifier hs-var">showProb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064247"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064247"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064241"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679064241"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064247"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679064238"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064238"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064237"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064237"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; [Char]
</span><a href="Numeric.Probability.Show.html#showR"><span class="hs-identifier hs-var">showR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064241"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064238"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">prob -&gt; [Char]
</span><a href="#local-6989586621679064248"><span class="hs-identifier hs-var">showProb</span></a></span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064237"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. Ord prob =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortPDesc"><span class="hs-identifier hs-var">sortPDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var">norm'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064247"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#%2F%2F%25"><span class="hs-operator hs-type">//%</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621679064644"><span class="annot"><a href="Numeric.Probability.Distribution.html#%2F%2F%25"><span class="hs-operator hs-type">(//%)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="annot"><a href="#local-6989586621679064644"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-185"></span><span id="%2F%2F%25"><span class="annot"><span class="annottext">//% :: forall a. (Ord a, Show a) =&gt; T Rational a -&gt; () -&gt; IO ()
</span><a href="Numeric.Probability.Distribution.html#%2F%2F%25"><span class="hs-operator hs-var hs-var">(//%)</span></a></span></span><span> </span><span id="local-6989586621679064221"><span class="annot"><span class="annottext">T Rational a
</span><a href="#local-6989586621679064221"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a prob.
(Ord a, Show a, Num prob, Ord prob) =&gt;
(prob -&gt; [Char]) -&gt; T prob a -&gt; [Char]
</span><a href="Numeric.Probability.Distribution.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">T Rational a
</span><a href="#local-6989586621679064221"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064215"><span id="local-6989586621679064217"><span id="local-6989586621679064637"><span id="local-6989586621679064638"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064638"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064638"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064638"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679064637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064638"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>   </span><span id="local-6989586621679064203"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; T prob a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679064201"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064201"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679064200"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064200"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064201"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fromFreqs &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. Ord prob =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#sortPDesc"><span class="hs-identifier hs-var">sortPDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; [(a, prob)] -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#norm%27"><span class="hs-identifier hs-var">norm'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679064200"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">{- |
We would like to have an equality test of type

&gt; (==) :: T prob a -&gt; T prob a -&gt; T prob Bool

that is consistent with the 'Num' instance.
We would certainly define

&gt; x==y = norm (liftM2 (==) x y)   .

However the 'Eq' class enforces the type

&gt; T prob a -&gt; T prob a -&gt; Bool    .

We could implement this as check for equal distributions.
This would be inconsistent with the 'Num' instance
because it compares entire distributions,
not only individual outcomes.
Thus we provide this function as 'equal'.

I would prefer to omit the 'Eq' instance completely,
but unfortunately the 'Num' instance requires 'Eq' as superclass.
-}</span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064194"><span id="local-6989586621679064631"><span id="local-6989586621679064632"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064632"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064631"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>   </span><span id="local-6989586621679064190"><span class="annot"><span class="annottext">== :: T prob a -&gt; T prob a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Probability.Distribution.== cannot be implemented sensibly.&quot;</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">{-
instance (Num prob, Ord a) =&gt; Eq (T prob a) where
   (==) = equal
-}</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679064629"><span id="local-6989586621679064630"><span class="annot"><a href="Numeric.Probability.Distribution.html#equal"><span class="hs-identifier hs-type">equal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064630"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064630"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064630"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064630"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-226"></span><span id="equal"><span class="annot"><span class="annottext">equal :: forall prob a.
(Num prob, Eq prob, Ord a) =&gt;
T prob a -&gt; T prob a -&gt; Bool
</span><a href="Numeric.Probability.Distribution.html#equal"><span class="hs-identifier hs-var hs-var">equal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Eq b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">equating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">{-
The Num operations consider their operands as independent distributions
(like all operations on distributions do).
All functions normalize their results if normalization is lost by the plain operation.
This is essential for performance.

Thus @sum $ replicate 10 d@ is significantly faster
than @fmap sum $ replicateM 10 d@
-}</span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064621"><span id="local-6989586621679064622"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064622"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064622"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064622"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>   </span><span id="local-6989586621679064164"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-239"></span><span>   </span><span id="local-6989586621679064159"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064159"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064158"><span class="annot"><span class="annottext">+ :: T prob a -&gt; T prob a -&gt; T prob a
</span><a href="#local-6989586621679064158"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span id="local-6989586621679064157"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064157"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064159"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064157"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>   </span><span id="local-6989586621679064152"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064152"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064151"><span class="annot"><span class="annottext">- :: T prob a -&gt; T prob a -&gt; T prob a
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span id="local-6989586621679064150"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064150"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064152"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064150"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>   </span><span id="local-6989586621679064145"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064145"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064144"><span class="annot"><span class="annottext">* :: T prob a -&gt; T prob a -&gt; T prob a
</span><a href="#local-6989586621679064144"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span id="local-6989586621679064143"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064143"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064145"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064143"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>   </span><span id="local-6989586621679064138"><span class="annot"><span class="annottext">abs :: T prob a -&gt; T prob a
</span><a href="#local-6989586621679064138"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span> </span><span id="local-6989586621679064137"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064137"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064137"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>   </span><span id="local-6989586621679064132"><span class="annot"><span class="annottext">signum :: T prob a -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span id="local-6989586621679064130"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064130"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064130"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>   </span><span id="local-6989586621679064127"><span class="annot"><span class="annottext">negate :: T prob a -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span id="local-6989586621679064126"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064126"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064126"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064610"><span id="local-6989586621679064611"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064611"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064611"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064611"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>   </span><span id="local-6989586621679064110"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-249"></span><span>   </span><span id="local-6989586621679064107"><span class="annot"><span class="annottext">recip :: T prob a -&gt; T prob a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></span></span><span> </span><span id="local-6989586621679064105"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064105"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064105"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-250"></span><span>   </span><span id="local-6989586621679064100"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064100"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064099"><span class="annot"><span class="annottext">/ :: T prob a -&gt; T prob a -&gt; T prob a
</span><a href="#local-6989586621679064099"><span class="hs-operator hs-var hs-var hs-var hs-var">/</span></a></span></span><span> </span><span id="local-6989586621679064098"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064098"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064100"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064098"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- * Spread: functions to convert a list of values into a distribution</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | distribution generators</span><span>
</span><span id="line-257"></span><span class="hs-keyword">type</span><span> </span><span id="Spread"><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-var">Spread</span></a></span></span><span> </span><span id="local-6989586621679064097"><span class="annot"><a href="#local-6989586621679064097"><span class="hs-identifier hs-type">prob</span></a></span></span><span> </span><span id="local-6989586621679064096"><span class="annot"><a href="#local-6989586621679064096"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064097"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064096"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">{- not a valid distribution
impossible :: T prob a
impossible = mzero
-}</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span id="local-6989586621679064608"><span id="local-6989586621679064609"><span class="annot"><a href="Numeric.Probability.Distribution.html#choose"><span class="hs-identifier hs-type">choose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064609"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064609"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064609"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064608"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-265"></span><span id="choose"><span class="annot"><span class="annottext">choose :: forall prob a. Num prob =&gt; prob -&gt; a -&gt; a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#choose"><span class="hs-identifier hs-var hs-var">choose</span></a></span></span><span> </span><span id="local-6989586621679064091"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064091"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679064090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064090"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064089"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064089"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064090"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064089"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064091"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064091"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679064602"><span id="local-6989586621679064603"><span class="annot"><a href="Numeric.Probability.Distribution.html#enum"><span class="hs-identifier hs-type">enum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064603"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064603"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064602"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-268"></span><span id="enum"><span class="annot"><span class="annottext">enum :: forall prob a. Fractional prob =&gt; [Int] -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#enum"><span class="hs-identifier hs-var hs-var">enum</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; [prob] -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#relative"><span class="hs-identifier hs-var">relative</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">{- |
Give a list of frequencies, they do not need to sum up to 1.
-}</span><span>
</span><span id="line-273"></span><span id="local-6989586621679064597"><span id="local-6989586621679064598"><span class="annot"><a href="Numeric.Probability.Distribution.html#relative"><span class="hs-identifier hs-type">relative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064598"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064598"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064598"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064597"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-274"></span><span id="relative"><span class="annot"><span class="annottext">relative :: forall prob a. Fractional prob =&gt; [prob] -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#relative"><span class="hs-identifier hs-var hs-var">relative</span></a></span></span><span> </span><span id="local-6989586621679064079"><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064079"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-var">fromFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064079"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621679064589"><span id="local-6989586621679064590"><span class="annot"><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064590"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-277"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064590"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064590"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064590"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064589"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-278"></span><span id="shape"><span class="annot"><span class="annottext">shape :: forall prob a. Fractional prob =&gt; (prob -&gt; prob) -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var hs-var">shape</span></a></span></span><span> </span><span class="annot"><span class="annottext">prob -&gt; prob
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Probability.shape: empty list&quot;</span></span><span>
</span><span id="line-279"></span><span class="annot"><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span id="local-6989586621679064071"><span class="annot"><span class="annottext">prob -&gt; prob
</span><a href="#local-6989586621679064071"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679064070"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064070"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064062"><span class="annot"><span class="annottext">incr :: prob
</span><a href="#local-6989586621679064062"><span class="hs-identifier hs-var hs-var">incr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064070"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>       </span><span id="local-6989586621679064059"><span class="annot"><span class="annottext">ps :: [prob]
</span><a href="#local-6989586621679064059"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">prob -&gt; prob
</span><a href="#local-6989586621679064071"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679064062"><span class="hs-identifier hs-var">incr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-var">fromFreqs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064070"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[prob]
</span><a href="#local-6989586621679064059"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621679064584"><span id="local-6989586621679064585"><span class="annot"><a href="Numeric.Probability.Distribution.html#linear"><span class="hs-identifier hs-type">linear</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064585"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064585"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064584"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-285"></span><span id="linear"><span class="annot"><span class="annottext">linear :: forall prob a. Fractional prob =&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#linear"><span class="hs-identifier hs-var hs-var">linear</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; (prob -&gt; prob) -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a
</span><a href="Numeric.Probability.Shape.html#linear"><span class="hs-identifier hs-var">Shape.linear</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span id="local-6989586621679064051"><span id="local-6989586621679064052"><span class="annot"><a href="Numeric.Probability.Distribution.html#uniform"><span class="hs-identifier hs-type">uniform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064052"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064052"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064051"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="uniform"><span class="annot"><span class="annottext">uniform :: forall prob a. Fractional prob =&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#uniform"><span class="hs-identifier hs-var hs-var">uniform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; (prob -&gt; prob) -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a
</span><a href="Numeric.Probability.Shape.html#uniform"><span class="hs-identifier hs-var">Shape.uniform</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span id="local-6989586621679064580"><span id="local-6989586621679064581"><span class="annot"><a href="Numeric.Probability.Distribution.html#negExp"><span class="hs-identifier hs-type">negExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679064581"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064581"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064580"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-291"></span><span id="negExp"><span class="annot"><span class="annottext">negExp :: forall prob a. Floating prob =&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#negExp"><span class="hs-identifier hs-var hs-var">negExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; (prob -&gt; prob) -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">forall prob. Floating prob =&gt; T prob
</span><a href="Numeric.Probability.Shape.html#negExp"><span class="hs-identifier hs-var">Shape.negExp</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621679064037"><span id="local-6989586621679064038"><span class="annot"><a href="Numeric.Probability.Distribution.html#normal"><span class="hs-identifier hs-type">normal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679064038"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064038"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064037"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-294"></span><span id="normal"><span class="annot"><span class="annottext">normal :: forall prob a. Floating prob =&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#normal"><span class="hs-identifier hs-var hs-var">normal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; (prob -&gt; prob) -&gt; Spread prob a
</span><a href="Numeric.Probability.Distribution.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">forall prob. Floating prob =&gt; T prob
</span><a href="Numeric.Probability.Shape.html#normal"><span class="hs-identifier hs-var">Shape.normal</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | extracting and mapping the domain of a distribution</span><span>
</span><span id="line-299"></span><span id="local-6989586621679064573"><span id="local-6989586621679064574"><span class="annot"><a href="Numeric.Probability.Distribution.html#extract"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064574"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-300"></span><span id="extract"><span class="annot"><span class="annottext">extract :: forall prob a. T prob a -&gt; [a]
</span><a href="Numeric.Probability.Distribution.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | 'fmap' with normalization</span><span>
</span><span id="line-303"></span><span id="local-6989586621679064568"><span id="local-6989586621679064569"><span id="local-6989586621679064570"><span class="annot"><a href="Numeric.Probability.Distribution.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064570"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-304"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064570"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064570"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064569"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-305"></span><span id="map"><span class="annot"><span class="annottext">map :: forall prob b a.
(Num prob, Ord b) =&gt;
(a -&gt; b) -&gt; T prob a -&gt; T prob b
</span><a href="Numeric.Probability.Distribution.html#map"><span class="hs-identifier hs-var hs-var">map</span></a></span></span><span> </span><span id="local-6989586621679064023"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064023"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064023"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">{- |
unfold a distribution of distributions into one distribution,
this is 'Control.Monad.join' with normalization.
-}</span><span>
</span><span id="line-312"></span><span id="local-6989586621679064563"><span id="local-6989586621679064564"><span class="annot"><a href="Numeric.Probability.Distribution.html#unfold"><span class="hs-identifier hs-type">unfold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064564"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-313"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064564"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064564"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064564"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064563"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-314"></span><span id="unfold"><span class="annot"><span class="annottext">unfold :: forall prob a. (Num prob, Ord a) =&gt; T prob (T prob a) -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#unfold"><span class="hs-identifier hs-var hs-var">unfold</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | conditional distribution</span><span>
</span><span id="line-318"></span><span id="local-6989586621679064557"><span id="local-6989586621679064558"><span class="annot"><a href="Numeric.Probability.Distribution.html#cond"><span class="hs-identifier hs-type">cond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064558"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-319"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064558"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064558"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">{-^ True -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064558"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">{-^ False -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064558"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064557"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-323"></span><span id="cond"><span class="annot"><span class="annottext">cond :: forall prob a.
Num prob =&gt;
T prob Bool -&gt; T prob a -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#cond"><span class="hs-identifier hs-var hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621679064013"><span class="annot"><span class="annottext">T prob Bool
</span><a href="#local-6989586621679064013"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679064012"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064012"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679064011"><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064011"><span class="hs-identifier hs-var">d'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">T prob Bool
</span><a href="#local-6989586621679064013"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679064010"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064012"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">T prob a
</span><a href="#local-6989586621679064011"><span class="hs-identifier hs-var">d'</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621679064554"><span class="annot"><a href="Numeric.Probability.Distribution.html#truth"><span class="hs-identifier hs-type">truth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064554"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064554"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064554"><span class="hs-identifier hs-type">prob</span></a></span></span><span>
</span><span id="line-326"></span><span id="truth"><span class="annot"><span class="annottext">truth :: forall prob. Num prob =&gt; T prob Bool -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#truth"><span class="hs-identifier hs-var hs-var">truth</span></a></span></span><span> </span><span id="local-6989586621679064000"><span class="annot"><span class="annottext">T prob Bool
</span><a href="#local-6989586621679064000"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord a) =&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#norm"><span class="hs-identifier hs-var">norm</span></a></span><span> </span><span class="annot"><span class="annottext">T prob Bool
</span><a href="#local-6989586621679064000"><span class="hs-identifier hs-var">dist</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679063999"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063999"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063998"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Bool, prob)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063999"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">prob
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Probability.truth: corrupt boolean random variable&quot;</span></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#%3E%3E%3D%3F"><span class="hs-operator hs-type">&gt;&gt;=?</span></a></span><span>
</span><span id="line-333"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#%3F%3D%3C%3C"><span class="hs-operator hs-type">?=&lt;&lt;</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | conditional probability, identical to 'Dist.filter'</span><span>
</span><span id="line-336"></span><span id="local-6989586621679064551"><span id="local-6989586621679064552"><span class="annot"><a href="Numeric.Probability.Distribution.html#%3F%3D%3C%3C"><span class="hs-operator hs-type">(?=&lt;&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064552"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-337"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064552"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064552"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064551"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-338"></span><span id="%3F%3D%3C%3C"><span class="annot"><span class="annottext">?=&lt;&lt; :: forall prob a.
Fractional prob =&gt;
(a -&gt; Bool) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#%3F%3D%3C%3C"><span class="hs-operator hs-var hs-var">(?=&lt;&lt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a.
Fractional prob =&gt;
(a -&gt; Bool) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">{- |
'Dist.filter' in infix form.
Can be considered an additional monadic combinator,
which can be used where you would want 'Control.Monad.guard' otherwise.
-}</span><span>
</span><span id="line-345"></span><span id="local-6989586621679064548"><span id="local-6989586621679064549"><span class="annot"><a href="Numeric.Probability.Distribution.html#%3E%3E%3D%3F"><span class="hs-operator hs-type">(&gt;&gt;=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064549"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-346"></span><span>   </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064549"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064549"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064548"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-347"></span><span id="%3E%3E%3D%3F"><span class="annot"><span class="annottext">&gt;&gt;=? :: forall prob a.
Fractional prob =&gt;
T prob a -&gt; (a -&gt; Bool) -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#%3E%3E%3D%3F"><span class="hs-operator hs-var hs-var">(&gt;&gt;=?)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall prob a.
Fractional prob =&gt;
(a -&gt; Bool) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | filtering distributions</span><span>
</span><span id="line-351"></span><span class="hs-keyword">data</span><span> </span><span id="Select"><span class="annot"><a href="Numeric.Probability.Distribution.html#Select"><span class="hs-identifier hs-var">Select</span></a></span></span><span> </span><span id="local-6989586621679064546"><span class="annot"><a href="#local-6989586621679064546"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Case"><span class="annot"><a href="Numeric.Probability.Distribution.html#Case"><span class="hs-identifier hs-var">Case</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679064546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Other"><span class="annot"><a href="Numeric.Probability.Distribution.html#Other"><span class="hs-identifier hs-var">Other</span></a></span></span><span>
</span><span id="line-352"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063984"><span id="local-6989586621679063987"><span class="annot"><span class="annottext">Select a -&gt; Select a -&gt; Bool
forall a. Eq a =&gt; Select a -&gt; Select a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Select a -&gt; Select a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Select a -&gt; Select a -&gt; Bool
== :: Select a -&gt; Select a -&gt; Bool
$c== :: forall a. Eq a =&gt; Select a -&gt; Select a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679063963"><span id="local-6989586621679063965"><span id="local-6989586621679063968"><span id="local-6989586621679063971"><span id="local-6989586621679063974"><span id="local-6989586621679063977"><span id="local-6989586621679063980"><span class="annot"><span class="annottext">Select a -&gt; Select a -&gt; Bool
Select a -&gt; Select a -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a}. Ord a =&gt; Eq (Select a)
forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Bool
forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Ordering
forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Select a
min :: Select a -&gt; Select a -&gt; Select a
$cmin :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Select a
max :: Select a -&gt; Select a -&gt; Select a
$cmax :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Select a
&gt;= :: Select a -&gt; Select a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Bool
&gt; :: Select a -&gt; Select a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Bool
&lt;= :: Select a -&gt; Select a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Bool
&lt; :: Select a -&gt; Select a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Bool
compare :: Select a -&gt; Select a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; Select a -&gt; Select a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679063954"><span id="local-6989586621679063956"><span id="local-6989586621679063960"><span class="annot"><span class="annottext">Int -&gt; Select a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; Select a -&gt; ShowS
forall a. Show a =&gt; [Select a] -&gt; ShowS
forall a. Show a =&gt; Select a -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Select a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Select a] -&gt; ShowS
show :: Select a -&gt; [Char]
$cshow :: forall a. Show a =&gt; Select a -&gt; [Char]
showsPrec :: Int -&gt; Select a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Select a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621679064544"><span id="local-6989586621679064545"><span class="annot"><a href="Numeric.Probability.Distribution.html#above"><span class="hs-identifier hs-type">above</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#below"><span class="hs-identifier hs-type">below</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064545"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064545"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064544"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-355"></span><span>   </span><span class="annot"><a href="#local-6989586621679064545"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064545"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064545"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064544"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-356"></span><span id="above"><span class="annot"><span class="annottext">above :: forall prob a.
(Num prob, Ord prob, Ord a) =&gt;
prob -&gt; T prob a -&gt; T prob (Select a)
</span><a href="Numeric.Probability.Distribution.html#above"><span class="hs-identifier hs-var hs-var">above</span></a></span></span><span> </span><span id="local-6989586621679063944"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063944"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a.
(Num prob, Ord prob, Ord a) =&gt;
(prob -&gt; Bool) -&gt; T prob a -&gt; T prob (Select a)
</span><a href="Numeric.Probability.Distribution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063944"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span id="below"><span class="annot"><span class="annottext">below :: forall prob a.
(Num prob, Ord prob, Ord a) =&gt;
prob -&gt; T prob a -&gt; T prob (Select a)
</span><a href="Numeric.Probability.Distribution.html#below"><span class="hs-identifier hs-var hs-var">below</span></a></span></span><span> </span><span id="local-6989586621679063935"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a.
(Num prob, Ord prob, Ord a) =&gt;
(prob -&gt; Bool) -&gt; T prob a -&gt; T prob (Select a)
</span><a href="Numeric.Probability.Distribution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span id="local-6989586621679064540"><span id="local-6989586621679064541"><span class="annot"><a href="Numeric.Probability.Distribution.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064540"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-360"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064540"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-361"></span><span id="select"><span class="annot"><span class="annottext">select :: forall prob a.
(Num prob, Ord prob, Ord a) =&gt;
(prob -&gt; Bool) -&gt; T prob a -&gt; T prob (Select a)
</span><a href="Numeric.Probability.Distribution.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span id="local-6989586621679063927"><span class="annot"><span class="annottext">prob -&gt; Bool
</span><a href="#local-6989586621679063927"><span class="hs-identifier hs-var">condp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679063926"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063926"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063923"><span class="annot"><span class="annottext">Map a prob
</span><a href="#local-6989586621679063923"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063922"><span class="annot"><span class="annottext">Map a prob
</span><a href="#local-6989586621679063922"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; (Map k a, Map k a)
</span><span class="hs-identifier hs-var">Map.partition</span></span><span> </span><span class="annot"><span class="annottext">prob -&gt; Bool
</span><a href="#local-6989586621679063927"><span class="hs-identifier hs-var">condp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063926"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-363"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-364"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Select a
</span><a href="Numeric.Probability.Distribution.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">Fold.sum</span></span><span> </span><span class="annot"><span class="annottext">Map a prob
</span><a href="#local-6989586621679063922"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><span class="hs-identifier hs-var">mapFst</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Select a
</span><a href="Numeric.Probability.Distribution.html#Case"><span class="hs-identifier hs-var">Case</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map a prob
</span><a href="#local-6989586621679063923"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span id="local-6989586621679064591"><span id="local-6989586621679064592"><span class="annot"><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-type">fromFreqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064592"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064592"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064592"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064591"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-368"></span><span id="fromFreqs"><span class="annot"><span class="annottext">fromFreqs :: forall prob a. Fractional prob =&gt; [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-var hs-var">fromFreqs</span></a></span></span><span> </span><span id="local-6989586621679063917"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679063916"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063915"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063915"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063915"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063914"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>           </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679063914"><span class="annot"><span class="annottext">q :: prob
</span><a href="#local-6989586621679063914"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; [(a, prob)] -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-var">sumP</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621679063911"><span id="local-6989586621679063912"><span class="annot"><a href="Numeric.Probability.Distribution.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-372"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-373"></span><span id="filter"><span class="annot"><span class="annottext">filter :: forall prob a.
Fractional prob =&gt;
(a -&gt; Bool) -&gt; T prob a -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#filter"><span class="hs-identifier hs-var hs-var">filter</span></a></span></span><span> </span><span id="local-6989586621679063908"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679063908"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-var">fromFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679063908"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span id="local-6989586621679064522"><span id="local-6989586621679064523"><span id="local-6989586621679064524"><span class="annot"><a href="Numeric.Probability.Distribution.html#mapMaybe"><span class="hs-identifier hs-type">mapMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064524"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-376"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679064522"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064524"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064524"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064522"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-377"></span><span id="mapMaybe"><span class="annot"><span class="annottext">mapMaybe :: forall prob a b.
Fractional prob =&gt;
(a -&gt; Maybe b) -&gt; T prob a -&gt; T prob b
</span><a href="Numeric.Probability.Distribution.html#mapMaybe"><span class="hs-identifier hs-var hs-var">mapMaybe</span></a></span></span><span> </span><span id="local-6989586621679063902"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679063902"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-378"></span><span>   </span><span class="annot"><span class="annottext">forall prob a. Fractional prob =&gt; [(a, prob)] -&gt; T prob a
</span><a href="Numeric.Probability.Distribution.html#fromFreqs"><span class="hs-identifier hs-var">fromFreqs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">Maybe.mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679063900"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063900"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063899"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063899"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063899"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679063902"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063900"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | selecting from distributions</span><span>
</span><span id="line-382"></span><span id="local-6989586621679064514"><span id="local-6989586621679064515"><span class="annot"><a href="Numeric.Probability.Distribution.html#selectP"><span class="hs-identifier hs-type">selectP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064515"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064515"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064515"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064515"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-383"></span><span id="selectP"><span class="annot"><span class="annottext">selectP :: forall prob a. (Num prob, Ord prob) =&gt; T prob a -&gt; prob -&gt; a
</span><a href="Numeric.Probability.Distribution.html#selectP"><span class="hs-identifier hs-var hs-var">selectP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Probability.Distribution.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679063893"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063893"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679063892"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063892"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord prob) =&gt; prob -&gt; [(a, prob)] -&gt; a
</span><a href="Numeric.Probability.Distribution.html#scanP"><span class="hs-identifier hs-var">scanP</span></a></span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063892"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063893"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span id="local-6989586621679064510"><span id="local-6989586621679064511"><span class="annot"><a href="Numeric.Probability.Distribution.html#scanP"><span class="hs-identifier hs-type">scanP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064510"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">prob</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064510"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-386"></span><span id="scanP"><span class="annot"><span class="annottext">scanP :: forall prob a. (Num prob, Ord prob) =&gt; prob -&gt; [(a, prob)] -&gt; a
</span><a href="Numeric.Probability.Distribution.html#scanP"><span class="hs-identifier hs-var hs-var">scanP</span></a></span></span><span> </span><span id="local-6989586621679063881"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063881"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679063880"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063880"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063879"><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063879"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679063878"><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063878"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063881"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063879"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063878"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-388"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063880"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-389"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall prob a. (Num prob, Ord prob) =&gt; prob -&gt; [(a, prob)] -&gt; a
</span><a href="Numeric.Probability.Distribution.html#scanP"><span class="hs-identifier hs-var">scanP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063881"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">prob
</span><a href="#local-6989586621679063879"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, prob)]
</span><a href="#local-6989586621679063878"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Numeric.Probability.Distribution.html#scanP"><span class="hs-identifier hs-var">scanP</span></a></span><span> </span><span class="annot"><span class="annottext">prob
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Probability.scanP: distribution must be non-empty&quot;</span></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#%3F%3F"><span class="hs-operator hs-type">??</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span id="local-6989586621679064505"><span id="local-6989586621679064506"><span class="annot"><a href="Numeric.Probability.Distribution.html#%3F%3F"><span class="hs-operator hs-type">(??)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">prob</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">prob</span></a></span></span></span><span>
</span><span id="line-395"></span><span id="%3F%3F"><span class="annot"><span class="annottext">?? :: forall prob a. Num prob =&gt; Event a -&gt; T prob a -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#%3F%3F"><span class="hs-operator hs-var hs-var">(??)</span></a></span></span><span> </span><span id="local-6989586621679063872"><span class="annot"><span class="annottext">Event a
</span><a href="#local-6989586621679063872"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob a. Num prob =&gt; [(a, prob)] -&gt; prob
</span><a href="Numeric.Probability.Distribution.html#sumP"><span class="hs-identifier hs-var">sumP</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event a
</span><a href="#local-6989586621679063872"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | expectation value</span><span>
</span><span id="line-399"></span><span id="local-6989586621679064502"><span class="annot"><a href="Numeric.Probability.Distribution.html#expected"><span class="hs-identifier hs-type">expected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-400"></span><span id="expected"><span class="annot"><span class="annottext">expected :: forall a. Num a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#expected"><span class="hs-identifier hs-var hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679063866"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063866"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679063865"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063865"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063866"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall prob a. T prob a -&gt; [(a, prob)]
</span><a href="Numeric.Probability.Distribution.html#decons"><span class="hs-identifier hs-var">decons</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- | statistical analyses</span><span>
</span><span id="line-403"></span><span id="local-6989586621679063864"><span class="annot"><a href="Numeric.Probability.Distribution.html#variance"><span class="hs-identifier hs-type">variance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679063864"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063864"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-404"></span><span id="variance"><span class="annot"><span class="annottext">variance :: forall a. Num a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#variance"><span class="hs-identifier hs-var hs-var">variance</span></a></span></span><span> </span><span id="local-6989586621679063855"><span class="annot"><span class="annottext">T a a
</span><a href="#local-6989586621679063855"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>   </span><span class="annot"><span class="annottext">forall a. Num a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#expected"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#expected"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">T a a
</span><a href="#local-6989586621679063855"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">T a a
</span><a href="#local-6989586621679063855"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span id="local-6989586621679064499"><span class="annot"><a href="Numeric.Probability.Distribution.html#stdDev"><span class="hs-identifier hs-type">stdDev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679064499"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Probability.Distribution.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064499"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-408"></span><span id="stdDev"><span class="annot"><span class="annottext">stdDev :: forall a. Floating a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#stdDev"><span class="hs-identifier hs-var hs-var">stdDev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall prob. Floating prob =&gt; T prob
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; T a a -&gt; a
</span><a href="Numeric.Probability.Distribution.html#variance"><span class="hs-identifier hs-var">variance</span></a></span><span>
</span><span id="line-409"></span></pre></body></html>