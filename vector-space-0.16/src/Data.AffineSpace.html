<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleContexts, TypeFamilies, CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric        #-}</span><span>
</span><span id="line-8"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Module      :  Data.AffineSpace</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Copyright   :  (c) Conal Elliott and Andy J Gill 2008</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- </span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Maintainer  :  conal@conal.net, andygill@ku.edu</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- </span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Affine spaces.</span><span>
</span><span id="line-18"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.AffineSpace</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier">AffineSpace</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.-%5E"><span class="hs-operator">(.-^)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#distanceSq"><span class="hs-identifier">distanceSq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#distance"><span class="hs-identifier">distance</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#alerp"><span class="hs-identifier">alerp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#affineCombo"><span class="hs-identifier">affineCombo</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftA2</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CSChar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CInt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CShort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CLong</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CLLong</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CIntMax</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CFloat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CDouble</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VectorSpace.html"><span class="hs-identifier">Data.VectorSpace</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Basis.html"><span class="hs-identifier">Data.Basis</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VectorSpace.Generic.html"><span class="hs-identifier">Data.VectorSpace.Generic</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gnrx</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(:*:)</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- Through 0.8.4, I used the following fixities.</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- </span><span>
</span><span id="line-39"></span><span class="hs-comment">--   infix 4 .+^, .-^, .-.</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- </span><span>
</span><span id="line-41"></span><span class="hs-comment">-- Changed in 0.8.5 to match precedence of + and -, and to associate usefully.</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Thanks to Ben Gamari for suggesting left-associativity.</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-type">.+^</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.-%5E"><span class="hs-operator hs-type">.-^</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-type">.-.</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- TODO: Convert AffineSpace from fundep to associated type, and eliminate</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- FunctionalDependencies above.</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Data.AdditiveGroup.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="AffineSpace"><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-var">AffineSpace</span></a></span></span><span> </span><span id="local-6989586621679054745"><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">-- | Associated vector space</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054745"><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054397"><span class="annot"><a href="#local-6989586621679054397"><span class="hs-identifier hs-type hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054397"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">-- | Subtract points</span><span>
</span><span id="line-56"></span><span>  </span><span id=".-."><span class="annot"><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-type">(.-.)</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id=".-."><span class="annot"><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-type">(.-.)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679054395"><span id="local-6989586621679054387"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054387"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var hs-var">.-.</span></a></span><span> </span><span id="local-6989586621679054386"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054386"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. Diff (VRep p) -&gt; GenericDiff p
</span><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-var">GenericDiff</span></a></span><span>
</span><span id="line-60"></span><span>         </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">Gnrx.from</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054387"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">Gnrx.from</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054386"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- | Point plus vector</span><span>
</span><span id="line-62"></span><span>  </span><span id=".%2B%5E"><span class="annot"><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-type">(.+^)</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id=".%2B%5E"><span class="annot"><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-type">(.+^)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679054383"><span id="local-6989586621679054375"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var hs-var">.+^</span></a></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span id="local-6989586621679054374"><span class="annot"><span class="annottext">Diff (VRep p)
</span><a href="#local-6989586621679054374"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; Rep a x -&gt; a
</span><span class="hs-identifier hs-var">Gnrx.to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">Gnrx.from</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (VRep p)
</span><a href="#local-6989586621679054374"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054745"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Point minus vector</span><span>
</span><span id="line-68"></span><span id="local-6989586621679054372"><span class="annot"><a href="Data.AffineSpace.html#.-%5E"><span class="hs-operator hs-type">(.-^)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054372"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054372"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054372"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054372"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-69"></span><span id="local-6989586621679054367"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id=".-%5E"><span class="annot"><span class="annottext">.-^ :: forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.-%5E"><span class="hs-operator hs-var hs-var">.-^</span></a></span></span><span> </span><span id="local-6989586621679054366"><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054366"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Data.AdditiveGroup.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054366"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Square of the distance between two points.  Sometimes useful for</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- efficiency.  See also 'distance'.</span><span>
</span><span id="line-73"></span><span id="local-6989586621679054734"><span id="local-6989586621679054735"><span class="annot"><a href="Data.AffineSpace.html#distanceSq"><span class="hs-identifier hs-type">distanceSq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054734"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054734"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-74"></span><span>              </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054734"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-75"></span><span id="distanceSq"><span class="annot"><span class="annottext">distanceSq :: forall p v.
(AffineSpace p, v ~ Diff p, InnerSpace v) =&gt;
p -&gt; p -&gt; Scalar v
</span><a href="Data.AffineSpace.html#distanceSq"><span class="hs-identifier hs-var hs-var">distanceSq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall v s. (InnerSpace v, s ~ Scalar v) =&gt; v -&gt; s
</span><a href="Data.VectorSpace.html#magnitudeSq"><span class="hs-identifier hs-var">magnitudeSq</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">(.-.)</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Distance between two points.  See also 'distanceSq'.</span><span>
</span><span id="line-78"></span><span id="local-6989586621679054720"><span id="local-6989586621679054721"><span id="local-6989586621679054722"><span class="annot"><a href="Data.AffineSpace.html#distance"><span class="hs-identifier hs-type">distance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054722"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054721"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054722"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054721"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-79"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054720"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054721"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054721"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054722"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054722"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054720"><span class="hs-identifier hs-type">s</span></a></span></span></span></span><span>
</span><span id="line-81"></span><span id="distance"><span class="annot"><span class="annottext">distance :: forall p v s.
(AffineSpace p, v ~ Diff p, InnerSpace v, s ~ Scalar v,
 Floating (Scalar v)) =&gt;
p -&gt; p -&gt; s
</span><a href="Data.AffineSpace.html#distance"><span class="hs-identifier hs-var hs-var">distance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">forall p v.
(AffineSpace p, v ~ Diff p, InnerSpace v) =&gt;
p -&gt; p -&gt; Scalar v
</span><a href="Data.AffineSpace.html#distanceSq"><span class="hs-identifier hs-var">distanceSq</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Affine linear interpolation.  Varies from @p@ to @p'@ as @s@ varies</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- from 0 to 1.  See also 'lerp' (on vector spaces).</span><span>
</span><span id="line-85"></span><span id="local-6989586621679054715"><span class="annot"><a href="Data.AffineSpace.html#alerp"><span class="hs-identifier hs-type">alerp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-86"></span><span>         </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054715"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-87"></span><span id="alerp"><span class="annot"><span class="annottext">alerp :: forall p.
(AffineSpace p, VectorSpace (Diff p)) =&gt;
p -&gt; p -&gt; Scalar (Diff p) -&gt; p
</span><a href="Data.AffineSpace.html#alerp"><span class="hs-identifier hs-var hs-var">alerp</span></a></span></span><span> </span><span id="local-6989586621679054329"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054329"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679054328"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="local-6989586621679054327"><span class="annot"><span class="annottext">Scalar (Diff p)
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054329"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar (Diff p)
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><a href="Data.VectorSpace.html#%2A%5E"><span class="hs-operator hs-var">*^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054329"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Compute an affine combination (weighted average) of points.</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The first element is used as origin and is weighted</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- such that all coefficients sum to 1. For example,</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt; affineCombo a [(0.3,b), (0.2,c)]</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- is equal to</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt; a .+^ (0.3 *^ (b .-. a) ^+^ 0.2 *^ (c .-. a))</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- and if @a@, @b@, and @c@ were in a vector space would also be equal to</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; 0.5 *^ a ^+^ 0.3 *^ b ^+^ 0.2 *^ c</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- See also 'linearCombo' (on vector spaces).</span><span>
</span><span id="line-104"></span><span id="local-6989586621679054711"><span id="local-6989586621679054712"><span class="annot"><a href="Data.AffineSpace.html#affineCombo"><span class="hs-identifier hs-type">affineCombo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054712"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054711"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054712"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054711"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054712"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054712"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054711"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054712"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-105"></span><span id="affineCombo"><span class="annot"><span class="annottext">affineCombo :: forall p v.
(AffineSpace p, v ~ Diff p, VectorSpace v) =&gt;
p -&gt; [(p, Scalar v)] -&gt; p
</span><a href="Data.AffineSpace.html#affineCombo"><span class="hs-identifier hs-var hs-var">affineCombo</span></a></span></span><span> </span><span id="local-6989586621679054315"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054315"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679054314"><span class="annot"><span class="annottext">[(p, Scalar v)]
</span><a href="#local-6989586621679054314"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054315"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. VectorSpace v =&gt; [(v, Scalar v)] -&gt; v
</span><a href="Data.VectorSpace.html#linearCombo"><span class="hs-identifier hs-var">linearCombo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054315"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(p, Scalar v)]
</span><a href="#local-6989586621679054314"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#define ScalarTypeCon(con,t) \
  instance con =&gt; AffineSpace (t) where \
    { type Diff (t) = t \
    ; (.-.) = (-) \
    ; (.+^) = (+) }
</span><span class="hs-cpp">
#define ScalarType(t) ScalarTypeCon((),t)
</span><span>
</span><span id="line-115"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">Integer</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">Double</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">Float</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CSChar</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CInt</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CShort</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CLong</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CLLong</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CIntMax</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CDouble</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-identifier">ScalarType</span><span class="hs-special">(</span><span class="hs-identifier">CFloat</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span id="local-6989586621679054689"></span><span class="hs-identifier">ScalarTypeCon</span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">Ratio</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054682"><span id="local-6989586621679054683"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054683"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054682"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054683"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054682"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054682"><span id="local-6989586621679054683"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054683"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054682"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054683"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054682"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054140"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054140"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054139"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054139"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054138"><span class="annot"><span class="annottext">.-. :: (p, q) -&gt; (p, q) -&gt; Diff (p, q)
</span><a href="#local-6989586621679054138"><span class="hs-operator hs-var hs-var hs-var hs-var">.-.</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054137"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054137"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054136"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054136"><span class="hs-identifier hs-var">q'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054140"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054137"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054139"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054136"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054133"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054133"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054132"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054132"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054131"><span class="annot"><span class="annottext">.+^ :: (p, q) -&gt; Diff (p, q) -&gt; (p, q)
</span><a href="#local-6989586621679054131"><span class="hs-operator hs-var hs-var hs-var hs-var">.+^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054130"><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054130"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054129"><span class="annot"><span class="annottext">Diff q
</span><a href="#local-6989586621679054129"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054133"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054130"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054132"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff q
</span><a href="#local-6989586621679054129"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054673"><span id="local-6989586621679054674"><span id="local-6989586621679054675"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054675"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054674"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054673"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054675"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054674"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054673"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054673"><span id="local-6989586621679054674"><span id="local-6989586621679054675"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054675"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054674"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679054673"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054675"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054674"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054673"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054112"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054112"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054111"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054111"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054110"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054110"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054109"><span class="annot"><span class="annottext">.-. :: (p, q, r) -&gt; (p, q, r) -&gt; Diff (p, q, r)
</span><a href="#local-6989586621679054109"><span class="hs-operator hs-var hs-var hs-var hs-var">.-.</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054108"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054108"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054107"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054107"><span class="hs-identifier hs-var">q'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054106"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054106"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054112"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054108"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054111"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054107"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054110"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054106"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054102"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054102"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054101"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054101"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054100"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054100"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054099"><span class="annot"><span class="annottext">.+^ :: (p, q, r) -&gt; Diff (p, q, r) -&gt; (p, q, r)
</span><a href="#local-6989586621679054099"><span class="hs-operator hs-var hs-var hs-var hs-var">.+^</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054098"><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054098"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054097"><span class="annot"><span class="annottext">Diff q
</span><a href="#local-6989586621679054097"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054096"><span class="annot"><span class="annottext">Diff r
</span><a href="#local-6989586621679054096"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679054102"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff p
</span><a href="#local-6989586621679054098"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679054101"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff q
</span><a href="#local-6989586621679054097"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054100"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff r
</span><a href="#local-6989586621679054096"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054667"><span id="local-6989586621679054668"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054668"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054668"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054667"><span id="local-6989586621679054668"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054668"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679054667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054668"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679054083"><span class="annot"><span class="annottext">.-. :: (a -&gt; p) -&gt; (a -&gt; p) -&gt; Diff (a -&gt; p)
</span><a href="#local-6989586621679054083"><span class="hs-operator hs-var hs-var hs-var hs-var">(.-.)</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">(.-.)</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679054080"><span class="annot"><span class="annottext">.+^ :: (a -&gt; p) -&gt; Diff (a -&gt; p) -&gt; a -&gt; p
</span><a href="#local-6989586621679054080"><span class="hs-operator hs-var hs-var hs-var hs-var">(.+^)</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">(.+^)</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679054078"><span id="local-6989586621679054079"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="GenericDiff"><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-var">GenericDiff</span></a></span></span><span> </span><span id="local-6989586621679054744"><span class="annot"><a href="#local-6989586621679054744"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenericDiff"><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-var">GenericDiff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054744"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>       </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall p x. Rep (GenericDiff p) x -&gt; GenericDiff p
forall p x. GenericDiff p -&gt; Rep (GenericDiff p) x
$cto :: forall p x. Rep (GenericDiff p) x -&gt; GenericDiff p
$cfrom :: forall p x. GenericDiff p -&gt; Rep (GenericDiff p) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054067"><span id="local-6989586621679054069"><span id="local-6989586621679054071"><span id="local-6989586621679054073"><span id="local-6989586621679054660"><span class="annot"><a href="Data.AdditiveGroup.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054660"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AdditiveGroup.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054660"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054062"><span id="local-6989586621679054659"><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054659"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054659"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054055"><span id="local-6989586621679054657"><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054657"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054657"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054046"><span id="local-6989586621679054048"><span id="local-6989586621679054050"><span id="local-6989586621679054655"><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.Generic.html#VRep"><span class="hs-identifier hs-type">VRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054655"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#GenericDiff"><span class="hs-identifier hs-type">GenericDiff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054655"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621679054043"><span id="local-6989586621679054044"></span></span><span class="hs-keyword">data</span><span> </span><span id="AffineDiffProductSpace"><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-var">AffineDiffProductSpace</span></a></span></span><span> </span><span id="local-6989586621679054651"><span class="annot"><a href="#local-6989586621679054651"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679054650"><span class="annot"><a href="#local-6989586621679054650"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679054649"><span class="annot"><a href="#local-6989586621679054649"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AffineDiffProductSpace"><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-var">AffineDiffProductSpace</span></a></span></span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054651"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054649"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054650"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054649"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (f :: * -&gt; *) (g :: * -&gt; *) p x.
Rep (AffineDiffProductSpace f g p) x
-&gt; AffineDiffProductSpace f g p
forall (f :: * -&gt; *) (g :: * -&gt; *) p x.
AffineDiffProductSpace f g p
-&gt; Rep (AffineDiffProductSpace f g p) x
$cto :: forall (f :: * -&gt; *) (g :: * -&gt; *) p x.
Rep (AffineDiffProductSpace f g p) x
-&gt; AffineDiffProductSpace f g p
$cfrom :: forall (f :: * -&gt; *) (g :: * -&gt; *) p x.
AffineDiffProductSpace f g p
-&gt; Rep (AffineDiffProductSpace f g p) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054032"><span id="local-6989586621679054034"><span id="local-6989586621679054036"><span id="local-6989586621679054038"><span id="local-6989586621679054646"><span id="local-6989586621679054647"><span id="local-6989586621679054648"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054647"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054646"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054647"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AdditiveGroup.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054648"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054646"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054647"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054028"><span id="local-6989586621679054643"><span id="local-6989586621679054644"><span id="local-6989586621679054645"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054643"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054643"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054643"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054643"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054021"><span id="local-6989586621679054640"><span id="local-6989586621679054641"><span id="local-6989586621679054642"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054640"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054640"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054640"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054642"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054640"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054641"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054634"><span id="local-6989586621679054635"><span id="local-6989586621679054636"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054636"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054635"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054634"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054635"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054636"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054634"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054635"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054634"><span id="local-6989586621679054635"><span id="local-6989586621679054636"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054636"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054634"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054635"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054636"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054634"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054635"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679054011"><span class="annot"><span class="annottext">.+^ :: AffineDiffProductSpace f g p
-&gt; Diff (AffineDiffProductSpace f g p)
-&gt; AffineDiffProductSpace f g p
</span><a href="#local-6989586621679054011"><span class="hs-operator hs-var hs-var hs-var hs-var">(.+^)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Data.AdditiveGroup.html#%5E%2B%5E"><span class="hs-operator hs-var">(^+^)</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679054008"><span class="annot"><span class="annottext">.-. :: AffineDiffProductSpace f g p
-&gt; AffineDiffProductSpace f g p
-&gt; Diff (AffineDiffProductSpace f g p)
</span><a href="#local-6989586621679054008"><span class="hs-operator hs-var hs-var hs-var hs-var">(.-.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><a href="Data.AdditiveGroup.html#%5E-%5E"><span class="hs-operator hs-var">(^-^)</span></a></span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054628"><span id="local-6989586621679054629"><span id="local-6989586621679054630"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Basis"><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-var">Basis</span></a></span></span><span> </span><span id="local-6989586621679054628"><span id="local-6989586621679054629"><span id="local-6989586621679054630"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054630"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>                                                     </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054628"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679053984"><span class="annot"><span class="annottext">basisValue :: Basis (AffineDiffProductSpace f g p)
-&gt; AffineDiffProductSpace f g p
</span><a href="Data.Basis.html#basisValue"><span class="hs-identifier hs-var hs-var hs-var hs-var">basisValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679053982"><span class="annot"><span class="annottext">Basis (Diff (f p))
</span><a href="#local-6989586621679053982"><span class="hs-identifier hs-var">bf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) p.
Diff (f p) -&gt; Diff (g p) -&gt; AffineDiffProductSpace f g p
</span><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-var">AffineDiffProductSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; Basis v -&gt; v
</span><a href="Data.Basis.html#basisValue"><span class="hs-identifier hs-var">basisValue</span></a></span><span> </span><span class="annot"><span class="annottext">Basis (Diff (f p))
</span><a href="#local-6989586621679053982"><span class="hs-identifier hs-var">bf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall v. AdditiveGroup v =&gt; v
</span><a href="Data.AdditiveGroup.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="Data.Basis.html#basisValue"><span class="hs-identifier hs-var">basisValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679053980"><span class="annot"><span class="annottext">Basis (Diff (g p))
</span><a href="#local-6989586621679053980"><span class="hs-identifier hs-var">bg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) p.
Diff (f p) -&gt; Diff (g p) -&gt; AffineDiffProductSpace f g p
</span><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-var">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><span class="annottext">forall v. AdditiveGroup v =&gt; v
</span><a href="Data.AdditiveGroup.html#zeroV"><span class="hs-identifier hs-var">zeroV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; Basis v -&gt; v
</span><a href="Data.Basis.html#basisValue"><span class="hs-identifier hs-var">basisValue</span></a></span><span> </span><span class="annot"><span class="annottext">Basis (Diff (g p))
</span><a href="#local-6989586621679053980"><span class="hs-identifier hs-var">bg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679053975"><span class="annot"><span class="annottext">decompose :: AffineDiffProductSpace f g p
-&gt; [(Basis (AffineDiffProductSpace f g p),
     Scalar (AffineDiffProductSpace f g p))]
</span><a href="Data.Basis.html#decompose"><span class="hs-identifier hs-var hs-var hs-var hs-var">decompose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span id="local-6989586621679053973"><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053973"><span class="hs-identifier hs-var">vf</span></a></span></span><span> </span><span id="local-6989586621679053972"><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">vg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; v -&gt; [(Basis v, Scalar v)]
</span><a href="Data.Basis.html#decompose"><span class="hs-identifier hs-var">decompose</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053973"><span class="hs-identifier hs-var">vf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; v -&gt; [(Basis v, Scalar v)]
</span><a href="Data.Basis.html#decompose"><span class="hs-identifier hs-var">decompose</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053972"><span class="hs-identifier hs-var">vg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679053969"><span class="annot"><span class="annottext">decompose' :: AffineDiffProductSpace f g p
-&gt; Basis (AffineDiffProductSpace f g p)
-&gt; Scalar (AffineDiffProductSpace f g p)
</span><a href="Data.Basis.html#decompose%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">decompose'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span id="local-6989586621679053967"><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053967"><span class="hs-identifier hs-var">vf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Diff (g p)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679053966"><span class="annot"><span class="annottext">Basis (Diff (f p))
</span><a href="#local-6989586621679053966"><span class="hs-identifier hs-var">bf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; v -&gt; Basis v -&gt; Scalar v
</span><a href="Data.Basis.html#decompose%27"><span class="hs-identifier hs-var">decompose'</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053967"><span class="hs-identifier hs-var">vf</span></a></span><span> </span><span class="annot"><span class="annottext">Basis (Diff (f p))
</span><a href="#local-6989586621679053966"><span class="hs-identifier hs-var">bf</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Data.Basis.html#decompose%27"><span class="hs-identifier hs-var">decompose'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (f p)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679053965"><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053965"><span class="hs-identifier hs-var">vg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679053964"><span class="annot"><span class="annottext">Basis (Diff (g p))
</span><a href="#local-6989586621679053964"><span class="hs-identifier hs-var">bg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. HasBasis v =&gt; v -&gt; Basis v -&gt; Scalar v
</span><a href="Data.Basis.html#decompose%27"><span class="hs-identifier hs-var">decompose'</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053965"><span class="hs-identifier hs-var">vg</span></a></span><span> </span><span class="annot"><span class="annottext">Basis (Diff (g p))
</span><a href="#local-6989586621679053964"><span class="hs-identifier hs-var">bg</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054621"><span id="local-6989586621679054622"><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Gnrx.Rec0</span></span><span> </span><span class="annot"><a href="#local-6989586621679054622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054621"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054621"><span id="local-6989586621679054622"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Gnrx.Rec0</span></span><span> </span><span class="annot"><a href="#local-6989586621679054622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054621"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054622"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.K1</span></span><span> </span><span id="local-6989586621679053954"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053954"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679053953"><span class="annot"><span class="annottext">.+^ :: Rec0 a s -&gt; Diff (Rec0 a s) -&gt; Rec0 a s
</span><a href="#local-6989586621679053953"><span class="hs-operator hs-var hs-var hs-var hs-var">.+^</span></a></span></span><span> </span><span id="local-6989586621679053952"><span class="annot"><span class="annottext">Diff (Rec0 a s)
</span><a href="#local-6989586621679053952"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">Gnrx.K1</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053954"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (Rec0 a s)
</span><a href="#local-6989586621679053952"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.K1</span></span><span> </span><span id="local-6989586621679053950"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053950"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679053949"><span class="annot"><span class="annottext">.-. :: Rec0 a s -&gt; Rec0 a s -&gt; Diff (Rec0 a s)
</span><a href="#local-6989586621679053949"><span class="hs-operator hs-var hs-var hs-var hs-var">.-.</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.K1</span></span><span> </span><span id="local-6989586621679053948"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053948"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053950"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679053948"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054608"><span id="local-6989586621679054609"><span id="local-6989586621679054610"><span id="local-6989586621679054611"><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054610"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Gnrx.M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679054609"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054608"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054610"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054608"><span id="local-6989586621679054609"><span id="local-6989586621679054610"><span id="local-6989586621679054611"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Gnrx.M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679054609"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054608"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054610"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-type">Diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054610"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.M1</span></span><span> </span><span id="local-6989586621679053938"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053938"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679053937"><span class="annot"><span class="annottext">.+^ :: M1 i c f p -&gt; Diff (M1 i c f p) -&gt; M1 i c f p
</span><a href="#local-6989586621679053937"><span class="hs-operator hs-var hs-var hs-var hs-var">.+^</span></a></span></span><span> </span><span id="local-6989586621679053936"><span class="annot"><span class="annottext">Diff (M1 i c f p)
</span><a href="#local-6989586621679053936"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">Gnrx.M1</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053938"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (M1 i c f p)
</span><a href="#local-6989586621679053936"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.M1</span></span><span> </span><span id="local-6989586621679053934"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053934"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679053933"><span class="annot"><span class="annottext">.-. :: M1 i c f p -&gt; M1 i c f p -&gt; Diff (M1 i c f p)
</span><a href="#local-6989586621679053933"><span class="hs-operator hs-var hs-var hs-var hs-var">.-.</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gnrx.M1</span></span><span> </span><span id="local-6989586621679053932"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053932"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053934"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053932"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054597"><span id="local-6989586621679054598"><span id="local-6989586621679054599"><span class="hs-special">(</span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054599"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054598"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054597"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054598"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineSpace"><span class="hs-identifier hs-type">AffineSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054599"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679054597"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054598"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Diff"><span class="annot"><a href="Data.AffineSpace.html#Diff"><span class="hs-identifier hs-var">Diff</span></a></span></span><span> </span><span id="local-6989586621679054597"><span id="local-6989586621679054598"><span id="local-6989586621679054599"><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054599"><span class="hs-identifier hs-type">f</span></a></span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span class="annot"><a href="#local-6989586621679054597"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054598"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054599"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054597"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054598"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679053921"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053921"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span id="local-6989586621679053919"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053919"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053918"><span class="annot"><span class="annottext">.+^ :: (:*:) f g p -&gt; Diff ((:*:) f g p) -&gt; (:*:) f g p
</span><a href="#local-6989586621679053918"><span class="hs-operator hs-var hs-var hs-var hs-var">.+^</span></a></span></span><span> </span><span class="annot"><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-type">AffineDiffProductSpace</span></a></span><span> </span><span id="local-6989586621679053917"><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053917"><span class="hs-identifier hs-var">&#958;</span></a></span></span><span> </span><span id="local-6989586621679053916"><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053916"><span class="hs-identifier hs-var">&#965;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053921"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span class="annot"><span class="annottext">Diff (f p)
</span><a href="#local-6989586621679053917"><span class="hs-identifier hs-var">&#958;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053919"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; Diff p -&gt; p
</span><a href="Data.AffineSpace.html#.%2B%5E"><span class="hs-operator hs-var">.+^</span></a></span><span class="annot"><span class="annottext">Diff (g p)
</span><a href="#local-6989586621679053916"><span class="hs-identifier hs-var">&#965;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679053913"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053913"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span id="local-6989586621679053912"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053912"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679053911"><span class="annot"><span class="annottext">.-. :: (:*:) f g p -&gt; (:*:) f g p -&gt; Diff ((:*:) f g p)
</span><a href="#local-6989586621679053911"><span class="hs-operator hs-var hs-var hs-var hs-var">.-.</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679053910"><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">&#958;</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span id="local-6989586621679053909"><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">&#965;</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) p.
Diff (f p) -&gt; Diff (g p) -&gt; AffineDiffProductSpace f g p
</span><a href="Data.AffineSpace.html#AffineDiffProductSpace"><span class="hs-identifier hs-var">AffineDiffProductSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053913"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679053910"><span class="hs-identifier hs-var">&#958;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053912"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall p. AffineSpace p =&gt; p -&gt; p -&gt; Diff p
</span><a href="Data.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679053909"><span class="hs-identifier hs-var">&#965;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span></pre></body></html>