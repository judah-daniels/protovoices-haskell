<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.List.HT.Private</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">transpose</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unfoldr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>                            </span><span class="annot"><span class="hs-identifier">findIndices</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapAccumL</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Maybe.HT.html"><span class="hs-identifier">Data.Maybe.HT</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Data.Maybe.HT.html#toMaybe"><span class="hs-identifier">toMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.HT.html"><span class="hs-identifier">Control.Monad.HT</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.HT.html#%3C%3D%3C"><span class="hs-operator">(&lt;=&lt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">msum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mplus</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;*&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Tuple.HT.html"><span class="hs-identifier">Data.Tuple.HT</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Data.Tuple.Lazy.html#mapPair"><span class="hs-identifier">mapPair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier">mapFst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier">mapSnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier">forcePair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Tuple.Lazy.html#swap"><span class="hs-identifier">swap</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Control.Functor.HT.html"><span class="hs-identifier">Control.Functor.HT</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Func</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.List.Key.Private.html"><span class="hs-identifier">Data.List.Key.Private</span></a></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.List.Match.Private.html"><span class="hs-identifier">Data.List.Match.Private</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Match</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.List.Reverse.StrictElement.html"><span class="hs-identifier">Data.List.Reverse.StrictElement</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Rev</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unzip</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">break</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">span</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Test.QuickCheck as QC</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- &gt;&gt;&gt; import Test.Utility (forAllPredicates)</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;&gt;&gt; import Test.QuickCheck (NonNegative(NonNegative), Positive(Positive), NonEmptyList(NonEmpty))</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.List as List</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.List (transpose)</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Maybe.HT (toMaybe)</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Maybe (mapMaybe, isNothing)</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Char (isLetter, toUpper)</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Eq.HT (equating)</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- &gt;&gt;&gt; import Control.Monad (liftM2)</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;&gt;&gt;</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- &gt;&gt;&gt; divMaybe :: Int -&gt; Int -&gt; Maybe Int</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- &gt;&gt;&gt; divMaybe m n = case divMod n m of (q,0) -&gt; Just q; _ -&gt; Nothing</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt;&gt;&gt;</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- &gt;&gt;&gt; forAllMaybeFn :: (QC.Testable test) =&gt; ((Int -&gt; Maybe Int) -&gt; test) -&gt; QC.Property</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &gt;&gt;&gt; forAllMaybeFn prop = QC.forAll (QC.choose (1,4)) $ prop . divMaybe</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- * Improved standard functions</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">{- |
This function is lazier than the one suggested in the Haskell 98 report.
It is @inits undefined = [] : undefined@,
in contrast to @Data.List.inits undefined = undefined@.
-}</span><span>
</span><span id="line-47"></span><span class="hs-comment">{-
suggested in
&lt;http://www.haskell.org/pipermail/libraries/2014-July/023291.html&gt;
-}</span><span>
</span><span id="line-51"></span><span id="local-6989586621679045075"><span class="annot"><a href="Data.List.HT.Private.html#inits"><span class="hs-identifier hs-type">inits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-52"></span><span id="inits"><span class="annot"><span class="annottext">inits :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#inits"><span class="hs-identifier hs-var hs-var">inits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">scanl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">{- |
As lazy as 'inits' but less efficient because of repeated 'map'.
-}</span><span>
</span><span id="line-57"></span><span id="local-6989586621679044703"><span class="annot"><a href="Data.List.HT.Private.html#initsLazy"><span class="hs-identifier hs-type">initsLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-58"></span><span id="initsLazy"><span class="annot"><span class="annottext">initsLazy :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#initsLazy"><span class="hs-identifier hs-var hs-var">initsLazy</span></a></span></span><span> </span><span id="local-6989586621679044701"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044701"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044701"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>      </span><span id="local-6989586621679044700"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044700"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044699"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044699"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044700"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#initsLazy"><span class="hs-identifier hs-var">initsLazy</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044699"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">{- |
Suggested implementation in the Haskell 98 report.
It is not as lazy as possible.
-}</span><span>
</span><span id="line-68"></span><span id="local-6989586621679044698"><span class="annot"><a href="Data.List.HT.Private.html#inits98"><span class="hs-identifier hs-type">inits98</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-69"></span><span id="inits98"><span class="annot"><span class="annottext">inits98 :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#inits98"><span class="hs-identifier hs-var hs-var">inits98</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Data.List.HT.Private.html#inits98"><span class="hs-identifier hs-var">inits98</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044696"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044696"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044695"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044695"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044696"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#inits98"><span class="hs-identifier hs-var">inits98</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044695"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621679044694"><span class="annot"><a href="Data.List.HT.Private.html#inits98%27"><span class="hs-identifier hs-type">inits98'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-73"></span><span id="inits98%27"><span class="annot"><span class="annottext">inits98' :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#inits98%27"><span class="hs-identifier hs-var hs-var">inits98'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044689"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044688"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044688"><span class="hs-identifier hs-var">prefixes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044689"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044688"><span class="hs-identifier hs-var">prefixes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">{- |
This function is lazier than the one suggested in the Haskell 98 report.
It is @tails undefined = ([] : undefined) : undefined@,
in contrast to @Data.List.tails undefined = undefined@.
-}</span><span>
</span><span id="line-82"></span><span id="local-6989586621679044687"><span class="annot"><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-type">tails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044687"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044687"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-83"></span><span id="tails"><span class="annot"><span class="annottext">tails :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var hs-var">tails</span></a></span></span><span> </span><span id="local-6989586621679044685"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044685"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-85"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044685"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044683"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044683"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044685"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044683"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621679044682"><span class="annot"><a href="Data.List.HT.Private.html#tails%27"><span class="hs-identifier hs-type">tails'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044682"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044682"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-90"></span><span id="tails%27"><span class="annot"><span class="annottext">tails' :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails%27"><span class="hs-identifier hs-var hs-var">tails'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfter"><span class="hs-identifier hs-var">breakAfter</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span id="local-6989586621679044675"><span class="annot"><a href="Data.List.HT.Private.html#tails98"><span class="hs-identifier hs-type">tails98</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-93"></span><span id="tails98"><span class="annot"><span class="annottext">tails98 :: forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails98"><span class="hs-identifier hs-var hs-var">tails98</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Data.List.HT.Private.html#tails98"><span class="hs-identifier hs-var">tails98</span></a></span><span> </span><span id="local-6989586621679044673"><span class="annot"><span class="annottext">xxs :: [a]
</span><a href="#local-6989586621679044673"><span class="hs-identifier hs-var">xxs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044672"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044672"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044673"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails98"><span class="hs-identifier hs-var">tails98</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044672"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">{- |
This function compares adjacent elements of a list.
If two adjacent elements satisfy a relation then they are put into the same sublist.
Example:

&gt;&gt;&gt; groupBy (&lt;) &quot;abcdebcdef&quot;
[&quot;abcde&quot;,&quot;bcdef&quot;]

In contrast to that 'Data.List.groupBy' compares
the head of each sublist with each candidate for this sublist.
This yields

&gt;&gt;&gt; List.groupBy (&lt;) &quot;abcdebcdef&quot;
[&quot;abcdebcdef&quot;]

The second @'b'@ is compared with the leading @'a'@.
Thus it is put into the same sublist as @'a'@.

The sublists are never empty.
Thus the more precise result type would be @[(a,[a])]@.
-}</span><span>
</span><span id="line-117"></span><span id="local-6989586621679045040"><span class="annot"><a href="Data.List.HT.Private.html#groupBy"><span class="hs-identifier hs-type">groupBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045040"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679045040"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045040"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045040"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-118"></span><span id="groupBy"><span class="annot"><span class="annottext">groupBy :: forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#groupBy"><span class="hs-identifier hs-var hs-var">groupBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.Key.Private.html#groupBy"><span class="hs-identifier hs-var">Key.groupBy</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679045039"><span class="annot"><a href="Data.List.HT.Private.html#group"><span class="hs-identifier hs-type">group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679045039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-121"></span><span id="group"><span class="annot"><span class="annottext">group :: forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#group"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">{- |
Like standard 'unzip' but more lazy.
It is @Data.List.unzip undefined == undefined@,
but @unzip undefined == (undefined, undefined)@.
-}</span><span>
</span><span id="line-129"></span><span id="local-6989586621679045035"><span id="local-6989586621679045036"><span class="annot"><a href="Data.List.HT.Private.html#unzip"><span class="hs-identifier hs-type">unzip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045036"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679045035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045036"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-130"></span><span id="unzip"><span class="annot"><span class="annottext">unzip :: forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="Data.List.HT.Private.html#unzip"><span class="hs-identifier hs-var hs-var">unzip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-132"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044664"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044664"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044663"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044663"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044662"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044662"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044661"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679044661"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044664"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044662"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044663"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679044661"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">{- |
'Data.List.partition' of GHC 6.2.1 fails on infinite lists.
But this one does not.
-}</span><span>
</span><span id="line-139"></span><span class="hs-comment">{-
The lazy pattern match @(y,z)@ is necessary
since otherwise it fails on infinite lists.
-}</span><span>
</span><span id="line-143"></span><span id="local-6989586621679044660"><span class="annot"><a href="Data.List.HT.Private.html#partition"><span class="hs-identifier hs-type">partition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-144"></span><span id="partition"><span class="annot"><span class="annottext">partition :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#partition"><span class="hs-identifier hs-var hs-var">partition</span></a></span></span><span> </span><span id="local-6989586621679044657"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044657"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-146"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044656"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044655"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044655"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044654"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044654"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044657"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-149"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044655"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044654"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044655"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044654"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">{- |
It is @Data.List.span f undefined = undefined@,
whereas @span f undefined = (undefined, undefined)@.
-}</span><span>
</span><span id="line-157"></span><span id="local-6989586621679044653"><span class="annot"><a href="Data.List.HT.Private.html#span"><span class="hs-identifier hs-type">span</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-type">break</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044653"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span id="span"><span class="annot"><span class="annottext">span :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#span"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span id="local-6989586621679044650"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044650"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044643"><span class="annot"><span class="annottext">recourse :: [a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044643"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span id="local-6989586621679044642"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044642"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>          </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-161"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044642"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044641"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044641"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044640"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044640"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044642"><span class="hs-identifier hs-var">xt</span></a></span><span>
</span><span id="line-163"></span><span>             </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044650"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044641"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-164"></span><span>             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044641"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044643"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044640"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-165"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044643"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="break"><span class="annot"><span class="annottext">break :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-var hs-var">break</span></a></span></span><span> </span><span id="local-6989586621679044638"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044638"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044638"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- * Split</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">{- |
Split the list at the occurrences of a separator into sub-lists.
Remove the separators.
This is somehow a generalization of 'lines' and 'words'.
But note the differences:

&gt;&gt;&gt; words &quot;a  a&quot;
[&quot;a&quot;,&quot;a&quot;]
&gt;&gt;&gt; chop (' '==) &quot;a  a&quot;
[&quot;a&quot;,&quot;&quot;,&quot;a&quot;]

&gt;&gt;&gt; lines &quot;a\n\na&quot;
[&quot;a&quot;,&quot;&quot;,&quot;a&quot;]
&gt;&gt;&gt; chop ('\n'==) &quot;a\n\na&quot;
[&quot;a&quot;,&quot;&quot;,&quot;a&quot;]

&gt;&gt;&gt; lines &quot;a\n&quot;
[&quot;a&quot;]
&gt;&gt;&gt; chop ('\n'==) &quot;a\n&quot;
[&quot;a&quot;,&quot;&quot;]
-}</span><span>
</span><span id="line-194"></span><span id="local-6989586621679045018"><span class="annot"><a href="Data.List.HT.Private.html#chop"><span class="hs-identifier hs-type">chop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-195"></span><span id="chop"><span class="annot"><span class="annottext">chop :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#chop"><span class="hs-identifier hs-var hs-var">chop</span></a></span></span><span> </span><span id="local-6989586621679044634"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044634"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-197"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679044633"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044633"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044632"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044632"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044631"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044631"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044634"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044632"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044631"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044633"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044632"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044631"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679044630"><span class="annot"><a href="Data.List.HT.Private.html#chop%27"><span class="hs-identifier hs-type">chop'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044630"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044630"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044630"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-200"></span><span id="chop%27"><span class="annot"><span class="annottext">chop' :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#chop%27"><span class="hs-identifier hs-var hs-var">chop'</span></a></span></span><span> </span><span id="local-6989586621679044628"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044628"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044627"><span class="annot"><span class="annottext">recourse :: [a] -&gt; [[a]]
</span><a href="#local-6989586621679044627"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>          </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-203"></span><span>          </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var">switchL</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
</span><a href="#local-6989586621679044627"><span class="hs-identifier hs-var">recourse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-204"></span><span>          </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044628"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-205"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
</span><a href="#local-6989586621679044627"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621679044624"><span class="annot"><a href="Data.List.HT.Private.html#chopAtRun"><span class="hs-identifier hs-type">chopAtRun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-209"></span><span id="chopAtRun"><span class="annot"><span class="annottext">chopAtRun :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#chopAtRun"><span class="hs-identifier hs-var hs-var">chopAtRun</span></a></span></span><span> </span><span id="local-6989586621679044622"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044622"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044621"><span class="annot"><span class="annottext">recourse :: [a] -&gt; [[a]]
</span><a href="#local-6989586621679044621"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>       </span><span class="annot"><a href="#local-6989586621679044621"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span id="local-6989586621679044620"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044620"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044619"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044619"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044618"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044618"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044622"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044622"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044620"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044619"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
</span><a href="#local-6989586621679044621"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044618"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-214"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
</span><a href="#local-6989586621679044621"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">{- |
Like 'break', but splits after the matching element.

prop&gt; forAllPredicates $ \p xs -&gt; uncurry (++) (breakAfter p xs) == xs
-}</span><span>
</span><span id="line-222"></span><span id="local-6989586621679045044"><span class="annot"><a href="Data.List.HT.Private.html#breakAfter"><span class="hs-identifier hs-type">breakAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045044"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-223"></span><span id="breakAfter"><span class="annot"><span class="annottext">breakAfter :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfter"><span class="hs-identifier hs-var hs-var">breakAfter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfterRec"><span class="hs-identifier hs-var">breakAfterRec</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679044615"><span class="annot"><a href="Data.List.HT.Private.html#breakAfterRec"><span class="hs-identifier hs-type">breakAfterRec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-226"></span><span id="breakAfterRec"><span class="annot"><span class="annottext">breakAfterRec :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfterRec"><span class="hs-identifier hs-var hs-var">breakAfterRec</span></a></span></span><span> </span><span id="local-6989586621679044614"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044614"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044613"><span class="annot"><span class="annottext">recourse :: [a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044613"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>       </span><span class="annot"><a href="#local-6989586621679044613"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044612"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044612"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044611"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044611"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>          </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044612"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044614"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044612"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044611"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044613"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044611"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-233"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], [a])
</span><a href="#local-6989586621679044613"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">{-
The use of 'foldr' might allow for fusion,
but unfortunately this simple implementation would copy the tail of the list.
-}</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | prop&gt; forAllPredicates $ \p xs -&gt; breakAfterRec p xs == breakAfterFoldr p xs</span><span>
</span><span id="line-240"></span><span id="local-6989586621679044610"><span class="annot"><a href="Data.List.HT.Private.html#breakAfterFoldr"><span class="hs-identifier hs-type">breakAfterFoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-241"></span><span id="breakAfterFoldr"><span class="annot"><span class="annottext">breakAfterFoldr :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfterFoldr"><span class="hs-identifier hs-var hs-var">breakAfterFoldr</span></a></span></span><span> </span><span id="local-6989586621679044607"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-243"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044606"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044605"><span class="annot"><span class="annottext">([a], [a])
</span><a href="#local-6989586621679044605"><span class="hs-identifier hs-var">yzs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044606"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">([a], [a])
</span><a href="#local-6989586621679044605"><span class="hs-identifier hs-var">yzs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([a], [a])
</span><a href="#local-6989586621679044605"><span class="hs-identifier hs-var">yzs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | prop&gt; forAllPredicates $ \p xs -&gt; breakAfterRec p xs == breakAfterBreak p xs</span><span>
</span><span id="line-248"></span><span id="local-6989586621679044604"><span class="annot"><a href="Data.List.HT.Private.html#breakAfterBreak"><span class="hs-identifier hs-type">breakAfterBreak</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044604"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044604"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044604"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="breakAfterBreak"><span class="annot"><span class="annottext">breakAfterBreak :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfterBreak"><span class="hs-identifier hs-var hs-var">breakAfterBreak</span></a></span></span><span> </span><span id="local-6989586621679044602"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679044601"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044601"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044601"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679044600"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044600"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044600"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679044599"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044599"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044598"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044598"><span class="hs-identifier hs-var">z</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044597"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044597"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044599"><span class="hs-identifier hs-var">ys</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044598"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044597"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | prop&gt; forAllPredicates $ \p xs -&gt; breakAfterRec p xs == breakAfterTakeUntil p xs</span><span>
</span><span id="line-255"></span><span id="local-6989586621679044596"><span class="annot"><a href="Data.List.HT.Private.html#breakAfterTakeUntil"><span class="hs-identifier hs-type">breakAfterTakeUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-256"></span><span id="breakAfterTakeUntil"><span class="annot"><span class="annottext">breakAfterTakeUntil :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#breakAfterTakeUntil"><span class="hs-identifier hs-var hs-var">breakAfterTakeUntil</span></a></span></span><span> </span><span id="local-6989586621679044594"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044594"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679044593"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044593"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-258"></span><span>   </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044592"><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Data.List.HT.Private.html#viewR"><span class="hs-identifier hs-var">viewR</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-259"></span><span>   </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeUntil"><span class="hs-identifier hs-var">takeUntil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044594"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044593"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044593"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">{- |
Take all elements until one matches.
The matching element is returned, too.
This is the key difference to @takeWhile (not . p)@.
It holds:

prop&gt; forAllPredicates $ \p xs -&gt; takeUntil p xs == fst (breakAfter p xs)
-}</span><span>
</span><span id="line-269"></span><span id="local-6989586621679044588"><span class="annot"><a href="Data.List.HT.Private.html#takeUntil"><span class="hs-identifier hs-type">takeUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044588"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044588"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044588"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-270"></span><span id="takeUntil"><span class="annot"><span class="annottext">takeUntil :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeUntil"><span class="hs-identifier hs-var hs-var">takeUntil</span></a></span></span><span> </span><span id="local-6989586621679044586"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044586"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044585"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044584"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044584"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044586"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044584"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">{- |
Split the list after each occurence of a terminator.
Keep the terminator.
There is always a list for the part after the last terminator.
It may be empty.
See package @non-empty@ for more precise result type.

prop&gt; forAllPredicates $ \p xs -&gt; concat (segmentAfter p xs) == xs
prop&gt; forAllPredicates $ \p xs -&gt; length (filter p xs) == length (tail (segmentAfter p xs))
prop&gt; forAllPredicates $ \p -&gt; all (p . last) . init . segmentAfter p
prop&gt; forAllPredicates $ \p -&gt; all (all (not . p) . init) . init . segmentAfter p

This test captures both infinitely many groups and infinitely big groups:

prop&gt; forAllPredicates $ \p x -&gt; flip seq True . (!!100) . concat . segmentAfter p . cycle . (x:)
-}</span><span>
</span><span id="line-289"></span><span id="local-6989586621679044583"><span class="annot"><a href="Data.List.HT.Private.html#segmentAfter"><span class="hs-identifier hs-type">segmentAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044583"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044583"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-290"></span><span id="segmentAfter"><span class="annot"><span class="annottext">segmentAfter :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#segmentAfter"><span class="hs-identifier hs-var hs-var">segmentAfter</span></a></span></span><span> </span><span id="local-6989586621679044580"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044580"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-292"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044579"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044578"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044578"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044577"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044577"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>         </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044579"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-295"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044580"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044579"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044578"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044577"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044578"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044577"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621679044576"><span class="annot"><a href="Data.List.HT.Private.html#segmentAfter%27"><span class="hs-identifier hs-type">segmentAfter'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-299"></span><span id="segmentAfter%27"><span class="annot"><span class="annottext">segmentAfter' :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#segmentAfter%27"><span class="hs-identifier hs-var hs-var">segmentAfter'</span></a></span></span><span> </span><span id="local-6989586621679044573"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044573"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679044572"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044572"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span id="local-6989586621679044571"><span class="annot"><span class="annottext">yt :: [[a]]
</span><a href="#local-6989586621679044571"><span class="hs-identifier hs-var">yt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044570"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044570"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044569"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044569"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044573"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044572"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044571"><span class="hs-identifier hs-var">yt</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044572"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044570"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044569"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">{- |
Split the list before each occurence of a leading character.
Keep these characters.
There is always a list for the part before the first leading character.
It may be empty.
See package @non-empty@ for more precise result type.

prop&gt; forAllPredicates $ \p xs -&gt; concat (segmentBefore p xs) == xs
prop&gt; forAllPredicates $ \p xs -&gt; length (filter p xs) == length (tail (segmentBefore p xs))
prop&gt; forAllPredicates $ \p -&gt; all (p . head) . tail . segmentBefore p
prop&gt; forAllPredicates $ \p -&gt; all (all (not . p) . tail) . tail . segmentBefore p
prop&gt; forAllPredicates $ \p x -&gt; flip seq True . (!!100) . concat . segmentBefore p . cycle . (x:)
-}</span><span>
</span><span id="line-315"></span><span id="local-6989586621679044568"><span class="annot"><a href="Data.List.HT.Private.html#segmentBefore"><span class="hs-identifier hs-type">segmentBefore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-316"></span><span id="segmentBefore"><span class="annot"><span class="annottext">segmentBefore :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#segmentBefore"><span class="hs-identifier hs-var hs-var">segmentBefore</span></a></span></span><span> </span><span id="local-6989586621679044565"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044565"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span class="hs-comment">--   foldr (\ x ~(y:ys) -&gt; (if p x then ([]:) else id) ((x:y):ys)) [[]]</span><span>
</span><span id="line-318"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-319"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679044564"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044564"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044563"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044563"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044562"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044562"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044561"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679044561"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044564"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044563"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-322"></span><span>         </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044565"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044564"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044561"><span class="hs-identifier hs-var">xs</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044562"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044561"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044562"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | prop&gt; forAllPredicates $ \p xs -&gt; segmentBefore p xs == segmentBefore' p xs</span><span>
</span><span id="line-326"></span><span id="local-6989586621679044560"><span class="annot"><a href="Data.List.HT.Private.html#segmentBefore%27"><span class="hs-identifier hs-type">segmentBefore'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-327"></span><span id="segmentBefore%27"><span class="annot"><span class="annottext">segmentBefore' :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#segmentBefore%27"><span class="hs-identifier hs-var hs-var">segmentBefore'</span></a></span></span><span> </span><span id="local-6989586621679044552"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044552"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-329"></span><span>   </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044551"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044551"><span class="hs-identifier hs-var">xst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044551"><span class="hs-identifier hs-var">xst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>         </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679044550"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044550"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044549"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044549"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044548"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044548"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044551"><span class="hs-identifier hs-var">xst</span></a></span><span>
</span><span id="line-332"></span><span>         </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044552"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044550"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-333"></span><span>         </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044550"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044549"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044548"><span class="hs-identifier hs-var">xss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-334"></span><span>   </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679044547"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044547"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044552"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044547"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | prop&gt; forAllPredicates $ \p xs -&gt; segmentBefore p xs == segmentBefore'' p xs</span><span>
</span><span id="line-337"></span><span id="local-6989586621679044546"><span class="annot"><a href="Data.List.HT.Private.html#segmentBefore%27%27"><span class="hs-identifier hs-type">segmentBefore''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044546"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044546"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-338"></span><span id="segmentBefore%27%27"><span class="annot"><span class="annottext">segmentBefore'' :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#segmentBefore%27%27"><span class="hs-identifier hs-var hs-var">segmentBefore''</span></a></span></span><span> </span><span id="local-6989586621679044542"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044542"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>   </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044541"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044541"><span class="hs-identifier hs-var">xst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044541"><span class="hs-identifier hs-var">xst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>         </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044540"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044540"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044539"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044539"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044540"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044539"><span class="hs-identifier hs-var">xss</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-343"></span><span>   </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679044538"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044538"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044542"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044538"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-344"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;segmentBefore: dummy element&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">{- |
&gt;&gt;&gt; segmentBeforeJust (\c -&gt; toMaybe (isLetter c) (toUpper c)) &quot;123a5345b---&quot;
(&quot;123&quot;,[('A',&quot;5345&quot;),('B',&quot;---&quot;)])
-}</span><span>
</span><span id="line-351"></span><span id="local-6989586621679044985"><span id="local-6989586621679044986"><span class="annot"><a href="Data.List.HT.Private.html#segmentBeforeJust"><span class="hs-identifier hs-type">segmentBeforeJust</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-352"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044985"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>   </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044985"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-354"></span><span id="segmentBeforeJust"><span class="annot"><span class="annottext">segmentBeforeJust :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.HT.Private.html#segmentBeforeJust"><span class="hs-identifier hs-var hs-var">segmentBeforeJust</span></a></span></span><span> </span><span id="local-6989586621679044534"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044534"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-356"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679044533"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044533"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044532"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044532"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044531"><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044531"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044534"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044533"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-359"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679044530"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044530"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044530"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044532"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044531"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044533"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044532"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044531"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">{- |
&gt;&gt;&gt; segmentAfterJust (\c -&gt; toMaybe (isLetter c) (toUpper c)) &quot;123a5345b---&quot;
([(&quot;123&quot;,'A'),(&quot;5345&quot;,'B')],&quot;---&quot;)
-}</span><span>
</span><span id="line-367"></span><span id="local-6989586621679044981"><span id="local-6989586621679044982"><span class="annot"><a href="Data.List.HT.Private.html#segmentAfterJust"><span class="hs-identifier hs-type">segmentAfterJust</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-368"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044982"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044981"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>   </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044982"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044982"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044981"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044982"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-370"></span><span id="segmentAfterJust"><span class="annot"><span class="annottext">segmentAfterJust :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([([a], b)], [a])
</span><a href="Data.List.HT.Private.html#segmentAfterJust"><span class="hs-identifier hs-var hs-var">segmentAfterJust</span></a></span></span><span> </span><span id="local-6989586621679044526"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044526"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (b, a)
</span><a href="Data.Tuple.Lazy.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-372"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044525"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044525"><span class="hs-identifier hs-var">as0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044524"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044524"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044523"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044523"><span class="hs-identifier hs-var">as1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044523"><span class="hs-identifier hs-var">as1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044525"><span class="hs-identifier hs-var">as0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044524"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-373"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.HT.Private.html#segmentBeforeJust"><span class="hs-identifier hs-var">segmentBeforeJust</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044526"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">{- |
&gt;&gt;&gt; segmentBeforeRight [Left 'a', Right LT, Right GT, Left 'b']
(&quot;a&quot;,[(LT,&quot;&quot;),(GT,&quot;b&quot;)])

prop&gt; forAllMaybeFn $ \f xs -&gt; segmentBeforeJust f xs == segmentBeforeRight (map (\x -&gt; maybe (Left x) Right (f x)) xs)
-}</span><span>
</span><span id="line-382"></span><span id="local-6989586621679044971"><span id="local-6989586621679044972"><span class="annot"><a href="Data.List.HT.Private.html#segmentBeforeRight"><span class="hs-identifier hs-type">segmentBeforeRight</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-383"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679044972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044971"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044971"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-384"></span><span id="segmentBeforeRight"><span class="annot"><span class="annottext">segmentBeforeRight :: forall a b. [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.HT.Private.html#segmentBeforeRight"><span class="hs-identifier hs-var hs-var">segmentBeforeRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-386"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-387"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679044520"><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679044520"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044519"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044519"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044518"><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044518"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679044520"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679044517"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044517"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044517"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044519"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044518"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679044516"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044516"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044516"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044519"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679044518"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">{- |
&gt;&gt;&gt; segmentAfterRight [Left 'a', Right LT, Right GT, Left 'b']
([(&quot;a&quot;,LT),(&quot;&quot;,GT)],&quot;b&quot;)

prop&gt; forAllMaybeFn $ \f xs -&gt; segmentAfterJust f xs == segmentAfterRight (map (\x -&gt; maybe (Left x) Right (f x)) xs)
-}</span><span>
</span><span id="line-399"></span><span id="local-6989586621679044967"><span id="local-6989586621679044968"><span class="annot"><a href="Data.List.HT.Private.html#segmentAfterRight"><span class="hs-identifier hs-type">segmentAfterRight</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-400"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679044968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044967"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044967"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-401"></span><span id="segmentAfterRight"><span class="annot"><span class="annottext">segmentAfterRight :: forall a b. [Either a b] -&gt; ([([a], b)], [a])
</span><a href="Data.List.HT.Private.html#segmentAfterRight"><span class="hs-identifier hs-var hs-var">segmentAfterRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (b, a)
</span><a href="Data.Tuple.Lazy.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-403"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044513"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044513"><span class="hs-identifier hs-var">as0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044512"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044512"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044511"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044511"><span class="hs-identifier hs-var">as1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044511"><span class="hs-identifier hs-var">as1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044513"><span class="hs-identifier hs-var">as0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044512"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-404"></span><span>   </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.HT.Private.html#segmentBeforeRight"><span class="hs-identifier hs-var">segmentBeforeRight</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- cf. Matroid.hs</span><span>
</span><span id="line-408"></span><span class="hs-comment">{- |
@removeEach xs@ represents a list of sublists of @xs@,
where each element of @xs@ is removed and
the removed element is separated.
It seems to be much simpler to achieve with
@zip xs (map (flip List.delete xs) xs)@,
but the implementation of 'removeEach' does not need the 'Eq' instance
and thus can also be used for lists of functions.

See also the proposal
 &lt;http://www.haskell.org/pipermail/libraries/2008-February/009270.html&gt;

&gt;&gt;&gt; removeEach &quot;abc&quot;
[('a',&quot;bc&quot;),('b',&quot;ac&quot;),('c',&quot;ab&quot;)]
&gt;&gt;&gt; removeEach &quot;a&quot;
[('a',&quot;&quot;)]
&gt;&gt;&gt; removeEach &quot;&quot;
[]
-}</span><span>
</span><span id="line-427"></span><span id="local-6989586621679044964"><span class="annot"><a href="Data.List.HT.Private.html#removeEach"><span class="hs-identifier hs-type">removeEach</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-428"></span><span id="removeEach"><span class="annot"><span class="annottext">removeEach :: forall a. [a] -&gt; [(a, [a])]
</span><a href="Data.List.HT.Private.html#removeEach"><span class="hs-identifier hs-var hs-var">removeEach</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044509"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044509"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044508"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044508"><span class="hs-identifier hs-var">pivot</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044507"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044507"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044508"><span class="hs-identifier hs-var">pivot</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044509"><span class="hs-identifier hs-var">ys</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044507"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [([a], a, [a])]
</span><a href="Data.List.HT.Private.html#splitEverywhere"><span class="hs-identifier hs-var">splitEverywhere</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">{- |
&gt;&gt;&gt; splitEverywhere &quot;abc&quot;
[(&quot;&quot;,'a',&quot;bc&quot;),(&quot;a&quot;,'b',&quot;c&quot;),(&quot;ab&quot;,'c',&quot;&quot;)]
&gt;&gt;&gt; splitEverywhere &quot;a&quot;
[(&quot;&quot;,'a',&quot;&quot;)]
&gt;&gt;&gt; splitEverywhere &quot;&quot;
[]
-}</span><span>
</span><span id="line-439"></span><span id="local-6989586621679044962"><span class="annot"><a href="Data.List.HT.Private.html#splitEverywhere"><span class="hs-identifier hs-type">splitEverywhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-440"></span><span id="splitEverywhere"><span class="annot"><span class="annottext">splitEverywhere :: forall a. [a] -&gt; [([a], a, [a])]
</span><a href="Data.List.HT.Private.html#splitEverywhere"><span class="hs-identifier hs-var hs-var">splitEverywhere</span></a></span></span><span> </span><span id="local-6989586621679044503"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044503"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-442"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044502"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044502"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044501"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044501"><span class="hs-identifier hs-var">zs0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044501"><span class="hs-identifier hs-var">zs0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-444"></span><span>            </span><span id="local-6989586621679044500"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044500"><span class="hs-identifier hs-var">z</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044499"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044499"><span class="hs-identifier hs-var">zs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044502"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044500"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044499"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;splitEverywhere: empty list&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#inits"><span class="hs-identifier hs-var">inits</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044503"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044503"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">--  * inspect ends of a list</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">splitLast</span><span> </span><span class="hs-pragma">&quot;use viewR instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-453"></span><span class="hs-comment">{- |
It holds @splitLast xs == (init xs, last xs)@,
but 'splitLast' is more efficient
if the last element is accessed after the initial ones,
because it avoids memoizing list.

prop&gt; \(NonEmpty xs) -&gt; splitLast (xs::String)  ==  (init xs, last xs)
-}</span><span>
</span><span id="line-461"></span><span id="local-6989586621679044960"><span class="annot"><a href="Data.List.HT.Private.html#splitLast"><span class="hs-identifier hs-type">splitLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044960"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044960"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044960"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-462"></span><span id="splitLast"><span class="annot"><span class="annottext">splitLast :: forall a. [a] -&gt; ([a], a)
</span><a href="Data.List.HT.Private.html#splitLast"><span class="hs-identifier hs-var hs-var">splitLast</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;splitLast: empty list&quot;</span></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Data.List.HT.Private.html#splitLast"><span class="hs-identifier hs-var">splitLast</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679044494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044494"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044494"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="annot"><a href="Data.List.HT.Private.html#splitLast"><span class="hs-identifier hs-var">splitLast</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044493"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044493"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044492"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044492"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044491"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044491"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044490"><span class="hs-identifier hs-var">lastx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; ([a], a)
</span><a href="Data.List.HT.Private.html#splitLast"><span class="hs-identifier hs-var">splitLast</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044492"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044493"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044491"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044490"><span class="hs-identifier hs-var">lastx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">{- |
Should be prefered to 'head' and 'tail'.
-}</span><span>
</span><span id="line-471"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#viewL"><span class="hs-pragma hs-type">viewL</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-472"></span><span id="local-6989586621679045026"><span class="annot"><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-type">viewL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045026"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-473"></span><span id="viewL"><span class="annot"><span class="annottext">viewL :: forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var hs-var">viewL</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044489"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044489"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044488"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044488"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044489"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044488"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span class="annot"><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">{- |
Should be prefered to 'init' and 'last'.

prop&gt; \xs -&gt; maybe True ((init xs, last xs) == ) (viewR (xs::String))
-}</span><span>
</span><span id="line-481"></span><span id="local-6989586621679044998"><span class="annot"><a href="Data.List.HT.Private.html#viewR"><span class="hs-identifier hs-type">viewR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044998"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-482"></span><span id="viewR"><span class="annot"><span class="annottext">viewR :: forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Data.List.HT.Private.html#viewR"><span class="hs-identifier hs-var hs-var">viewR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-483"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044486"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044486"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044486"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044486"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">{- |
Should be prefered to 'head' and 'tail'.
-}</span><span>
</span><span id="line-488"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#switchL"><span class="hs-pragma hs-type">switchL</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-489"></span><span id="local-6989586621679045011"><span id="local-6989586621679045012"><span class="annot"><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-type">switchL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679045012"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679045011"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045011"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679045012"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679045011"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679045012"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-490"></span><span id="switchL"><span class="annot"><span class="annottext">switchL :: forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var hs-var">switchL</span></a></span></span><span> </span><span id="local-6989586621679044485"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044485"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044485"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var">switchL</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679044484"><span class="annot"><span class="annottext">a -&gt; [a] -&gt; b
</span><a href="#local-6989586621679044484"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044483"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044483"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044482"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044482"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; b
</span><a href="#local-6989586621679044484"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044482"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span id="local-6989586621679044480"><span id="local-6989586621679044481"><span class="annot"><a href="Data.List.HT.Private.html#switchL%27"><span class="hs-identifier hs-type">switchL'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044481"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044480"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044480"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044480"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044481"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-494"></span><span id="switchL%27"><span class="annot"><span class="annottext">switchL' :: forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL%27"><span class="hs-identifier hs-var hs-var">switchL'</span></a></span></span><span> </span><span id="local-6989586621679044478"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044478"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044477"><span class="annot"><span class="annottext">a -&gt; [a] -&gt; b
</span><a href="#local-6989586621679044477"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>   </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044478"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; b
</span><a href="#local-6989586621679044477"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">{- |
Should be prefered to 'init' and 'last'.

prop&gt; \xs -&gt; switchR True (\ixs lxs -&gt; ixs == init xs &amp;&amp; lxs == last xs) (xs::String)
-}</span><span>
</span><span id="line-502"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#switchR"><span class="hs-pragma hs-type">switchR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-503"></span><span id="local-6989586621679044951"><span id="local-6989586621679044952"><span class="annot"><a href="Data.List.HT.Private.html#switchR"><span class="hs-identifier hs-type">switchR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044952"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044951"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044952"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044952"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-504"></span><span id="switchR"><span class="annot"><span class="annottext">switchR :: forall b a. b -&gt; ([a] -&gt; a -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchR"><span class="hs-identifier hs-var hs-var">switchR</span></a></span></span><span> </span><span id="local-6989586621679044475"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044475"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044474"><span class="annot"><span class="annottext">[a] -&gt; a -&gt; b
</span><a href="#local-6989586621679044474"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-505"></span><span>   </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044475"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a -&gt; b
</span><a href="#local-6989586621679044474"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Data.List.HT.Private.html#viewR"><span class="hs-identifier hs-var">viewR</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-comment">-- * List processing starting at the end</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">{- |
@takeRev n@ is like @reverse . take n . reverse@
but it is lazy enough to work for infinite lists, too.

prop&gt; \n xs -&gt; takeRev n (xs::String) == reverse (take n (reverse xs))
-}</span><span>
</span><span id="line-516"></span><span id="local-6989586621679044948"><span class="annot"><a href="Data.List.HT.Private.html#takeRev"><span class="hs-identifier hs-type">takeRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044948"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-517"></span><span id="takeRev"><span class="annot"><span class="annottext">takeRev :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeRev"><span class="hs-identifier hs-var hs-var">takeRev</span></a></span></span><span> </span><span id="local-6989586621679044472"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044472"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044471"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044471"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#drop"><span class="hs-identifier hs-var">Match.drop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044472"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044471"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044471"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">{- |
@dropRev n@ is like @reverse . drop n . reverse@
but it is lazy enough to work for infinite lists, too.

prop&gt; \n xs -&gt; dropRev n (xs::String) == reverse (drop n (reverse xs))
-}</span><span>
</span><span id="line-525"></span><span id="local-6989586621679044468"><span class="annot"><a href="Data.List.HT.Private.html#dropRev"><span class="hs-identifier hs-type">dropRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-526"></span><span id="dropRev"><span class="annot"><span class="annottext">dropRev :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#dropRev"><span class="hs-identifier hs-var hs-var">dropRev</span></a></span></span><span> </span><span id="local-6989586621679044466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044466"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044465"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044465"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#take"><span class="hs-identifier hs-var">Match.take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044466"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044465"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044465"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">{- |
@splitAtRev n xs == (dropRev n xs, takeRev n xs)@.

prop&gt; \n xs -&gt; splitAtRev n (xs::String) == (dropRev n xs, takeRev n xs)
prop&gt; \n xs -&gt; (xs::String) == uncurry (++) (splitAtRev n xs)
-}</span><span>
</span><span id="line-534"></span><span id="local-6989586621679044943"><span class="annot"><a href="Data.List.HT.Private.html#splitAtRev"><span class="hs-identifier hs-type">splitAtRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-535"></span><span id="splitAtRev"><span class="annot"><span class="annottext">splitAtRev :: forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#splitAtRev"><span class="hs-identifier hs-var hs-var">splitAtRev</span></a></span></span><span> </span><span id="local-6989586621679044462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044462"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044461"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044461"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.Match.Private.html#splitAt"><span class="hs-identifier hs-var">Match.splitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044462"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044461"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044461"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">-- * List processing with Maybe and Either</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">{- |
@maybePrefixOf xs ys@ is @Just zs@ if @xs@ is a prefix of @ys@,
where @zs@ is @ys@ without the prefix @xs@.
Otherwise it is @Nothing@.
It is the same as 'Data.List.stripPrefix'.

&gt;&gt;&gt; maybePrefixOf &quot;abc&quot; &quot;abcdef&quot;
Just &quot;def&quot;
&gt;&gt;&gt; maybePrefixOf &quot;def&quot; &quot;abcdef&quot;
Nothing
-}</span><span>
</span><span id="line-551"></span><span id="local-6989586621679044939"><span class="annot"><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-type">maybePrefixOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044939"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044939"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044939"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044939"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-552"></span><span id="maybePrefixOf"><span class="annot"><span class="annottext">maybePrefixOf :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var hs-var">maybePrefixOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044453"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044453"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044452"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044452"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044451"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044451"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044450"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044450"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044453"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044451"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044452"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044450"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679044449"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044449"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044449"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-554"></span><span class="annot"><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">{- |
&gt;&gt;&gt; maybeSuffixOf &quot;abc&quot; &quot;abcdef&quot;
Nothing
&gt;&gt;&gt; maybeSuffixOf &quot;def&quot; &quot;abcdef&quot;
Just &quot;abc&quot;
-}</span><span>
</span><span id="line-562"></span><span id="local-6989586621679044448"><span class="annot"><a href="Data.List.HT.Private.html#maybeSuffixOf"><span class="hs-identifier hs-type">maybeSuffixOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044448"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044448"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044448"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044448"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-563"></span><span id="maybeSuffixOf"><span class="annot"><span class="annottext">maybeSuffixOf :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybeSuffixOf"><span class="hs-identifier hs-var hs-var">maybeSuffixOf</span></a></span></span><span> </span><span id="local-6989586621679044442"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044442"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679044441"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044441"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-564"></span><span>   </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044442"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044441"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">{- |
Partition a list into elements which evaluate to @Just@ or @Nothing@ by @f@.

prop&gt; forAllMaybeFn $ \f xs -&gt; partitionMaybe f xs == (mapMaybe f xs, filter (isNothing . f) xs)
prop&gt; forAllPredicates $ \p xs -&gt; partition p xs == partitionMaybe (\x -&gt; toMaybe (p x) x) xs
-}</span><span>
</span><span id="line-573"></span><span id="local-6989586621679044930"><span id="local-6989586621679044931"><span class="annot"><a href="Data.List.HT.Private.html#partitionMaybe"><span class="hs-identifier hs-type">partitionMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044931"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044930"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044931"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044930"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044931"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-574"></span><span id="partitionMaybe"><span class="annot"><span class="annottext">partitionMaybe :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Data.List.HT.Private.html#partitionMaybe"><span class="hs-identifier hs-var hs-var">partitionMaybe</span></a></span></span><span> </span><span id="local-6989586621679044438"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044438"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-575"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-576"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044437"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044437"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044437"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044436"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044436"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044436"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044437"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-comment">{- |
This is the cousin of 'takeWhile'
analogously to 'catMaybes' being the cousin of 'filter'.

&gt;&gt;&gt; takeWhileJust [Just 'a', Just 'b', Nothing, Just 'c']
&quot;ab&quot;

Example: Keep the heads of sublists until an empty list occurs.

&gt;&gt;&gt; takeWhileJust $ map (fmap fst . viewL) [&quot;abc&quot;,&quot;def&quot;,&quot;&quot;,&quot;xyz&quot;]
&quot;ad&quot;

For consistency with 'takeWhile',
'partitionMaybe' and 'dropWhileNothing' it should have been:

&gt; takeWhileJust_ :: (a -&gt; Maybe b) -&gt; a -&gt; [b]

However, both variants are interchangeable:

&gt; takeWhileJust_ f == takeWhileJust . map f
&gt; takeWhileJust == takeWhileJust_ id
-}</span><span>
</span><span id="line-602"></span><span id="local-6989586621679044927"><span class="annot"><a href="Data.List.HT.Private.html#takeWhileJust"><span class="hs-identifier hs-type">takeWhileJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-603"></span><span id="takeWhileJust"><span class="annot"><span class="annottext">takeWhileJust :: forall a. [Maybe a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeWhileJust"><span class="hs-identifier hs-var hs-var">takeWhileJust</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044433"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679044433"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044432"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044432"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044432"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679044433"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span id="local-6989586621679044924"><span id="local-6989586621679044925"><span class="annot"><a href="Data.List.HT.Private.html#dropWhileNothing"><span class="hs-identifier hs-type">dropWhileNothing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-607"></span><span id="dropWhileNothing"><span class="annot"><span class="annottext">dropWhileNothing :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe (b, [a])
</span><a href="Data.List.HT.Private.html#dropWhileNothing"><span class="hs-identifier hs-var hs-var">dropWhileNothing</span></a></span></span><span> </span><span id="local-6989586621679044425"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044425"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a c b.
Functor f =&gt;
(a -&gt; f c) -&gt; (a, b) -&gt; f (c, b)
</span><a href="Control.Functor.HT.html#mapFst"><span class="hs-identifier hs-var">Func.mapFst</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044425"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="Control.Monad.HT.html#%3C%3D%3C"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-comment">-- | prop&gt; forAllMaybeFn $ \f xs -&gt; dropWhileNothing f xs == dropWhileNothingRec f xs</span><span>
</span><span id="line-611"></span><span id="local-6989586621679044422"><span id="local-6989586621679044423"><span class="annot"><a href="Data.List.HT.Private.html#dropWhileNothingRec"><span class="hs-identifier hs-type">dropWhileNothingRec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044422"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044422"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-612"></span><span id="dropWhileNothingRec"><span class="annot"><span class="annottext">dropWhileNothingRec :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe (b, [a])
</span><a href="Data.List.HT.Private.html#dropWhileNothingRec"><span class="hs-identifier hs-var hs-var">dropWhileNothingRec</span></a></span></span><span> </span><span id="local-6989586621679044420"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044420"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-613"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044417"><span class="annot"><span class="annottext">go :: [a] -&gt; Maybe (b, [a])
</span><a href="#local-6989586621679044417"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-614"></span><span>       </span><span class="annot"><a href="#local-6989586621679044417"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044416"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044415"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044415"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044415"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044420"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044416"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (b, [a])
</span><a href="#local-6989586621679044417"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044415"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-615"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (b, [a])
</span><a href="#local-6989586621679044417"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- | prop&gt; forAllMaybeFn $ \f xs -&gt; snd (breakJust f xs) == dropWhileNothing f xs</span><span>
</span><span id="line-618"></span><span id="local-6989586621679044900"><span id="local-6989586621679044901"><span class="annot"><a href="Data.List.HT.Private.html#breakJust"><span class="hs-identifier hs-type">breakJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044901"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044901"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-619"></span><span id="breakJust"><span class="annot"><span class="annottext">breakJust :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], Maybe (b, [a]))
</span><a href="Data.List.HT.Private.html#breakJust"><span class="hs-identifier hs-var hs-var">breakJust</span></a></span></span><span> </span><span id="local-6989586621679044413"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044413"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-620"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044412"><span class="annot"><span class="annottext">go :: [a] -&gt; ([a], Maybe (b, [a]))
</span><a href="#local-6989586621679044412"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>       </span><span class="annot"><a href="#local-6989586621679044412"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044411"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044411"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044410"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044410"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-622"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044413"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044411"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-623"></span><span>            </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044411"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], Maybe (b, [a]))
</span><a href="#local-6989586621679044412"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044410"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-624"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679044409"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044409"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044409"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044410"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; ([a], Maybe (b, [a]))
</span><a href="#local-6989586621679044412"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- memory leak, because xs is hold all the time</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | prop&gt; forAllMaybeFn $ \f xs -&gt; breakJust f xs == breakJustRemoveEach f xs</span><span>
</span><span id="line-629"></span><span id="local-6989586621679044407"><span id="local-6989586621679044408"><span class="annot"><a href="Data.List.HT.Private.html#breakJustRemoveEach"><span class="hs-identifier hs-type">breakJustRemoveEach</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044408"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044407"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044408"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044408"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044407"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044408"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-630"></span><span id="breakJustRemoveEach"><span class="annot"><span class="annottext">breakJustRemoveEach :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], Maybe (b, [a]))
</span><a href="Data.List.HT.Private.html#breakJustRemoveEach"><span class="hs-identifier hs-var hs-var">breakJustRemoveEach</span></a></span></span><span> </span><span id="local-6989586621679044404"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044404"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044403"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044403"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-631"></span><span>   </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var">switchL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044403"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-632"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044402"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044402"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044401"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044401"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044400"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044400"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044399"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044399"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044402"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044399"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044400"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044404"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044401"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-633"></span><span>   </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [([a], a, [a])]
</span><a href="Data.List.HT.Private.html#splitEverywhere"><span class="hs-identifier hs-var">splitEverywhere</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044403"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- needs to apply 'f' twice at the end and uses partial functions</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- | prop&gt; forAllMaybeFn $ \f xs -&gt; breakJust f xs == breakJustPartial f xs</span><span>
</span><span id="line-637"></span><span id="local-6989586621679044397"><span id="local-6989586621679044398"><span class="annot"><a href="Data.List.HT.Private.html#breakJustPartial"><span class="hs-identifier hs-type">breakJustPartial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044398"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044397"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044397"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-638"></span><span id="breakJustPartial"><span class="annot"><span class="annottext">breakJustPartial :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], Maybe (b, [a]))
</span><a href="Data.List.HT.Private.html#breakJustPartial"><span class="hs-identifier hs-var hs-var">breakJustPartial</span></a></span></span><span> </span><span id="local-6989586621679044392"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044392"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044391"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044391"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-639"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044390"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044390"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044389"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044389"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044392"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044391"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-640"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044390"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-641"></span><span>        </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;breakJust: unexpected Nothing&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044392"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-642"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044389"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span id="local-6989586621679044386"><span id="local-6989586621679044387"><span class="annot"><a href="Data.List.HT.Private.html#spanJust"><span class="hs-identifier hs-type">spanJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044386"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044386"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-645"></span><span id="spanJust"><span class="annot"><span class="annottext">spanJust :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Data.List.HT.Private.html#spanJust"><span class="hs-identifier hs-var hs-var">spanJust</span></a></span></span><span> </span><span id="local-6989586621679044384"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044384"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-646"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044383"><span class="annot"><span class="annottext">go :: [a] -&gt; ([b], [a])
</span><a href="#local-6989586621679044383"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>       </span><span class="annot"><a href="#local-6989586621679044383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679044382"><span class="annot"><span class="annottext">xt :: [a]
</span><a href="#local-6989586621679044382"><span class="hs-identifier hs-var">xt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044381"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044381"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044380"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044380"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-648"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679044384"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044381"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-649"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679044379"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044379"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044379"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([b], [a])
</span><a href="#local-6989586621679044383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044380"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-650"></span><span>            </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044382"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; ([b], [a])
</span><a href="#local-6989586621679044383"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span id="local-6989586621679044886"><span id="local-6989586621679044887"><span class="annot"><a href="Data.List.HT.Private.html#unzipEithers"><span class="hs-identifier hs-type">unzipEithers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679044887"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044886"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044887"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044886"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-655"></span><span id="unzipEithers"><span class="annot"><span class="annottext">unzipEithers :: forall a b. [Either a b] -&gt; ([a], [b])
</span><a href="Data.List.HT.Private.html#unzipEithers"><span class="hs-identifier hs-var hs-var">unzipEithers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-656"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-657"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044375"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044375"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044375"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044374"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044374"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044374"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- * Sieve and slice</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-comment">{- | keep every k-th value from the list

&gt;&gt;&gt; sieve 6 ['a'..'z']
&quot;agmsy&quot;
-}</span><span>
</span><span id="line-667"></span><span id="local-6989586621679044373"><span class="annot"><a href="Data.List.HT.Private.html#sieve"><span class="hs-identifier hs-type">sieve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sieve%27"><span class="hs-identifier hs-type">sieve'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sieve%27%27"><span class="hs-identifier hs-type">sieve''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sieve%27%27%27"><span class="hs-identifier hs-type">sieve'''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044373"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044373"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-668"></span><span id="sieve"><span class="annot"><span class="annottext">sieve :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#sieve"><span class="hs-identifier hs-var hs-var">sieve</span></a></span></span><span> </span><span id="local-6989586621679044367"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044367"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-669"></span><span>   </span><span class="annot"><span class="annottext">forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044366"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044366"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Bool -&gt; a -&gt; Maybe a
</span><a href="Data.Maybe.HT.html#toMaybe"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044366"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044366"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044367"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044366"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-comment">-- | prop&gt; \(Positive n) xs -&gt; sieve n xs == sieve' n (xs::String)</span><span>
</span><span id="line-672"></span><span id="sieve%27"><span class="annot"><span class="annottext">sieve' :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#sieve%27"><span class="hs-identifier hs-var hs-var">sieve'</span></a></span></span><span> </span><span id="local-6989586621679044364"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044364"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceVertical"><span class="hs-identifier hs-var">sliceVertical</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044364"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="hs-comment">-- | prop&gt; \(Positive n) xs -&gt; sieve n xs == sieve'' n (xs::String)</span><span>
</span><span id="line-675"></span><span id="sieve%27%27"><span class="annot"><span class="annottext">sieve'' :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#sieve%27%27"><span class="hs-identifier hs-var hs-var">sieve''</span></a></span></span><span> </span><span id="local-6989586621679044355"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044355"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044354"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044354"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044354"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044355"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044354"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | prop&gt; \(Positive n) xs -&gt; sieve n xs == sieve''' n (xs::String)</span><span>
</span><span id="line-678"></span><span id="sieve%27%27%27"><span class="annot"><span class="annottext">sieve''' :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#sieve%27%27%27"><span class="hs-identifier hs-var hs-var">sieve'''</span></a></span></span><span> </span><span id="local-6989586621679044350"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044350"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044350"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-comment">{-
sliceHorizontal is faster than sliceHorizontal' but consumes slightly more memory
(although it needs no swapping)
-}</span><span>
</span><span id="line-685"></span><span class="hs-comment">{- |
&gt;&gt;&gt; sliceHorizontal 6 ['a'..'z']
[&quot;agmsy&quot;,&quot;bhntz&quot;,&quot;ciou&quot;,&quot;djpv&quot;,&quot;ekqw&quot;,&quot;flrx&quot;]

prop&gt; \(NonEmpty xs) -&gt; QC.forAll (QC.choose (1, length xs)) $ \n -&gt; sliceHorizontal n xs == transpose (sliceVertical n (xs::String))
prop&gt; \(NonEmpty xs) -&gt; QC.forAll (QC.choose (1, length xs)) $ \n -&gt; sliceVertical  n xs == transpose (sliceHorizontal n (xs::String))

The properties do not hold for empty lists because of:

&gt;&gt;&gt; sliceHorizontal 4 ([]::[Int])
[[],[],[],[]]
-}</span><span>
</span><span id="line-697"></span><span id="local-6989586621679044348"><span class="annot"><a href="Data.List.HT.Private.html#sliceHorizontal"><span class="hs-identifier hs-type">sliceHorizontal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sliceHorizontal%27"><span class="hs-identifier hs-type">sliceHorizontal'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sliceHorizontal%27%27"><span class="hs-identifier hs-type">sliceHorizontal''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sliceHorizontal%27%27%27"><span class="hs-identifier hs-type">sliceHorizontal'''</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-698"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044348"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-699"></span><span id="sliceHorizontal"><span class="annot"><span class="annottext">sliceHorizontal :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceHorizontal"><span class="hs-identifier hs-var hs-var">sliceHorizontal</span></a></span></span><span> </span><span id="local-6989586621679044343"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#sieve"><span class="hs-identifier hs-var">sieve</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | prop&gt; \(NonNegative n) xs -&gt; sliceHorizontal n xs == sliceHorizontal' n (xs::String)</span><span>
</span><span id="line-703"></span><span id="sliceHorizontal%27"><span class="annot"><span class="annottext">sliceHorizontal' :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceHorizontal%27"><span class="hs-identifier hs-var hs-var">sliceHorizontal'</span></a></span></span><span> </span><span id="local-6989586621679044340"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044339"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044339"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044338"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044337"><span class="annot"><span class="annottext">y :: [a]
</span><a href="#local-6989586621679044337"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#take"><span class="hs-identifier hs-var">Match.take</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044339"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044337"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-comment">-- | prop&gt; \(Positive n) xs -&gt; sliceHorizontal n xs == sliceHorizontal'' n (xs::String)</span><span>
</span><span id="line-707"></span><span id="sliceHorizontal%27%27"><span class="annot"><span class="annottext">sliceHorizontal'' :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceHorizontal%27%27"><span class="hs-identifier hs-var hs-var">sliceHorizontal''</span></a></span></span><span> </span><span id="local-6989586621679044333"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-708"></span><span>   </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044332"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044332"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044331"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044330"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044330"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044330"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044332"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span id="sliceHorizontal%27%27%27"><span class="annot"><span class="annottext">sliceHorizontal''' :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceHorizontal%27%27%27"><span class="hs-identifier hs-var hs-var">sliceHorizontal'''</span></a></span></span><span> </span><span id="local-6989586621679044328"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-711"></span><span>   </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-comment">{- |
&gt;&gt;&gt; sliceVertical 6 ['a'..'z']
[&quot;abcdef&quot;,&quot;ghijkl&quot;,&quot;mnopqr&quot;,&quot;stuvwx&quot;,&quot;yz&quot;]
-}</span><span>
</span><span id="line-718"></span><span id="local-6989586621679044874"><span class="annot"><a href="Data.List.HT.Private.html#sliceVertical"><span class="hs-identifier hs-type">sliceVertical</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#sliceVertical%27"><span class="hs-identifier hs-type">sliceVertical'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-719"></span><span id="sliceVertical"><span class="annot"><span class="annottext">sliceVertical :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceVertical"><span class="hs-identifier hs-var hs-var">sliceVertical</span></a></span></span><span> </span><span id="local-6989586621679044325"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-720"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-comment">{- takeWhile must be performed before (map take)
         in order to handle (n==0) correctly -}</span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-comment">-- | prop&gt; \(NonNegative n) xs -&gt; equating (take 100000) (sliceVertical n xs) (sliceVertical' n (xs::String))</span><span>
</span><span id="line-725"></span><span id="sliceVertical%27"><span class="annot"><span class="annottext">sliceVertical' :: forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#sliceVertical%27"><span class="hs-identifier hs-var hs-var">sliceVertical'</span></a></span></span><span> </span><span id="local-6989586621679044323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-726"></span><span>   </span><span class="annot"><span class="annottext">forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044322"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Bool -&gt; a -&gt; Maybe a
</span><a href="Data.Maybe.HT.html#toMaybe"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span class="hs-comment">-- * Search&amp;replace</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span id="local-6989586621679044860"><span class="annot"><a href="Data.List.HT.Private.html#search"><span class="hs-identifier hs-type">search</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-734"></span><span id="search"><span class="annot"><span class="annottext">search :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [Int]
</span><a href="Data.List.HT.Private.html#search"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span id="local-6989586621679044317"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044317"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679044316"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044316"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [Int]
</span><span class="hs-identifier hs-var">findIndices</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044317"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044316"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="hs-comment">{- |
prop&gt; \(NonEmpty xs) ys -&gt; replace xs xs ys == (ys::String)
prop&gt; \(NonEmpty xs) (NonEmpty ys) -&gt; equating (take 1000) (replace xs ys (cycle xs)) (cycle (ys::String))
-}</span><span>
</span><span id="line-740"></span><span id="local-6989586621679044856"><span class="annot"><a href="Data.List.HT.Private.html#replace"><span class="hs-identifier hs-type">replace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044856"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044856"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044856"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044856"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044856"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-741"></span><span id="replace"><span class="annot"><span class="annottext">replace :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#replace"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span id="local-6989586621679044313"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679044312"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044312"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-742"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044309"><span class="annot"><span class="annottext">recourse :: [a] -&gt; [a]
</span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-743"></span><span>       </span><span class="annot"><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span id="local-6989586621679044308"><span class="annot"><span class="annottext">str :: [a]
</span><a href="#local-6989586621679044308"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044307"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044307"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044306"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044306"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-744"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span>
</span><span id="line-745"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044307"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044306"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044312"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">recourse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-747"></span><span>              </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044308"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span id="local-6989586621679044854"><span class="annot"><a href="Data.List.HT.Private.html#markSublists"><span class="hs-identifier hs-type">markSublists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-751"></span><span id="markSublists"><span class="annot"><span class="annottext">markSublists :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [Maybe [a]]
</span><a href="Data.List.HT.Private.html#markSublists"><span class="hs-identifier hs-var hs-var">markSublists</span></a></span></span><span> </span><span id="local-6989586621679044303"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044303"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679044302"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044302"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-752"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044299"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044299"><span class="hs-identifier hs-var">hd'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044298"><span class="annot"><span class="annottext">[Maybe [a]]
</span><a href="#local-6989586621679044298"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-753"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044297"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044296"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044296"><span class="hs-identifier hs-var">hd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044295"><span class="annot"><span class="annottext">[Maybe [a]]
</span><a href="#local-6989586621679044295"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-754"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044294"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679044294"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044297"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044296"><span class="hs-identifier hs-var">hd</span></a></span><span>
</span><span id="line-755"></span><span>                   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044303"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044294"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-756"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679044293"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044293"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044293"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Maybe [a]]
</span><a href="#local-6989586621679044295"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>                         </span><span class="annot"><span class="annottext">Maybe [a]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044294"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Maybe [a]]
</span><a href="#local-6989586621679044295"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044302"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-758"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044299"><span class="hs-identifier hs-var">hd'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Maybe [a]]
</span><a href="#local-6989586621679044298"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span id="local-6989586621679044292"><span class="annot"><a href="Data.List.HT.Private.html#replace%27"><span class="hs-identifier hs-type">replace'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-761"></span><span id="replace%27"><span class="annot"><span class="annottext">replace' :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#replace%27"><span class="hs-identifier hs-var hs-var">replace'</span></a></span></span><span> </span><span id="local-6989586621679044287"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044287"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679044286"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044286"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621679044285"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044285"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-762"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044286"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [Maybe [a]]
</span><a href="Data.List.HT.Private.html#markSublists"><span class="hs-identifier hs-var">markSublists</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044287"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044285"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">{- | This is slightly wrong, because it re-replaces things.
     That's also the reason for inefficiency:
        The replacing can go on only when subsequent replacements are finished.
     Thus this functiob fails on infinite lists. -}</span><span>
</span><span id="line-768"></span><span id="local-6989586621679044283"><span class="annot"><a href="Data.List.HT.Private.html#replace%27%27"><span class="hs-identifier hs-type">replace''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-769"></span><span id="replace%27%27"><span class="annot"><span class="annottext">replace'' :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#replace%27%27"><span class="hs-identifier hs-var hs-var">replace''</span></a></span></span><span> </span><span id="local-6989586621679044277"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044277"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679044276"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044276"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-770"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044275"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044275"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044274"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044274"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044273"><span class="annot"><span class="annottext">y :: [a]
</span><a href="#local-6989586621679044273"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044275"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044274"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-771"></span><span>                    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044277"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044273"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-772"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044276"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044277"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044273"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-773"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044273"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">{- |
prop \src dst xs -&gt; replace src dst xs == multiReplace [(src,dst)] (xs::String)
-}</span><span>
</span><span id="line-778"></span><span id="local-6989586621679044847"><span class="annot"><a href="Data.List.HT.Private.html#multiReplace"><span class="hs-identifier hs-type">multiReplace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044847"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-779"></span><span id="multiReplace"><span class="annot"><span class="annottext">multiReplace :: forall a. Eq a =&gt; [([a], [a])] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#multiReplace"><span class="hs-identifier hs-var hs-var">multiReplace</span></a></span></span><span> </span><span id="local-6989586621679044270"><span class="annot"><span class="annottext">[([a], [a])]
</span><a href="#local-6989586621679044270"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-780"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044265"><span class="annot"><span class="annottext">recourse :: [a] -&gt; [a]
</span><a href="#local-6989586621679044265"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-781"></span><span>       </span><span class="annot"><a href="#local-6989586621679044265"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span id="local-6989586621679044264"><span class="annot"><span class="annottext">str :: [a]
</span><a href="#local-6989586621679044264"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044263"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044263"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044262"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044262"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-782"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span>
</span><span id="line-783"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044263"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044265"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044262"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-785"></span><span>              </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044261"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044261"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044260"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044260"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-786"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044260"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044265"><span class="hs-identifier hs-var">recourse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-787"></span><span>                      </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="Data.List.HT.Private.html#maybePrefixOf"><span class="hs-identifier hs-var">maybePrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044261"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044264"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([a], [a])]
</span><a href="#local-6989586621679044270"><span class="hs-identifier hs-var">dict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044265"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span id="local-6989586621679044259"><span class="annot"><a href="Data.List.HT.Private.html#multiReplace%27"><span class="hs-identifier hs-type">multiReplace'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044259"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-791"></span><span id="multiReplace%27"><span class="annot"><span class="annottext">multiReplace' :: forall a. Eq a =&gt; [([a], [a])] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#multiReplace%27"><span class="hs-identifier hs-var hs-var">multiReplace'</span></a></span></span><span> </span><span id="local-6989586621679044256"><span class="annot"><span class="annottext">[([a], [a])]
</span><a href="#local-6989586621679044256"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-792"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044253"><span class="annot"><span class="annottext">recourse :: [a] -&gt; [a]
</span><a href="#local-6989586621679044253"><span class="hs-identifier hs-var hs-var">recourse</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-793"></span><span>       </span><span class="annot"><a href="#local-6989586621679044253"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span id="local-6989586621679044252"><span class="annot"><span class="annottext">str :: [a]
</span><a href="#local-6989586621679044252"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044251"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044251"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044250"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044250"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-794"></span><span>          </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-795"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044251"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044253"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044250"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>             </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044249"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044249"><span class="hs-identifier hs-var">src</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044248"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044248"><span class="hs-identifier hs-var">dst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044248"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044253"><span class="hs-identifier hs-var">recourse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#drop"><span class="hs-identifier hs-var">Match.drop</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044249"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044252"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044252"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([a], [a])]
</span><a href="#local-6989586621679044256"><span class="hs-identifier hs-var">dict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679044253"><span class="hs-identifier hs-var">recourse</span></a></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-comment">-- * Lists of lists</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="hs-comment">{- |
Transform

&gt; [[00,01,02,...],          [[00],
&gt;  [10,11,12,...],   --&gt;     [10,01],
&gt;  [20,21,22,...],           [20,11,02],
&gt;  ...]                      ...]

With @concat . shear@ you can perform a Cantor diagonalization,
that is an enumeration of all elements of the sub-lists
where each element is reachable within a finite number of steps.
It is also useful for polynomial multiplication (convolution).
-}</span><span>
</span><span id="line-816"></span><span id="local-6989586621679044247"><span class="annot"><a href="Data.List.HT.Private.html#shear"><span class="hs-identifier hs-type">shear</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-817"></span><span id="shear"><span class="annot"><span class="annottext">shear :: forall a. [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#shear"><span class="hs-identifier hs-var hs-var">shear</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-818"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-819"></span><span>   </span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#shearTranspose"><span class="hs-identifier hs-var">shearTranspose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-820"></span><span>   </span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; [[Maybe a]]
</span><a href="Data.List.HT.Private.html#transposeFill"><span class="hs-identifier hs-var">transposeFill</span></a></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span id="local-6989586621679044841"><span class="annot"><a href="Data.List.HT.Private.html#transposeFill"><span class="hs-identifier hs-type">transposeFill</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-823"></span><span id="transposeFill"><span class="annot"><span class="annottext">transposeFill :: forall a. [[a]] -&gt; [[Maybe a]]
</span><a href="Data.List.HT.Private.html#transposeFill"><span class="hs-identifier hs-var hs-var">transposeFill</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-824"></span><span>   </span><span class="annot"><span class="annottext">forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044241"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044241"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><span class="annottext">forall a. Bool -&gt; a -&gt; Maybe a
</span><a href="Data.Maybe.HT.html#toMaybe"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044241"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.List.Reverse.StrictElement.html#dropWhile"><span class="hs-identifier hs-var">Rev.dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="Data.List.HT.Private.html#unzipCons"><span class="hs-identifier hs-var">unzipCons</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044241"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span id="local-6989586621679044839"><span class="annot"><a href="Data.List.HT.Private.html#unzipCons"><span class="hs-identifier hs-type">unzipCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-829"></span><span id="unzipCons"><span class="annot"><span class="annottext">unzipCons :: forall a. [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="Data.List.HT.Private.html#unzipCons"><span class="hs-identifier hs-var hs-var">unzipCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-830"></span><span>   </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="Data.List.HT.Private.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-831"></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044237"><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="#local-6989586621679044237"><span class="hs-identifier hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="#local-6989586621679044237"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="#local-6989586621679044237"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="hs-comment">{- |
It's somehow inverse to zipCons,
but the difficult part is,
that a trailing empty list on the right side is suppressed.
-}</span><span>
</span><span id="line-838"></span><span id="local-6989586621679044236"><span class="annot"><a href="Data.List.HT.Private.html#unzipConsSkew"><span class="hs-identifier hs-type">unzipConsSkew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679044236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-839"></span><span id="unzipConsSkew"><span class="annot"><span class="annottext">unzipConsSkew :: forall a. [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="Data.List.HT.Private.html#unzipConsSkew"><span class="hs-identifier hs-var hs-var">unzipConsSkew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-840"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044233"><span class="annot"><span class="annottext">aux :: [a] -&gt; [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="#local-6989586621679044233"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- one empty list at the end will be removed</span><span>
</span><span id="line-841"></span><span>       </span><span class="annot"><a href="#local-6989586621679044233"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span id="local-6989586621679044232"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044232"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679044231"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044231"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="Data.Tuple.Lazy.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044232"><span class="hs-identifier hs-var">xs</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; ([Maybe a], [[a]])
</span><a href="#local-6989586621679044230"><span class="hs-identifier hs-var">prep</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044231"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-842"></span><span>       </span><span id="local-6989586621679044230"><span class="annot"><span class="annottext">prep :: [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="#local-6989586621679044230"><span class="hs-identifier hs-var hs-var">prep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-843"></span><span>          </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (a, b)
</span><a href="Data.Tuple.Lazy.html#forcePair"><span class="hs-identifier hs-var">forcePair</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-844"></span><span>          </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var">switchL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>             </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044229"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044229"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679044228"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044228"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-846"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044227"><span class="annot"><span class="annottext">my :: Maybe (a, [a])
</span><a href="#local-6989586621679044227"><span class="hs-identifier hs-var hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (a, [a])
</span><a href="Data.List.HT.Private.html#viewL"><span class="hs-identifier hs-var">viewL</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044229"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-847"></span><span>                </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="#local-6989586621679044227"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-848"></span><span>                    </span><span class="annot"><span class="annottext">[a] -&gt; [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="#local-6989586621679044233"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Maybe (a, [a])
</span><a href="#local-6989586621679044227"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044228"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; ([Maybe a], [[a]])
</span><a href="#local-6989586621679044230"><span class="hs-identifier hs-var">prep</span></a></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span id="local-6989586621679044226"><span class="annot"><a href="Data.List.HT.Private.html#shear%27"><span class="hs-identifier hs-type">shear'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-854"></span><span id="shear%27"><span class="annot"><span class="annottext">shear' :: forall a. [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#shear%27"><span class="hs-identifier hs-var hs-var">shear'</span></a></span></span><span> </span><span id="local-6989586621679044223"><span class="annot"><span class="annottext">xs :: [[a]]
</span><a href="#local-6989586621679044223"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-855"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044222"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044222"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044221"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044221"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044220"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044220"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="Data.List.HT.Private.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044223"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>       </span><span id="local-6989586621679044219"><span class="annot"><span class="annottext">zipConc :: [[a]] -&gt; [[a]] -&gt; [[a]]
</span><a href="#local-6989586621679044219"><span class="hs-identifier hs-var hs-var">zipConc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044218"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044218"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044217"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044217"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044216"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044216"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044215"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044215"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044218"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044216"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; [[a]] -&gt; [[a]]
</span><a href="#local-6989586621679044219"><span class="hs-identifier hs-var">zipConc</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044217"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044215"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-857"></span><span>       </span><span class="annot"><a href="#local-6989586621679044219"><span class="hs-identifier hs-var">zipConc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679044214"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044214"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044214"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-858"></span><span>       </span><span class="annot"><a href="#local-6989586621679044219"><span class="hs-identifier hs-var">zipConc</span></a></span><span> </span><span id="local-6989586621679044213"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044213"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044213"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-859"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044222"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. [[a]] -&gt; [[a]] -&gt; [[a]]
</span><a href="#local-6989586621679044219"><span class="hs-identifier hs-var">zipConc</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044221"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#shear%27"><span class="hs-identifier hs-var">shear'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.List.Reverse.StrictElement.html#dropWhile"><span class="hs-identifier hs-var">Rev.dropWhile</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044220"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>              </span><span class="hs-comment">{- Dropping trailing empty lists is necessary,
                 otherwise finite lists are filled with empty lists. -}</span><span>
</span><span id="line-862"></span><span class="annot"><a href="Data.List.HT.Private.html#shear%27"><span class="hs-identifier hs-var">shear'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">{- |
Transform

&gt; [[00,01,02,...],          [[00],
&gt;  [10,11,12,...],   --&gt;     [01,10],
&gt;  [20,21,22,...],           [02,11,20],
&gt;  ...]                      ...]

It's like 'shear' but the order of elements in the sub list is reversed.
Its implementation seems to be more efficient than that of 'shear'.
If the order does not matter, better choose 'shearTranspose'.

prop&gt; \xs -&gt; shearTranspose xs  ==  map reverse (shear (xs::[String]))
-}</span><span>
</span><span id="line-878"></span><span id="local-6989586621679044212"><span class="annot"><a href="Data.List.HT.Private.html#shearTranspose"><span class="hs-identifier hs-type">shearTranspose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-879"></span><span id="shearTranspose"><span class="annot"><span class="annottext">shearTranspose :: forall a. [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#shearTranspose"><span class="hs-identifier hs-var hs-var">shearTranspose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-880"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipConsSkew"><span class="hs-identifier hs-var">zipConsSkew</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span id="local-6989586621679044834"><span class="annot"><a href="Data.List.HT.Private.html#zipConsSkew"><span class="hs-identifier hs-type">zipConsSkew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044834"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044834"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044834"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-883"></span><span id="zipConsSkew"><span class="annot"><span class="annottext">zipConsSkew :: forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipConsSkew"><span class="hs-identifier hs-var hs-var">zipConsSkew</span></a></span></span><span> </span><span id="local-6989586621679044209"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044209"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span id="local-6989586621679044208"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044208"><span class="hs-identifier hs-var">yss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-884"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-885"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044209"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-886"></span><span>      </span><span id="local-6989586621679044207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044207"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044206"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044206"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044207"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipCons"><span class="hs-identifier hs-var">zipCons</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044206"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044208"><span class="hs-identifier hs-var">yss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044208"><span class="hs-identifier hs-var">yss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">{- |
zipCons is like @zipWith (:)@ but it keeps lists which are too long
This version works also for @zipCons something undefined@.
-}</span><span>
</span><span id="line-893"></span><span id="local-6989586621679044204"><span class="annot"><a href="Data.List.HT.Private.html#zipCons"><span class="hs-identifier hs-type">zipCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-894"></span><span id="zipCons"><span class="annot"><span class="annottext">zipCons :: forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipCons"><span class="hs-identifier hs-var hs-var">zipCons</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044203"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044203"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044202"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044202"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679044201"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044201"><span class="hs-identifier hs-var">yt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-895"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044200"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044200"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044199"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044199"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; [a] -&gt; b) -&gt; [a] -&gt; b
</span><a href="Data.List.HT.Private.html#switchL"><span class="hs-identifier hs-var">switchL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044201"><span class="hs-identifier hs-var">yt</span></a></span><span>
</span><span id="line-896"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044203"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044200"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipCons"><span class="hs-identifier hs-var">zipCons</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044202"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044199"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-897"></span><span class="annot"><a href="Data.List.HT.Private.html#zipCons"><span class="hs-identifier hs-var">zipCons</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679044198"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044198"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044198"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | zipCons' is like @zipWith (:)@ but it keeps lists which are too long</span><span>
</span><span id="line-900"></span><span id="local-6989586621679044197"><span class="annot"><a href="Data.List.HT.Private.html#zipCons%27"><span class="hs-identifier hs-type">zipCons'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-901"></span><span id="zipCons%27"><span class="annot"><span class="annottext">zipCons' :: forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipCons%27"><span class="hs-identifier hs-var hs-var">zipCons'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044195"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044195"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044194"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044194"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044193"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044193"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044192"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044192"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044195"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044193"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="Data.List.HT.Private.html#zipCons%27"><span class="hs-identifier hs-var">zipCons'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044194"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044192"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-902"></span><span class="annot"><a href="Data.List.HT.Private.html#zipCons%27"><span class="hs-identifier hs-var">zipCons'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679044191"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044191"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679044191"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-903"></span><span class="annot"><a href="Data.List.HT.Private.html#zipCons%27"><span class="hs-identifier hs-var">zipCons'</span></a></span><span> </span><span id="local-6989586621679044190"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044190"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044190"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="hs-comment">{- |
Operate on each combination of elements of the first and the second list.
In contrast to the list instance of 'Monad.liftM2'
it holds the results in a list of lists.

prop&gt; \xs ys -&gt; let f x y = (x::Char,y::Int) in concat (outerProduct f xs ys)  ==  liftM2 f xs ys
-}</span><span>
</span><span id="line-913"></span><span id="local-6989586621679044828"><span id="local-6989586621679044829"><span id="local-6989586621679044830"><span class="annot"><a href="Data.List.HT.Private.html#outerProduct"><span class="hs-identifier hs-type">outerProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044829"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044828"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044829"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044828"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-914"></span><span id="outerProduct"><span class="annot"><span class="annottext">outerProduct :: forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [[c]]
</span><a href="Data.List.HT.Private.html#outerProduct"><span class="hs-identifier hs-var hs-var">outerProduct</span></a></span></span><span> </span><span id="local-6989586621679044188"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679044188"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044187"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044187"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679044186"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679044186"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679044186"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679044188"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044187"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span>
</span><span id="line-918"></span><span class="hs-comment">-- * Miscellaneous</span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">{- |
Take while first predicate holds,
then continue taking while second predicate holds,
and so on.
-}</span><span>
</span><span id="line-925"></span><span id="local-6989586621679044824"><span class="annot"><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-type">takeWhileMulti</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044824"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044824"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044824"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-926"></span><span id="takeWhileMulti"><span class="annot"><span class="annottext">takeWhileMulti :: forall a. [a -&gt; Bool] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-var hs-var">takeWhileMulti</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-927"></span><span class="annot"><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-var">takeWhileMulti</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span class="annot"><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-var">takeWhileMulti</span></a></span><span> </span><span id="local-6989586621679044184"><span class="annot"><span class="annottext">aps :: [a -&gt; Bool]
</span><a href="#local-6989586621679044184"><span class="hs-identifier hs-var">aps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044183"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044183"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044182"><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><a href="#local-6989586621679044182"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679044181"><span class="annot"><span class="annottext">axs :: [a]
</span><a href="#local-6989586621679044181"><span class="hs-identifier hs-var">axs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679044180"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044180"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044179"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044179"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-929"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679044183"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044180"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-930"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044180"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a -&gt; Bool] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-var">takeWhileMulti</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><a href="#local-6989586621679044184"><span class="hs-identifier hs-var">aps</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044179"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-931"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. [a -&gt; Bool] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeWhileMulti"><span class="hs-identifier hs-var">takeWhileMulti</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><a href="#local-6989586621679044182"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044181"><span class="hs-identifier hs-var">axs</span></a></span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span class="hs-comment">{- |
prop&gt; \ys xs -&gt; let ps = map (&lt;=) ys in takeWhileMulti ps xs == takeWhileMulti' ps (xs::String)
-}</span><span>
</span><span id="line-936"></span><span id="local-6989586621679044178"><span class="annot"><a href="Data.List.HT.Private.html#takeWhileMulti%27"><span class="hs-identifier hs-type">takeWhileMulti'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-937"></span><span id="takeWhileMulti%27"><span class="annot"><span class="annottext">takeWhileMulti' :: forall a. [a -&gt; Bool] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#takeWhileMulti%27"><span class="hs-identifier hs-var hs-var">takeWhileMulti'</span></a></span></span><span> </span><span id="local-6989586621679044173"><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><a href="#local-6989586621679044173"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679044172"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044172"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-938"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span>
</span><span id="line-939"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">scanl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.List.HT.Private.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044172"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool]
</span><a href="#local-6989586621679044173"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span class="hs-comment">{-
Debug.QuickCheck.quickCheck (propTakeWhileMulti [(&lt;0), (&gt;0), odd, even, ((0::Int)==)])
-}</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span class="hs-comment">{- |
This is a combination of 'foldl'' and 'foldr'
in the sense of 'propFoldl'r'.
It is however more efficient
because it avoids storing the whole input list as a result of sharing.
-}</span><span>
</span><span id="line-951"></span><span id="local-6989586621679044816"><span id="local-6989586621679044817"><span id="local-6989586621679044818"><span id="local-6989586621679044819"><span class="annot"><a href="Data.List.HT.Private.html#foldl%27r"><span class="hs-identifier hs-type">foldl'r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#foldl%27rStrict"><span class="hs-identifier hs-type">foldl'rStrict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#foldl%27rNaive"><span class="hs-identifier hs-type">foldl'rNaive</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-952"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044818"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044817"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044816"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044816"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044816"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044817"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044816"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-953"></span><span id="foldl%27r"><span class="annot"><span class="annottext">foldl'r :: forall b a c d.
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; (b, d)
</span><a href="Data.List.HT.Private.html#foldl%27r"><span class="hs-identifier hs-var hs-var">foldl'r</span></a></span></span><span> </span><span id="local-6989586621679044166"><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044166"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044165"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044165"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span id="local-6989586621679044164"><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044164"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679044163"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044163"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-954"></span><span class="hs-comment">--   (\(k,d1) -&gt; (k b0, d1)) .</span><span>
</span><span id="line-955"></span><span>   </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044165"><span class="hs-identifier hs-var">b0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-956"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044162"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044162"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044161"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044161"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044160"><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679044160"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044159"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044159"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044158"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044158"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679044160"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044166"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044158"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044162"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044164"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044161"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044159"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044163"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>
</span><span id="line-958"></span><span id="foldl%27rStrict"><span class="annot"><span class="annottext">foldl'rStrict :: forall b a c d.
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; (b, d)
</span><a href="Data.List.HT.Private.html#foldl%27rStrict"><span class="hs-identifier hs-var hs-var">foldl'rStrict</span></a></span></span><span> </span><span id="local-6989586621679044155"><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044155"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044154"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044154"><span class="hs-identifier hs-var">b0</span></a></span></span><span> </span><span id="local-6989586621679044153"><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044153"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679044152"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044152"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-959"></span><span>   </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (a, b) -&gt; (c, b)
</span><a href="Data.Tuple.Lazy.html#mapFst"><span class="hs-identifier hs-var">mapFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044154"><span class="hs-identifier hs-var">b0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-960"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044151"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044151"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044150"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044150"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679044149"><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679044149"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044148"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044148"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044147"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044147"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679044149"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044155"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044147"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044151"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044153"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044150"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044148"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044152"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span id="foldl%27rNaive"><span class="annot"><span class="annottext">foldl'rNaive :: forall b a c d.
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; (b, d)
</span><a href="Data.List.HT.Private.html#foldl%27rNaive"><span class="hs-identifier hs-var hs-var">foldl'rNaive</span></a></span></span><span> </span><span id="local-6989586621679044144"><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044144"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044143"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044143"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679044142"><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044142"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679044141"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044141"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679044140"><span class="annot"><span class="annottext">[(a, c)]
</span><a href="#local-6989586621679044140"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-963"></span><span>   </span><span class="annot"><span class="annottext">forall a c b d. (a -&gt; c, b -&gt; d) -&gt; (a, b) -&gt; (c, d)
</span><a href="Data.Tuple.Lazy.html#mapPair"><span class="hs-identifier hs-var">mapPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044144"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044143"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044142"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044141"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="Data.List.HT.Private.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, c)]
</span><a href="#local-6989586621679044140"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span id="local-6989586621679044794"><span id="local-6989586621679044795"><span id="local-6989586621679044796"><span id="local-6989586621679044797"><span class="annot"><a href="Data.List.HT.Private.html#propFoldl%27r"><span class="hs-identifier hs-type">propFoldl'r</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044797"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044796"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-966"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044797"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044795"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044797"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044797"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044794"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044796"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044796"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044796"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044794"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-967"></span><span id="propFoldl%27r"><span class="annot"><span class="annottext">propFoldl'r :: forall b d a c.
(Eq b, Eq d) =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; Bool
</span><a href="Data.List.HT.Private.html#propFoldl%27r"><span class="hs-identifier hs-var hs-var">propFoldl'r</span></a></span></span><span> </span><span id="local-6989586621679044134"><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044134"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044133"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044133"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679044132"><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044132"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679044131"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044131"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679044130"><span class="annot"><span class="annottext">[(a, c)]
</span><a href="#local-6989586621679044130"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-968"></span><span>   </span><span class="annot"><span class="annottext">forall b a c d.
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; (b, d)
</span><a href="Data.List.HT.Private.html#foldl%27r"><span class="hs-identifier hs-var">foldl'r</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044134"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044133"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044132"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044131"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, c)]
</span><a href="#local-6989586621679044130"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall b a c d.
(b -&gt; a -&gt; b) -&gt; b -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; [(a, c)] -&gt; (b, d)
</span><a href="Data.List.HT.Private.html#foldl%27rNaive"><span class="hs-identifier hs-var">foldl'rNaive</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; b
</span><a href="#local-6989586621679044134"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044133"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; d -&gt; d
</span><a href="#local-6989586621679044132"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044131"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, c)]
</span><a href="#local-6989586621679044130"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-969"></span><span>
</span><span id="line-970"></span><span class="hs-comment">{-
The results in GHCi surprise:

*List.HT&gt; mapSnd last $ foldl'rNaive (+) (0::Integer) (:) &quot;&quot; $ replicate 1000000 (1,'a')
(1000000,'a')
(0.44 secs, 141032856 bytes)

*List.HT&gt; mapSnd last $ foldl'r (+) (0::Integer) (:) &quot;&quot; $ replicate 1000000 (1,'a')
(1000000,'a')
(2.64 secs, 237424948 bytes)
-}</span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span class="hs-comment">{-
Debug.QuickCheck.quickCheck (\b d -&gt; propFoldl'r (+) (b::Int) (++) (d::[Int]))
-}</span><span>
</span><span id="line-985"></span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="hs-comment">{- |
&gt;&gt;&gt; lengthAtLeast 0 &quot;&quot;
True
&gt;&gt;&gt; lengthAtLeast 3 &quot;ab&quot;
False
&gt;&gt;&gt; lengthAtLeast 3 &quot;abc&quot;
True
&gt;&gt;&gt; lengthAtLeast 3 $ repeat 'a'
True
&gt;&gt;&gt; lengthAtLeast 3 $ &quot;abc&quot; ++ undefined
True

prop&gt; \n xs -&gt; lengthAtLeast n (xs::String)  ==  (length xs &gt;= n)
-}</span><span>
</span><span id="line-1001"></span><span id="local-6989586621679044787"><span class="annot"><a href="Data.List.HT.Private.html#lengthAtLeast"><span class="hs-identifier hs-type">lengthAtLeast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044787"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1002"></span><span id="lengthAtLeast"><span class="annot"><span class="annottext">lengthAtLeast :: forall a. Int -&gt; [a] -&gt; Bool
</span><a href="Data.List.HT.Private.html#lengthAtLeast"><span class="hs-identifier hs-var hs-var">lengthAtLeast</span></a></span></span><span> </span><span id="local-6989586621679044122"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044122"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1003"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044122"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1004"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1005"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044122"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span>
</span><span id="line-1007"></span><span class="hs-comment">{- |
&gt;&gt;&gt; lengthAtMost 0 &quot;&quot;
True
&gt;&gt;&gt; lengthAtMost 3 &quot;ab&quot;
True
&gt;&gt;&gt; lengthAtMost 3 &quot;abc&quot;
True
&gt;&gt;&gt; lengthAtMost 3 &quot;abcd&quot;
False
&gt;&gt;&gt; lengthAtMost 3 $ repeat 'a'
False
&gt;&gt;&gt; lengthAtMost 3 $ &quot;abcd&quot; ++ undefined
False

prop&gt; \n xs -&gt; lengthAtMost n (xs::String)  ==  (length xs &lt;= n)
-}</span><span>
</span><span id="line-1023"></span><span id="local-6989586621679044120"><span class="annot"><a href="Data.List.HT.Private.html#lengthAtMost"><span class="hs-identifier hs-type">lengthAtMost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044120"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1024"></span><span id="lengthAtMost"><span class="annot"><span class="annottext">lengthAtMost :: forall a. Int -&gt; [a] -&gt; Bool
</span><a href="Data.List.HT.Private.html#lengthAtMost"><span class="hs-identifier hs-var hs-var">lengthAtMost</span></a></span></span><span> </span><span id="local-6989586621679044115"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044115"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1025"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044115"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1026"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1027"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044115"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="hs-comment">{- |
prop&gt; \n xs -&gt; lengthAtMost0 n (xs::String)  ==  (length xs &lt;= n)
-}</span><span>
</span><span id="line-1032"></span><span id="local-6989586621679044113"><span class="annot"><a href="Data.List.HT.Private.html#lengthAtMost0"><span class="hs-identifier hs-type">lengthAtMost0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044113"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1033"></span><span id="lengthAtMost0"><span class="annot"><span class="annottext">lengthAtMost0 :: forall a. Int -&gt; [a] -&gt; Bool
</span><a href="Data.List.HT.Private.html#lengthAtMost0"><span class="hs-identifier hs-var hs-var">lengthAtMost0</span></a></span></span><span> </span><span id="local-6989586621679044107"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044107"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044107"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044107"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="hs-comment">{-
Iterate until elements start to cycle.
This implementation is inspired by Elements of Programming
but I am still not satisfied
where the iteration actually stops.
-}</span><span>
</span><span id="line-1041"></span><span id="local-6989586621679044782"><span class="annot"><a href="Data.List.HT.Private.html#iterateUntilCycle"><span class="hs-identifier hs-type">iterateUntilCycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1042"></span><span id="iterateUntilCycle"><span class="annot"><span class="annottext">iterateUntilCycle :: forall a. Eq a =&gt; (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="Data.List.HT.Private.html#iterateUntilCycle"><span class="hs-identifier hs-var hs-var">iterateUntilCycle</span></a></span></span><span> </span><span id="local-6989586621679044101"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679044101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044100"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1043"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044099"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679044099"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679044101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044100"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1044"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044100"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1045"></span><span>       </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1046"></span><span>       </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044099"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044097"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044097"><span class="hs-identifier hs-var">ai</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044097"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044097"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044099"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="hs-comment">{-
iterateUntilCycleQ :: (Eq a) =&gt; (a -&gt; a) -&gt; a -&gt; [a]
iterateUntilCycleQ f a =
   let as = tail $ iterate f a
   in  (a:) $ map fst $
       takeWhile (uncurry (/=)) $
       zip as (downsample2 (tail as))
-}</span><span>
</span><span id="line-1056"></span><span>
</span><span id="line-1057"></span><span id="local-6989586621679044096"><span class="annot"><a href="Data.List.HT.Private.html#iterateUntilCycleP"><span class="hs-identifier hs-type">iterateUntilCycleP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1058"></span><span id="iterateUntilCycleP"><span class="annot"><span class="annottext">iterateUntilCycleP :: forall a. Eq a =&gt; (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="Data.List.HT.Private.html#iterateUntilCycleP"><span class="hs-identifier hs-var hs-var">iterateUntilCycleP</span></a></span></span><span> </span><span id="local-6989586621679044091"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679044091"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044090"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1059"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044089"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679044089"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679044091"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044090"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1060"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1061"></span><span>       </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679044088"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044088"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679044087"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044087"><span class="hs-identifier hs-var">a20</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044086"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044086"><span class="hs-identifier hs-var">a21</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044088"><span class="hs-identifier hs-var">a1</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044087"><span class="hs-identifier hs-var">a20</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044088"><span class="hs-identifier hs-var">a1</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044086"><span class="hs-identifier hs-var">a21</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1062"></span><span>       </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044089"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. [t] -&gt; [(t, t)]
</span><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044089"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>
</span><span id="line-1064"></span><span id="local-6989586621679044776"><span class="annot"><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-type">pairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044776"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044776"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044776"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1065"></span><span id="pairs"><span class="annot"><span class="annottext">pairs :: forall t. [t] -&gt; [(t, t)]
</span><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1066"></span><span class="annot"><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pairs: odd number of elements&quot;</span></span><span>
</span><span id="line-1067"></span><span class="annot"><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044081"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044081"><span class="hs-identifier hs-var">x0</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044080"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044080"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679044079"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679044079"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044081"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044080"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall t. [t] -&gt; [(t, t)]
</span><a href="Data.List.HT.Private.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679044079"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>
</span><span id="line-1070"></span><span class="hs-comment">{- | rotate left -}</span><span>
</span><span id="line-1071"></span><span id="local-6989586621679044078"><span class="annot"><a href="Data.List.HT.Private.html#rotate"><span class="hs-identifier hs-type">rotate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#rotate%27"><span class="hs-identifier hs-type">rotate'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#rotate%27%27"><span class="hs-identifier hs-type">rotate''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1072"></span><span id="rotate"><span class="annot"><span class="annottext">rotate :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#rotate"><span class="hs-identifier hs-var hs-var">rotate</span></a></span></span><span> </span><span id="local-6989586621679044071"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044071"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044070"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044070"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1073"></span><span>   </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#take"><span class="hs-identifier hs-var">Match.take</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044070"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044071"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044070"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044070"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span>
</span><span id="line-1075"></span><span class="hs-comment">{- | more efficient implementation of rotate'

prop&gt; \(NonNegative n) (NonEmpty xs) -&gt; rotate n xs == rotate' n (xs::String)
-}</span><span>
</span><span id="line-1079"></span><span id="rotate%27"><span class="annot"><span class="annottext">rotate' :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#rotate%27"><span class="hs-identifier hs-var hs-var">rotate'</span></a></span></span><span> </span><span id="local-6989586621679044065"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044065"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044064"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044064"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1080"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044065"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044064"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044064"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1082"></span><span>
</span><span id="line-1083"></span><span class="hs-comment">{- |
prop&gt; \(NonNegative n) xs -&gt; rotate n xs == rotate'' n (xs::String)
-}</span><span>
</span><span id="line-1086"></span><span id="rotate%27%27"><span class="annot"><span class="annottext">rotate'' :: forall a. Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#rotate%27%27"><span class="hs-identifier hs-var hs-var">rotate''</span></a></span></span><span> </span><span id="local-6989586621679044063"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044063"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044062"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1087"></span><span>   </span><span class="annot"><span class="annottext">forall b a. [b] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Match.Private.html#take"><span class="hs-identifier hs-var">Match.take</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044063"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044062"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span class="hs-comment">{- |
Given two lists that are ordered
(i.e. @p x y@ holds for subsequent @x@ and @y@)
'mergeBy' them into a list that is ordered, again.

&gt;&gt;&gt; mergeBy (&lt;=) &quot;agh&quot; &quot;begz&quot;
&quot;abegghz&quot;
-}</span><span>
</span><span id="line-1097"></span><span id="local-6989586621679044770"><span class="annot"><a href="Data.List.HT.Private.html#mergeBy"><span class="hs-identifier hs-type">mergeBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044770"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044770"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044770"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044770"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044770"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1098"></span><span id="mergeBy"><span class="annot"><span class="annottext">mergeBy :: forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#mergeBy"><span class="hs-identifier hs-var hs-var">mergeBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.List.Key.Private.html#mergeBy"><span class="hs-identifier hs-var">Key.mergeBy</span></a></span><span>
</span><span id="line-1099"></span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="hs-comment">{- |
&gt;&gt;&gt; allEqual &quot;aab&quot;
False
&gt;&gt;&gt; allEqual &quot;aaa&quot;
True
&gt;&gt;&gt; allEqual &quot;aa&quot;
True
&gt;&gt;&gt; allEqual &quot;a&quot;
True
&gt;&gt;&gt; allEqual &quot;&quot;
True
-}</span><span>
</span><span id="line-1113"></span><span id="local-6989586621679044769"><span class="annot"><a href="Data.List.HT.Private.html#allEqual"><span class="hs-identifier hs-type">allEqual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679044769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1114"></span><span id="allEqual"><span class="annot"><span class="annottext">allEqual :: forall a. Eq a =&gt; [a] -&gt; Bool
</span><a href="Data.List.HT.Private.html#allEqual"><span class="hs-identifier hs-var hs-var">allEqual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Data.List.HT.Private.html#mapAdjacent"><span class="hs-identifier hs-var">mapAdjacent</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-comment">{- |
&gt;&gt;&gt; isAscending &quot;abc&quot;
True
&gt;&gt;&gt; isAscending &quot;abb&quot;
True
&gt;&gt;&gt; isAscending &quot;aba&quot;
False
&gt;&gt;&gt; isAscending &quot;cba&quot;
False
&gt;&gt;&gt; isAscending &quot;a&quot;
True
&gt;&gt;&gt; isAscending &quot;&quot;
True
-}</span><span>
</span><span id="line-1130"></span><span id="local-6989586621679044764"><span class="annot"><a href="Data.List.HT.Private.html#isAscending"><span class="hs-identifier hs-type">isAscending</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679044764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1131"></span><span id="isAscending"><span class="annot"><span class="annottext">isAscending :: forall a. Ord a =&gt; [a] -&gt; Bool
</span><a href="Data.List.HT.Private.html#isAscending"><span class="hs-identifier hs-var hs-var">isAscending</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; [Bool]
</span><a href="Data.List.HT.Private.html#isAscendingLazy"><span class="hs-identifier hs-var">isAscendingLazy</span></a></span><span>
</span><span id="line-1132"></span><span>
</span><span id="line-1133"></span><span id="local-6989586621679044762"><span class="annot"><a href="Data.List.HT.Private.html#isAscendingLazy"><span class="hs-identifier hs-type">isAscendingLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679044762"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044762"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-1134"></span><span id="isAscendingLazy"><span class="annot"><span class="annottext">isAscendingLazy :: forall a. Ord a =&gt; [a] -&gt; [Bool]
</span><a href="Data.List.HT.Private.html#isAscendingLazy"><span class="hs-identifier hs-var hs-var">isAscendingLazy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Data.List.HT.Private.html#mapAdjacent"><span class="hs-identifier hs-var">mapAdjacent</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span>
</span><span id="line-1135"></span><span>
</span><span id="line-1136"></span><span class="hs-comment">{- |
This function combines every pair of neighbour elements
in a list with a certain function.

&gt;&gt;&gt; mapAdjacent (&lt;=) &quot;&quot;
[]
&gt;&gt;&gt; mapAdjacent (&lt;=) &quot;a&quot;
[]
&gt;&gt;&gt; mapAdjacent (&lt;=) &quot;aba&quot;
[True,False]
&gt;&gt;&gt; mapAdjacent (,) &quot;abc&quot;
[('a','b'),('b','c')]

prop&gt; \x xs -&gt; mapAdjacent subtract (scanl (+) x xs) == (xs::[Integer])
-}</span><span>
</span><span id="line-1151"></span><span id="local-6989586621679044765"><span id="local-6989586621679044766"><span class="annot"><a href="Data.List.HT.Private.html#mapAdjacent"><span class="hs-identifier hs-type">mapAdjacent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044766"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044766"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044765"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044766"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044765"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1152"></span><span id="mapAdjacent"><span class="annot"><span class="annottext">mapAdjacent :: forall a b. (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Data.List.HT.Private.html#mapAdjacent"><span class="hs-identifier hs-var hs-var">mapAdjacent</span></a></span></span><span> </span><span id="local-6989586621679044046"><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679044046"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044045"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044045"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679044046"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044045"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044045"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span class="hs-comment">{- |
&lt;http://mail.haskell.org/libraries/2016-April/026912.html&gt;

prop&gt; \xs -&gt; mapAdjacent (,) xs == mapAdjacentPointfree (,) (xs::String)
-}</span><span>
</span><span id="line-1159"></span><span id="local-6989586621679044042"><span id="local-6989586621679044043"><span class="annot"><a href="Data.List.HT.Private.html#mapAdjacentPointfree"><span class="hs-identifier hs-type">mapAdjacentPointfree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044042"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044043"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044042"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1160"></span><span id="mapAdjacentPointfree"><span class="annot"><span class="annottext">mapAdjacentPointfree :: forall a b. (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="Data.List.HT.Private.html#mapAdjacentPointfree"><span class="hs-identifier hs-var hs-var">mapAdjacentPointfree</span></a></span></span><span> </span><span id="local-6989586621679044038"><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679044038"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b
</span><a href="#local-6989586621679044038"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span>
</span><span id="line-1163"></span><span class="hs-comment">{- |
&gt;&gt;&gt; let f x y z = [x,y]++show(z::Int) in mapAdjacent1 f 'a' [('b',1), ('c',2), ('d',3)]
[&quot;ab1&quot;,&quot;bc2&quot;,&quot;cd3&quot;]
-}</span><span>
</span><span id="line-1167"></span><span id="local-6989586621679044747"><span id="local-6989586621679044748"><span id="local-6989586621679044749"><span class="annot"><a href="Data.List.HT.Private.html#mapAdjacent1"><span class="hs-identifier hs-type">mapAdjacent1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044748"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044747"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044749"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044748"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044747"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-1168"></span><span id="mapAdjacent1"><span class="annot"><span class="annottext">mapAdjacent1 :: forall a b c. (a -&gt; a -&gt; b -&gt; c) -&gt; a -&gt; [(a, b)] -&gt; [c]
</span><a href="Data.List.HT.Private.html#mapAdjacent1"><span class="hs-identifier hs-var hs-var">mapAdjacent1</span></a></span></span><span> </span><span id="local-6989586621679044036"><span class="annot"><span class="annottext">a -&gt; a -&gt; b -&gt; c
</span><a href="#local-6989586621679044036"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044035"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044035"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044034"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679044034"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1169"></span><span>   </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044033"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044032"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044031"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044031"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; b -&gt; c
</span><a href="#local-6989586621679044036"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044033"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044032"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044031"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044035"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679044034"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679044034"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="hs-comment">{- |
Enumerate without Enum context.
For Enum equivalent to enumFrom.

&gt;&gt;&gt; range 0 :: [Integer]
[]
&gt;&gt;&gt; range 1 :: [Integer]
[0]
&gt;&gt;&gt; range 8 :: [Integer]
[0,1,2,3,4,5,6,7]

prop&gt; \(NonNegative n) -&gt; length (range n :: [Integer]) == n
-}</span><span>
</span><span id="line-1185"></span><span id="local-6989586621679044743"><span class="annot"><a href="Data.List.HT.Private.html#range"><span class="hs-identifier hs-type">range</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679044743"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044743"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1186"></span><span id="range"><span class="annot"><span class="annottext">range :: forall a. Num a =&gt; Int -&gt; [a]
</span><a href="Data.List.HT.Private.html#range"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679044025"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044025"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044025"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1187"></span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#padLeft"><span class="hs-pragma hs-type">padLeft</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1190"></span><span id="local-6989586621679044741"><span class="annot"><a href="Data.List.HT.Private.html#padLeft"><span class="hs-identifier hs-type">padLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044741"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044741"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044741"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1191"></span><span id="padLeft"><span class="annot"><span class="annottext">padLeft :: forall a. a -&gt; Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#padLeft"><span class="hs-identifier hs-var hs-var">padLeft</span></a></span></span><span>  </span><span id="local-6989586621679044021"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044021"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044020"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044020"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044019"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044019"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044020"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044019"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044021"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044019"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span>
</span><span id="line-1194"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#padRight"><span class="hs-pragma hs-type">padRight</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1195"></span><span id="local-6989586621679044017"><span class="annot"><a href="Data.List.HT.Private.html#padRight"><span class="hs-identifier hs-type">padRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.HT.Private.html#padRight1"><span class="hs-identifier hs-type">padRight1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1196"></span><span id="padRight"><span class="annot"><span class="annottext">padRight :: forall a. a -&gt; Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#padRight"><span class="hs-identifier hs-var hs-var">padRight</span></a></span></span><span>  </span><span id="local-6989586621679044015"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044015"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044014"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044013"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044013"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044014"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044013"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044015"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1197"></span><span id="padRight1"><span class="annot"><span class="annottext">padRight1 :: forall a. a -&gt; Int -&gt; [a] -&gt; [a]
</span><a href="Data.List.HT.Private.html#padRight1"><span class="hs-identifier hs-var hs-var">padRight1</span></a></span></span><span> </span><span id="local-6989586621679044009"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044009"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044008"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044008"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679044007"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044007"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044007"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679044008"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679044007"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044009"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1198"></span><span>
</span><span id="line-1199"></span><span class="hs-comment">{- |
For an associative operation @op@ this computes
   @iterateAssociative op a = iterate (op a) a@
but it is even faster than @map (powerAssociative op a a) [0..]@
since it shares temporary results.

The idea is:
From the list @map (powerAssociative op a a) [0,(2*n)..]@
we compute the list @map (powerAssociative op a a) [0,n..]@,
and iterate that until @n==1@.

prop&gt; \x -&gt; equating (take 1000) (List.iterate (x+) x) (iterateAssociative (+) (x::Integer))
-}</span><span>
</span><span id="line-1212"></span><span id="local-6989586621679044736"><span class="annot"><a href="Data.List.HT.Private.html#iterateAssociative"><span class="hs-identifier hs-type">iterateAssociative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1213"></span><span id="iterateAssociative"><span class="annot"><span class="annottext">iterateAssociative :: forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a]
</span><a href="Data.List.HT.Private.html#iterateAssociative"><span class="hs-identifier hs-var hs-var">iterateAssociative</span></a></span></span><span> </span><span id="local-6989586621679044001"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679044001"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679044000"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044000"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1214"></span><span>   </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679043999"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043999"><span class="hs-identifier hs-var">pow</span></a></span></span><span> </span><span id="local-6989586621679043998"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043998"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043999"><span class="hs-identifier hs-var">pow</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679043997"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043997"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043997"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679044001"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043997"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043999"><span class="hs-identifier hs-var">pow</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043998"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>         </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679043996"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043996"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679044001"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043996"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043996"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044000"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="hs-comment">{- |
This is equal to 'iterateAssociative'.
The idea is the following:
The list we search is the fixpoint of the function:
&quot;Square all elements of the list,
then spread it and fill the holes with successive numbers
of their left neighbour.&quot;
This also preserves log n applications per value.
However it has a space leak,
because for the value with index @n@
all elements starting at @div n 2@ must be kept.

prop&gt; \x -&gt; equating (take 1000) (List.iterate (x+) x) (iterateLeaky (+) (x::Integer))
-}</span><span>
</span><span id="line-1231"></span><span id="local-6989586621679043995"><span class="annot"><a href="Data.List.HT.Private.html#iterateLeaky"><span class="hs-identifier hs-type">iterateLeaky</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679043995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679043995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679043995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679043995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679043995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1232"></span><span id="iterateLeaky"><span class="annot"><span class="annottext">iterateLeaky :: forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a]
</span><a href="Data.List.HT.Private.html#iterateLeaky"><span class="hs-identifier hs-var hs-var">iterateLeaky</span></a></span></span><span> </span><span id="local-6989586621679043993"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679043993"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679043992"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043992"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1233"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679043989"><span class="annot"><span class="annottext">merge :: [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679043989"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679043988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043988"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679043987"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043987"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679043986"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043986"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043988"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679043989"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043986"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043987"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1234"></span><span>       </span><span class="annot"><a href="#local-6989586621679043989"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;iterateLeaky: an empty list cannot occur&quot;</span></span><span>
</span><span id="line-1235"></span><span>       </span><span id="local-6989586621679043985"><span class="annot"><span class="annottext">sqrs :: [a]
</span><a href="#local-6989586621679043985"><span class="hs-identifier hs-var hs-var">sqrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679043984"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043984"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679043993"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043984"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043984"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043983"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1236"></span><span>       </span><span id="local-6989586621679043983"><span class="annot"><span class="annottext">z :: [a]
</span><a href="#local-6989586621679043983"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043992"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679043989"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043985"><span class="hs-identifier hs-var">sqrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679043993"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679043992"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043985"><span class="hs-identifier hs-var">sqrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>   </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679043983"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1238"></span></pre></body></html>