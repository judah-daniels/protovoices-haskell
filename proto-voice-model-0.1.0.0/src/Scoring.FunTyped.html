<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{- | Semiring scores with &quot;holes&quot;.
 Holes are used to express &quot;partially applied&quot; scores that occur
 when the score of a verticalization (unspread) is distributed to the two parent edges.
 The full score of the operation is restored when the two parent edges are eventually combined again.

 This module implements partial scores as typesafe functions with phantom types
 that indicate the number of holes on each side.
 The grammatical combinators use an existential type 'Score'
 that reifies the phantom types as singletons,
 which allows different scores to be easily stored together
 and is compatible with the 'Score' types from the other Scoring* modules.
 Thus, the grammatical combinators are partial
 and fail when used with incompatible scores, indicating a parser bug.
-}</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Scoring.FunTyped</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * The Score Type</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier">Score</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier">TypedScore</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#val"><span class="hs-identifier">val</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#showScore"><span class="hs-identifier">showScore</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** IDs</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier">LeftId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier">RightId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier">leftSide</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier">rightSide</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Hole Types</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier">LeftHoles</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier">RightHoles</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier">RightHole</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#BothHoles"><span class="hs-identifier">BothHoles</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Semiring operations</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-comment">-- | Semiring operations can be lifted to partial scores,</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-comment">-- but since it is not guaranteed that their arguments can be combined,</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-comment">-- they are partial.</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier">times</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier">plus</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * grammatical combinators</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-comment">-- | The following combinators correspond to the unsplit and unspread operations</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">-- of the path-graph grammar.</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#unsplitScores"><span class="hs-identifier">unsplitScores</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#unspreadScoresLeft"><span class="hs-identifier">unspreadScoresLeft</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#unspreadScoresRight"><span class="hs-identifier">unspreadScoresRight</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#addScores"><span class="hs-identifier">addScores</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#getScoreVal"><span class="hs-identifier">getScoreVal</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rnf</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">deepseq</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semiring</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Nat</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Nat</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SNat</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Score type --</span><span>
</span><span id="line-73"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Newtype for the left ID of a partial score.</span><span>
</span><span id="line-76"></span><span id="local-6989586621679483515"><span id="local-6989586621679483516"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="LeftId"><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-var">LeftId</span></a></span></span><span> </span><span id="local-6989586621679483850"><span class="annot"><a href="#local-6989586621679483850"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LeftId"><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-var">LeftId</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679483850"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483507"><span id="local-6989586621679483511"><span class="annot"><span class="annottext">LeftId i -&gt; LeftId i -&gt; Bool
forall i. Eq i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LeftId i -&gt; LeftId i -&gt; Bool
$c/= :: forall i. Eq i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
== :: LeftId i -&gt; LeftId i -&gt; Bool
$c== :: forall i. Eq i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483473"><span id="local-6989586621679483477"><span id="local-6989586621679483481"><span id="local-6989586621679483485"><span id="local-6989586621679483489"><span id="local-6989586621679483493"><span id="local-6989586621679483497"><span class="annot"><span class="annottext">LeftId i -&gt; LeftId i -&gt; Bool
LeftId i -&gt; LeftId i -&gt; Ordering
LeftId i -&gt; LeftId i -&gt; LeftId i
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {i}. Ord i =&gt; Eq (LeftId i)
forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Ordering
forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; LeftId i
min :: LeftId i -&gt; LeftId i -&gt; LeftId i
$cmin :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; LeftId i
max :: LeftId i -&gt; LeftId i -&gt; LeftId i
$cmax :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; LeftId i
&gt;= :: LeftId i -&gt; LeftId i -&gt; Bool
$c&gt;= :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
&gt; :: LeftId i -&gt; LeftId i -&gt; Bool
$c&gt; :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
&lt;= :: LeftId i -&gt; LeftId i -&gt; Bool
$c&lt;= :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
&lt; :: LeftId i -&gt; LeftId i -&gt; Bool
$c&lt; :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Bool
compare :: LeftId i -&gt; LeftId i -&gt; Ordering
$ccompare :: forall i. Ord i =&gt; LeftId i -&gt; LeftId i -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall i x. Rep (LeftId i) x -&gt; LeftId i
forall i x. LeftId i -&gt; Rep (LeftId i) x
$cto :: forall i x. Rep (LeftId i) x -&gt; LeftId i
$cfrom :: forall i x. LeftId i -&gt; Rep (LeftId i) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483461"><span class="annot"><span class="annottext">LeftId i -&gt; ()
forall i. NFData i =&gt; LeftId i -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: LeftId i -&gt; ()
$crnf :: forall i. NFData i =&gt; LeftId i -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483447"><span id="local-6989586621679483451"><span class="annot"><span class="annottext">Int -&gt; LeftId i -&gt; Int
LeftId i -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall {i}. Hashable i =&gt; Eq (LeftId i)
forall i. Hashable i =&gt; Int -&gt; LeftId i -&gt; Int
forall i. Hashable i =&gt; LeftId i -&gt; Int
hash :: LeftId i -&gt; Int
$chash :: forall i. Hashable i =&gt; LeftId i -&gt; Int
hashWithSalt :: Int -&gt; LeftId i -&gt; Int
$chashWithSalt :: forall i. Hashable i =&gt; Int -&gt; LeftId i -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483437"><span id="local-6989586621679483440"><span id="local-6989586621679483838"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483838"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483838"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679483434"><span class="annot"><span class="annottext">show :: LeftId i -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span id="local-6989586621679483432"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679483432"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679483432"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Newtype for the right ID of a partial score.</span><span>
</span><span id="line-83"></span><span id="local-6989586621679483430"><span id="local-6989586621679483431"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="RightId"><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-var">RightId</span></a></span></span><span> </span><span id="local-6989586621679483835"><span class="annot"><a href="#local-6989586621679483835"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RightId"><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-var">RightId</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679483835"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483422"><span id="local-6989586621679483426"><span class="annot"><span class="annottext">RightId i -&gt; RightId i -&gt; Bool
forall i. Eq i =&gt; RightId i -&gt; RightId i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RightId i -&gt; RightId i -&gt; Bool
$c/= :: forall i. Eq i =&gt; RightId i -&gt; RightId i -&gt; Bool
== :: RightId i -&gt; RightId i -&gt; Bool
$c== :: forall i. Eq i =&gt; RightId i -&gt; RightId i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483389"><span id="local-6989586621679483393"><span id="local-6989586621679483397"><span id="local-6989586621679483401"><span id="local-6989586621679483405"><span id="local-6989586621679483409"><span id="local-6989586621679483413"><span class="annot"><span class="annottext">RightId i -&gt; RightId i -&gt; Bool
RightId i -&gt; RightId i -&gt; Ordering
RightId i -&gt; RightId i -&gt; RightId i
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {i}. Ord i =&gt; Eq (RightId i)
forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Bool
forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Ordering
forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; RightId i
min :: RightId i -&gt; RightId i -&gt; RightId i
$cmin :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; RightId i
max :: RightId i -&gt; RightId i -&gt; RightId i
$cmax :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; RightId i
&gt;= :: RightId i -&gt; RightId i -&gt; Bool
$c&gt;= :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Bool
&gt; :: RightId i -&gt; RightId i -&gt; Bool
$c&gt; :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Bool
&lt;= :: RightId i -&gt; RightId i -&gt; Bool
$c&lt;= :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Bool
&lt; :: RightId i -&gt; RightId i -&gt; Bool
$c&lt; :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Bool
compare :: RightId i -&gt; RightId i -&gt; Ordering
$ccompare :: forall i. Ord i =&gt; RightId i -&gt; RightId i -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall i x. Rep (RightId i) x -&gt; RightId i
forall i x. RightId i -&gt; Rep (RightId i) x
$cto :: forall i x. Rep (RightId i) x -&gt; RightId i
$cfrom :: forall i x. RightId i -&gt; Rep (RightId i) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483380"><span class="annot"><span class="annottext">RightId i -&gt; ()
forall i. NFData i =&gt; RightId i -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: RightId i -&gt; ()
$crnf :: forall i. NFData i =&gt; RightId i -&gt; ()
</span><a href="#local-6989586621679483380"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483367"><span id="local-6989586621679483371"><span class="annot"><span class="annottext">Int -&gt; RightId i -&gt; Int
RightId i -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall {i}. Hashable i =&gt; Eq (RightId i)
forall i. Hashable i =&gt; Int -&gt; RightId i -&gt; Int
forall i. Hashable i =&gt; RightId i -&gt; Int
hash :: RightId i -&gt; Int
$chash :: forall i. Hashable i =&gt; RightId i -&gt; Int
hashWithSalt :: Int -&gt; RightId i -&gt; Int
$chashWithSalt :: forall i. Hashable i =&gt; Int -&gt; RightId i -&gt; Int
</span><a href="#local-6989586621679483367"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483359"><span id="local-6989586621679483362"><span id="local-6989586621679483831"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483831"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483831"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679483357"><span class="annot"><span class="annottext">show :: RightId i -&gt; String
</span><a href="#local-6989586621679483357"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span id="local-6989586621679483356"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679483356"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679483356"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621679483830"><span class="annot"><a href="Scoring.FunTyped.html#match"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-90"></span><span id="match"><span class="annot"><span class="annottext">match :: forall a. Eq a =&gt; RightId a -&gt; LeftId a -&gt; Bool
</span><a href="Scoring.FunTyped.html#match"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span id="local-6989586621679483352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679483352"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span id="local-6989586621679483351"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679483351"><span class="hs-identifier hs-var">il</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679483351"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679483352"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | A single right hole (helper for 'RightHoles').</span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="RightHole"><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483350"><span class="annot"><a href="#local-6989586621679483350"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483349"><span class="annot"><a href="#local-6989586621679483349"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679483348"><span id="local-6989586621679483708"><span id="RightHole"><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483348"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483708"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483348"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483708"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679483711"><span id="RightEnd"><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-var">RightEnd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679483711"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483711"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483823"><span id="local-6989586621679483824"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679483824"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483823"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483824"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679483342"><span class="annot"><span class="annottext">rnf :: RightHole n s -&gt; ()
</span><a href="#local-6989586621679483342"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679483338"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483338"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483338"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679483335"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483335"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483335"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | The type of a function representing @n@ right holes.</span><span>
</span><span id="line-102"></span><span class="hs-keyword">type</span><span> </span><span id="RightHoles"><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-var">RightHoles</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483334"><span class="annot"><a href="#local-6989586621679483334"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483333"><span class="annot"><a href="#local-6989586621679483333"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679483333"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483334"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483333"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | The type of a function representing @n@ left holes.</span><span>
</span><span id="line-105"></span><span class="hs-keyword">type</span><span> </span><span id="LeftHoles"><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-var">LeftHoles</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483332"><span class="annot"><a href="#local-6989586621679483332"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483331"><span class="annot"><a href="#local-6989586621679483331"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483332"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483331"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483331"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | The type of a function containing @nl@ left and @nr@ right holes.</span><span>
</span><span id="line-108"></span><span class="hs-keyword">type</span><span> </span><span id="BothHoles"><span class="annot"><a href="Scoring.FunTyped.html#BothHoles"><span class="hs-identifier hs-var">BothHoles</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483330"><span class="annot"><a href="#local-6989586621679483330"><span class="hs-identifier hs-type">nl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483329"><span class="annot"><a href="#local-6989586621679483329"><span class="hs-identifier hs-type">nr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483328"><span class="annot"><a href="#local-6989586621679483328"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483329"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483328"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483330"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483328"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">{- | A partially applied score of type @s@.
 Comes in four variants,
 depending on whether the score is fully applied
 or needs to be combined on either or both sides.
 Values that need to be combined are lists that represent scores with holes.
 Each variant carries IDs of type @i@ that determine which objects fit on either of its sides.
 Only score objects with matching IDs can be combined.

 As a shorthand notation, we use @a-b@ to indicate a value
 that depends on @a@ on its left and on @b@ on its right.
 If the value does not depend on anything on either side, we use @()@,
 i.e. @()-a@ stands for @SLeft _ a@ and @()-()@ stands for @SVal _@.
-}</span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="TypedScore"><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-var">TypedScore</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483327"><span class="annot"><a href="#local-6989586621679483327"><span class="hs-identifier hs-type">nl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483326"><span class="annot"><a href="#local-6989586621679483326"><span class="hs-identifier hs-type">nr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483325"><span class="annot"><a href="#local-6989586621679483325"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679483324"><span class="annot"><a href="#local-6989586621679483324"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- | Carries a fully applied value</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679483785"><span id="local-6989586621679483786"><span id="SVal"><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679483786"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483786"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483785"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- | The right part of a combination, expects an argument to its left.</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">-- Implemented as a function that takes a left counterpart</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- and returns a score with fewer holes.</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679483322"><span id="local-6989586621679483683"><span id="local-6989586621679483684"><span id="SRight"><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483684"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483322"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483683"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483322"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483683"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483684"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">-- | The left part of a combination, expects an argument to its right.</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- Implemented as a function that takes a right hole and applies it.</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679483320"><span id="local-6989586621679483677"><span id="local-6989586621679483678"><span id="SLeft"><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483320"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483678"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483677"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483320"><span class="hs-identifier hs-type">nr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483678"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483677"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">-- | A combination of 'SLeft' and 'SRight' that expects arguments on both sides.</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">-- Implemented as a function that expects both a right and a left hole to be complete.</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679483317"><span id="local-6989586621679483318"><span id="local-6989586621679483670"><span id="local-6989586621679483671"><span id="SBoth"><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483671"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#BothHoles"><span class="hs-identifier hs-type">BothHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483318"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483317"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483670"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483671"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483318"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483317"><span class="hs-identifier hs-type">nr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483670"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483671"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483809"><span id="local-6989586621679483810"><span id="local-6989586621679483811"><span id="local-6989586621679483812"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679483812"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679483811"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483810"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483809"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483812"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483811"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679483311"><span class="annot"><span class="annottext">rnf :: TypedScore nl nr s i -&gt; ()
</span><a href="#local-6989586621679483311"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483307"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483307"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483307"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483303"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483303"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483303"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483299"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483299"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483299"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483294"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483294"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483293"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483293"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483294"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483293"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">{- | A paritally applied score of type @s@
 with an unknown number of holes (as used by the &quot;ChartParser&quot;).
 Wraps a 'TypedScore' together with witnesses for the number of holes on each side.
-}</span><span>
</span><span id="line-147"></span><span class="hs-keyword">data</span><span> </span><span id="Score"><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-var">Score</span></a></span></span><span> </span><span id="local-6989586621679483292"><span class="annot"><a href="#local-6989586621679483292"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679483291"><span class="annot"><a href="#local-6989586621679483291"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679483289"><span id="local-6989586621679483290"><span id="local-6989586621679483787"><span id="local-6989586621679483788"><span id="MkScore"><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679483290"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679483289"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483290"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483289"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483788"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483787"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483788"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483787"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483797"><span id="local-6989586621679483798"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679483798"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679483797"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483798"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483797"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679483283"><span class="annot"><span class="annottext">rnf :: Score s i -&gt; ()
</span><a href="#local-6989586621679483283"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483281"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483281"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483281"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Creates a simple value score of type ()-().</span><span>
</span><span id="line-154"></span><span id="local-6989586621679483792"><span id="local-6989586621679483793"><span class="annot"><a href="Scoring.FunTyped.html#val"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679483793"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483793"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483792"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-155"></span><span id="val"><span class="annot"><span class="annottext">val :: forall s i. s -&gt; Score s i
</span><a href="Scoring.FunTyped.html#val"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679483280"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483280"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat) s i.
SNat nl -&gt; SNat nr -&gt; TypedScore nl nr s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat 'Z
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span class="annot"><span class="annottext">SNat 'Z
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s i. s -&gt; TypedScore 'Z 'Z s i
</span><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483280"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">{- | Returns the ID on the left side of an 'Score',
 or 'Nothing' for 'SVal' and 'SLeft'.

 &gt; a-b -&gt; a
-}</span><span>
</span><span id="line-162"></span><span id="local-6989586621679483783"><span id="local-6989586621679483784"><span class="annot"><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier hs-type">leftSide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483784"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483783"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-type">LeftId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483783"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-163"></span><span id="leftSide"><span class="annot"><span class="annottext">leftSide :: forall s i. Score s i -&gt; Maybe (LeftId i)
</span><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier hs-var hs-var">leftSide</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier hs-var">leftSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier hs-var">leftSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483272"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483272"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483272"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Scoring.FunTyped.html#leftSide"><span class="hs-identifier hs-var">leftSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483269"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483269"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483269"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">{- | Returns the ID on the right side of an 'Score',
 or 'Nothing' for 'SVal' and 'SRight'.

 &gt; a-b -&gt; b
-}</span><span>
</span><span id="line-173"></span><span id="local-6989586621679483766"><span id="local-6989586621679483767"><span class="annot"><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier hs-type">rightSide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483767"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483766"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-type">RightId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483766"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-174"></span><span id="rightSide"><span class="annot"><span class="annottext">rightSide :: forall s i. Score s i -&gt; Maybe (RightId i)
</span><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier hs-var hs-var">rightSide</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier hs-var">rightSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483264"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483264"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483264"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier hs-var">rightSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Scoring.FunTyped.html#rightSide"><span class="hs-identifier hs-var">rightSide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483259"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483259"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483259"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483254"><span id="local-6989586621679483257"><span id="local-6989586621679483748"><span id="local-6989586621679483749"><span id="local-6989586621679483750"><span id="local-6989586621679483751"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483751"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483750"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483749"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483748"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483751"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679483253"><span class="annot"><span class="annottext">show :: TypedScore nl nr s i -&gt; String
</span><a href="#local-6989586621679483253"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()-()&quot;</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483245"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483245"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483245"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483240"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483240"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483240"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-()&quot;</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483233"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483233"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483232"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483232"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483233"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483232"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483227"><span id="local-6989586621679483230"><span id="local-6989586621679483740"><span id="local-6989586621679483741"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483741"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483740"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483741"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679483226"><span class="annot"><span class="annottext">show :: Score s i -&gt; String
</span><a href="#local-6989586621679483226"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483224"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483224"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483224"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679483734"><span id="local-6989586621679483735"><span id="local-6989586621679483736"><span id="local-6989586621679483737"><span class="annot"><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-type">showTScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483736"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483735"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483734"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483736"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span></span></span><span>
</span><span id="line-189"></span><span id="showTScore"><span class="annot"><span class="annottext">showTScore :: forall s i (nl :: Nat) (nr :: Nat).
(Show s, Show i) =&gt;
TypedScore nl nr s i -&gt; String
</span><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-var hs-var">showTScore</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483217"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483217"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483217"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-var">showTScore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483212"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483212"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483212"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-var">showTScore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483207"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483207"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483207"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-()&quot;</span></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-var">showTScore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483200"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483200"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483199"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483199"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483200"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483199"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">{- | Returns a string representation of a 'Score'
 (more compact than it's 'Show' instance).
-}</span><span>
</span><span id="line-197"></span><span id="local-6989586621679483724"><span id="local-6989586621679483725"><span class="annot"><a href="Scoring.FunTyped.html#showScore"><span class="hs-identifier hs-type">showScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483725"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483724"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483725"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483724"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-198"></span><span id="showScore"><span class="annot"><span class="annottext">showScore :: forall s i. (Show s, Show i) =&gt; Score s i -&gt; String
</span><a href="Scoring.FunTyped.html#showScore"><span class="hs-identifier hs-var hs-var">showScore</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483194"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483194"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s i (nl :: Nat) (nr :: Nat).
(Show s, Show i) =&gt;
TypedScore nl nr s i -&gt; String
</span><a href="Scoring.FunTyped.html#showTScore"><span class="hs-identifier hs-var">showTScore</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679483194"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- semiring operations --</span><span>
</span><span id="line-202"></span><span class="hs-comment">-------------------------</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621679483717"><span id="local-6989586621679483719"><span class="annot"><a href="Scoring.FunTyped.html#appendRight"><span class="hs-identifier hs-type">appendRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483719"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483719"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483717"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483719"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483717"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483719"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-205"></span><span id="appendRight"><span class="annot"><span class="annottext">appendRight :: forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#appendRight"><span class="hs-identifier hs-var hs-var">appendRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483191"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483191"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679483190"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483190"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483189"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483189"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RightHole n s -&gt; RightHole n s
</span><a href="#local-6989586621679483188"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483190"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483189"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-206"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679483188"><span class="annot"><span class="annottext">app :: RightHole n s -&gt; RightHole n s
</span><a href="#local-6989586621679483188"><span class="hs-identifier hs-var hs-var">app</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679483185"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483185"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. s -&gt; RightHole 'Z s
</span><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-var">RightEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483185"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483191"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="#local-6989586621679483188"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679483181"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483181"><span class="hs-identifier hs-var">fr'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s. RightHoles nl s -&gt; RightHole ('S nl) s
</span><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#appendRight"><span class="hs-identifier hs-var">appendRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483191"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483181"><span class="hs-identifier hs-var">fr'</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621679483706"><span id="local-6989586621679483707"><span class="annot"><a href="Scoring.FunTyped.html#prependLeft"><span class="hs-identifier hs-type">prependLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483706"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483706"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483707"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-211"></span><span id="prependLeft"><span class="annot"><span class="annottext">prependLeft :: forall s (n :: Nat).
Semiring s =&gt;
s -&gt; LeftHoles n s -&gt; LeftHoles n s
</span><a href="Scoring.FunTyped.html#prependLeft"><span class="hs-identifier hs-var hs-var">prependLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483177"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483177"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679483176"><span class="annot"><span class="annottext">LeftHoles n s
</span><a href="#local-6989586621679483176"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483177"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-operator">R.*</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles n s
</span><a href="#local-6989586621679483176"><span class="hs-identifier hs-var">fl</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span id="local-6989586621679483173"><span id="local-6989586621679483174"><span class="annot"><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-type">prependRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483174"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483174"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483173"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483174"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483173"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483174"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-214"></span><span id="prependRight"><span class="annot"><span class="annottext">prependRight :: forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-var hs-var">prependRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483170"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483170"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679483169"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483169"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483168"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483168"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RightHole n s -&gt; RightHole n s
</span><a href="#local-6989586621679483167"><span class="hs-identifier hs-var">prep</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483169"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483168"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-215"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679483167"><span class="annot"><span class="annottext">prep :: RightHole n s -&gt; RightHole n s
</span><a href="#local-6989586621679483167"><span class="hs-identifier hs-var hs-var">prep</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679483164"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483164"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. s -&gt; RightHole 'Z s
</span><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-var">RightEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483170"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483164"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="#local-6989586621679483167"><span class="hs-identifier hs-var">prep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679483161"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483161"><span class="hs-identifier hs-var">fr'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s. RightHoles nl s -&gt; RightHole ('S nl) s
</span><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-var">prependRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483170"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483161"><span class="hs-identifier hs-var">fr'</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">{- | Combines two partially applied 'Score's
 by applying them to each other and/or multiplying the underlying semiring values.
 Shapes and IDs at the adjacent sides must match, otherwise 'Nothing' is returned.

 &gt; a-b &#215; b-c -&gt; a-c
-}</span><span>
</span><span id="line-225"></span><span id="local-6989586621679483693"><span id="local-6989586621679483694"><span id="local-6989586621679483695"><span id="local-6989586621679483696"><span id="local-6989586621679483697"><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-type">times</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483697"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483696"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483696"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483695"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483694"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483697"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483696"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483694"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483693"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483697"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483696"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483695"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483693"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483697"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483696"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- creates value</span><span>
</span><span id="line-231"></span><span id="times"><span class="annot"><span class="annottext">times :: forall s i (nl :: Nat) (n :: Nat) (nr :: Nat).
(Semiring s, Eq i, Show i) =&gt;
TypedScore nl n s i
-&gt; TypedScore n nr s i -&gt; Maybe (TypedScore nl nr s i)
</span><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var hs-var">times</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483155"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483155"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483151"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483151"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall s i. s -&gt; TypedScore 'Z 'Z s i
</span><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483155"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483151"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-232"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483147"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483147"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679483146"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483146"><span class="hs-identifier hs-var">il</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483139"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483139"><span class="hs-identifier hs-var">ir</span></a></span></span><span> </span><span id="local-6989586621679483138"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483138"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483146"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; RightId a -&gt; LeftId a -&gt; Bool
</span><a href="Scoring.FunTyped.html#match"><span class="hs-operator hs-var">`match`</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483139"><span class="hs-identifier hs-var">ir</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall s i. s -&gt; TypedScore 'Z 'Z s i
</span><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483147"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483138"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- creates right</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483135"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483135"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679483134"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483134"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483130"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483130"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483135"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#appendRight"><span class="hs-identifier hs-var">appendRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483130"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483134"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483127"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483127"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679483126"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483126"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621679483125"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483125"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483118"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483118"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679483117"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483117"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483125"><span class="hs-identifier hs-var">ir</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; RightId a -&gt; LeftId a -&gt; Bool
</span><a href="Scoring.FunTyped.html#match"><span class="hs-operator hs-var">`match`</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483118"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483127"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483126"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483117"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- creates left</span><span>
</span><span id="line-237"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483114"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483114"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483110"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483110"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679483109"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483109"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; LeftHoles n s -&gt; LeftHoles n s
</span><a href="Scoring.FunTyped.html#prependLeft"><span class="hs-identifier hs-var">prependLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483114"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483110"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483109"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483106"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483106"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679483105"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483105"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483098"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483098"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679483097"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483097"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621679483096"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483096"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483105"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; RightId a -&gt; LeftId a -&gt; Bool
</span><a href="Scoring.FunTyped.html#match"><span class="hs-operator hs-var">`match`</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483098"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483106"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483097"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483096"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- creates both</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483093"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483093"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679483092"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483092"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483088"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483088"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679483087"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483087"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483093"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#appendRight"><span class="hs-operator hs-var">`appendRight`</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483092"><span class="hs-identifier hs-var">fr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483088"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483087"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483084"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483084"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679483083"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483083"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span id="local-6989586621679483082"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483082"><span class="hs-identifier hs-var">ia</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483075"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483075"><span class="hs-identifier hs-var">ib</span></a></span></span><span> </span><span id="local-6989586621679483074"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483074"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621679483073"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483073"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483082"><span class="hs-identifier hs-var">ia</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; RightId a -&gt; LeftId a -&gt; Bool
</span><a href="Scoring.FunTyped.html#match"><span class="hs-operator hs-var">`match`</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483075"><span class="hs-identifier hs-var">ib</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483084"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483083"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483074"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483073"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- otherwise</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl n s i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypedScore n nr s i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621679483664"><span id="local-6989586621679483665"><span class="annot"><a href="Scoring.FunTyped.html#rhplus"><span class="hs-identifier hs-type">rhplus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483665"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483664"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483665"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483664"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483665"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483664"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483665"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-249"></span><span id="rhplus"><span class="annot"><span class="annottext">rhplus :: forall s (n :: Nat).
Semiring s =&gt;
RightHoles n s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#rhplus"><span class="hs-identifier hs-var hs-var">rhplus</span></a></span></span><span> </span><span id="local-6989586621679483070"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483070"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679483069"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483069"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679483068"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483068"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483070"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483068"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483069"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483068"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679483066"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483066"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679483063"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483063"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. s -&gt; RightHole 'Z s
</span><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-var">RightEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483066"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.+</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483063"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679483060"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483060"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679483054"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483054"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s. RightHoles nl s -&gt; RightHole ('S nl) s
</span><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
RightHoles n s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#rhplus"><span class="hs-identifier hs-var">rhplus</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483060"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679483054"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">{- | Adds two partially applied 'TypedScore's
 by adding their underlying (or resulting) semiring values.
 This operation is only admitted
 if the two scores are of the same shape and have matching IDs.
 Otherwise, 'Nothing' is returned.

 &gt; a-b + a-b -&gt; a-b
-}</span><span>
</span><span id="line-261"></span><span id="local-6989586621679483656"><span id="local-6989586621679483657"><span id="local-6989586621679483658"><span id="local-6989586621679483659"><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-type">plus</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483659"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483658"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483657"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483656"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483659"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483658"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483657"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483656"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483659"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483658"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483657"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483656"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483659"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483658"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-266"></span><span id="plus"><span class="annot"><span class="annottext">plus :: forall s i (nl :: Nat) (nr :: Nat).
(Semiring s, Eq i) =&gt;
TypedScore nl nr s i
-&gt; TypedScore nl nr s i -&gt; Maybe (TypedScore nl nr s i)
</span><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var hs-var">plus</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483049"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483049"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679483045"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483045"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall s i. s -&gt; TypedScore 'Z 'Z s i
</span><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483049"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.+</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679483045"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483042"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483042"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679483041"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483041"><span class="hs-identifier hs-var">fr1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679483033"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483033"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span id="local-6989586621679483032"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483032"><span class="hs-identifier hs-var">fr2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483042"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483033"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483042"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
RightHoles n s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#rhplus"><span class="hs-identifier hs-var">rhplus</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483041"><span class="hs-identifier hs-var">fr1</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679483032"><span class="hs-identifier hs-var">fr2</span></a></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483029"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483029"><span class="hs-identifier hs-var">fl1</span></a></span></span><span> </span><span id="local-6989586621679483028"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483028"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679483020"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483020"><span class="hs-identifier hs-var">fl2</span></a></span></span><span> </span><span id="local-6989586621679483019"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483019"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483028"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483019"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679483018"><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679483018"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483029"><span class="hs-identifier hs-var">fl1</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679483018"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.+</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679483020"><span class="hs-identifier hs-var">fl2</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679483018"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483028"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483015"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483015"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679483014"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483014"><span class="hs-identifier hs-var">bs1</span></a></span></span><span> </span><span id="local-6989586621679483013"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483013"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679483001"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483001"><span class="hs-identifier hs-var">il'</span></a></span></span><span> </span><span id="local-6989586621679483000"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483000"><span class="hs-identifier hs-var">bs2</span></a></span></span><span> </span><span id="local-6989586621679482999"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482999"><span class="hs-identifier hs-var">ir'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483015"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483001"><span class="hs-identifier hs-var">il'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483013"><span class="hs-identifier hs-var">ir</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482999"><span class="hs-identifier hs-var">ir'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679483015"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482997"><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679482997"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
RightHoles n s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#rhplus"><span class="hs-identifier hs-var">rhplus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483014"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679482997"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679483000"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nr s
</span><a href="#local-6989586621679482997"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679483013"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- helpers for constructing holes</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- ------------------------------</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span id="local-6989586621679483642"><span id="local-6989586621679483643"><span class="annot"><a href="Scoring.FunTyped.html#addHoleLeft"><span class="hs-identifier hs-type">addHoleLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679483643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483642"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483643"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483642"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483643"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-282"></span><span id="addHoleLeft"><span class="annot"><span class="annottext">addHoleLeft :: forall s (n :: Nat). s -&gt; LeftHoles n s -&gt; LeftHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleLeft"><span class="hs-identifier hs-var hs-var">addHoleLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482995"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482995"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679482994"><span class="annot"><span class="annottext">LeftHoles n s
</span><a href="#local-6989586621679482994"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679482993"><span class="annot"><span class="annottext">RightHoles ('S n) s
</span><a href="#local-6989586621679482993"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RightHoles ('S n) s
</span><a href="#local-6989586621679482993"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482995"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-type">RightHole</span></a></span><span> </span><span id="local-6989586621679482989"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679482989"><span class="hs-identifier hs-var">fr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeftHoles n s
</span><a href="#local-6989586621679482994"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679482989"><span class="hs-identifier hs-var">fr'</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span id="local-6989586621679483638"><span class="annot"><a href="Scoring.FunTyped.html#mkLeftHole"><span class="hs-identifier hs-type">mkLeftHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679483638"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#LeftHoles"><span class="hs-identifier hs-type">LeftHoles</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483638"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-286"></span><span id="mkLeftHole"><span class="annot"><span class="annottext">mkLeftHole :: forall s. s -&gt; LeftHoles 'Z s
</span><a href="Scoring.FunTyped.html#mkLeftHole"><span class="hs-identifier hs-var hs-var">mkLeftHole</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482987"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482987"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679482986"><span class="annot"><span class="annottext">RightHoles 'Z s
</span><a href="#local-6989586621679482986"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RightHoles 'Z s
</span><a href="#local-6989586621679482986"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482987"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-type">RightEnd</span></a></span><span> </span><span id="local-6989586621679482984"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482984"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482984"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621679483635"><span id="local-6989586621679483636"><span class="annot"><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-type">addHoleRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483636"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483636"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483635"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483636"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483635"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483636"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-290"></span><span id="addHoleRight"><span class="annot"><span class="annottext">addHoleRight :: forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-var hs-var">addHoleRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482979"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482979"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482978"><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679482978"><span class="hs-identifier hs-var">rh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482977"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482977"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s. RightHoles nl s -&gt; RightHole ('S nl) s
</span><a href="Scoring.FunTyped.html#RightHole"><span class="hs-identifier hs-var">RightHole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-var">prependRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482977"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482979"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightHoles n s
</span><a href="#local-6989586621679482978"><span class="hs-identifier hs-var">rh</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span id="local-6989586621679483632"><span class="annot"><a href="Scoring.FunTyped.html#mkRightHole"><span class="hs-identifier hs-type">mkRightHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483632"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483632"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#RightHoles"><span class="hs-identifier hs-type">RightHoles</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483632"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-293"></span><span id="mkRightHole"><span class="annot"><span class="annottext">mkRightHole :: forall s. Semiring s =&gt; s -&gt; RightHoles 'Z s
</span><a href="Scoring.FunTyped.html#mkRightHole"><span class="hs-identifier hs-var hs-var">mkRightHole</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482973"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482973"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679482972"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482972"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. s -&gt; RightHole 'Z s
</span><a href="Scoring.FunTyped.html#RightEnd"><span class="hs-identifier hs-var">RightEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482972"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482973"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- proof helpers</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="CreateHole"><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-var">CreateHole</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482971"><span class="annot"><a href="#local-6989586621679482971"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>  </span><span id="CreateHole"><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-var">CreateHole</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span id="CreateHole"><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-var">CreateHole</span></a></span></span><span> </span><span id="local-6989586621679482970"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679482970"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679482970"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-keyword">class</span><span> </span><span id="AddHole"><span class="annot"><a href="Scoring.FunTyped.html#AddHole"><span class="hs-identifier hs-var">AddHole</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483629"><span class="annot"><a href="#local-6989586621679483629"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>  </span><span id="addHole"><span class="annot"><a href="Scoring.FunTyped.html#addHole"><span class="hs-identifier hs-type">addHole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679483629"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-type">CreateHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483629"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#AddHole"><span class="hs-identifier hs-type">AddHole</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679482965"><span class="annot"><span class="annottext">addHole :: SNat 'Z -&gt; SNat (CreateHole 'Z)
</span><a href="#local-6989586621679482965"><span class="hs-identifier hs-var hs-var hs-var hs-var">addHole</span></a></span></span><span> </span><span class="annot"><span class="annottext">SNat 'Z
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n1 :: Nat). SNatI n1 =&gt; SNat ('S n1)
</span><span class="hs-identifier hs-var">SS</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679483623"><span class="annot"><a href="Scoring.FunTyped.html#AddHole"><span class="hs-identifier hs-type">AddHole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="annot"><a href="#local-6989586621679483623"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679482956"><span class="annot"><span class="annottext">addHole :: SNat ('S n) -&gt; SNat (CreateHole ('S n))
</span><a href="#local-6989586621679482956"><span class="hs-identifier hs-var hs-var hs-var hs-var">addHole</span></a></span></span><span> </span><span class="annot"><span class="annottext">SNat ('S n)
</span><span class="hs-identifier hs-var">SS</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n1 :: Nat). SNatI n1 =&gt; SNat ('S n1)
</span><span class="hs-identifier hs-var">SS</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span id="local-6989586621679483620"><span id="local-6989586621679483621"><span class="annot"><a href="Scoring.FunTyped.html#canAddHole"><span class="hs-identifier hs-type">canAddHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679483621"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#AddHole"><span class="hs-identifier hs-type">AddHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483621"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483620"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483620"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-311"></span><span id="canAddHole"><span class="annot"><span class="annottext">canAddHole :: forall (n :: Nat) r. SNat n -&gt; (AddHole n =&gt; r) -&gt; r
</span><a href="Scoring.FunTyped.html#canAddHole"><span class="hs-identifier hs-var hs-var">canAddHole</span></a></span></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span id="local-6989586621679482945"><span class="annot"><span class="annottext">AddHole n =&gt; r
</span><a href="#local-6989586621679482945"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddHole n =&gt; r
</span><a href="#local-6989586621679482945"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Scoring.FunTyped.html#canAddHole"><span class="hs-identifier hs-var">canAddHole</span></a></span><span> </span><span class="annot"><span class="annottext">SNat n
</span><span class="hs-identifier hs-var">SS</span></span><span> </span><span id="local-6989586621679482940"><span class="annot"><span class="annottext">AddHole n =&gt; r
</span><a href="#local-6989586621679482940"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddHole n =&gt; r
</span><a href="#local-6989586621679482940"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- rules --</span><span>
</span><span id="line-316"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">{- | Extracts the value from a fully applied 'Score'.
 This function is intended to be used to extract the final score of the parser.
 If the score is not fully applied,
 throws an exception to indicate parser bugs.
-}</span><span>
</span><span id="line-323"></span><span id="local-6989586621679483615"><span id="local-6989586621679483616"><span class="annot"><a href="Scoring.FunTyped.html#getScoreVal"><span class="hs-identifier hs-type">getScoreVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483616"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483615"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483616"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-324"></span><span id="getScoreVal"><span class="annot"><span class="annottext">getScoreVal :: forall s i. Score s i -&gt; s
</span><a href="Scoring.FunTyped.html#getScoreVal"><span class="hs-identifier hs-var hs-var">getScoreVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679482935"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482935"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482935"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Scoring.FunTyped.html#getScoreVal"><span class="hs-identifier hs-var">getScoreVal</span></a></span><span> </span><span class="annot"><span class="annottext">Score s i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot get value from partial score&quot;</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">{- | Adds two 'Score's that are alternative derivations of the same transition.
 This is expected to be called on compatible scores
 and will throw an error otherwise to indicate parser bugs.

 &gt; a-b   a-b
 &gt; --------- add
 &gt;    a-b
-}</span><span>
</span><span id="line-335"></span><span id="local-6989586621679483606"><span id="local-6989586621679483607"><span class="annot"><a href="Scoring.FunTyped.html#addScores"><span class="hs-identifier hs-type">addScores</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483607"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483606"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483607"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483606"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483607"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483606"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483607"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483606"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-336"></span><span id="addScores"><span class="annot"><span class="annottext">addScores :: forall s i.
(Semiring s, Eq i) =&gt;
Score s i -&gt; Score s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#addScores"><span class="hs-identifier hs-var hs-var">addScores</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482931"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482931"><span class="hs-identifier hs-var">nla</span></a></span></span><span> </span><span id="local-6989586621679482930"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482930"><span class="hs-identifier hs-var">nra</span></a></span></span><span> </span><span id="local-6989586621679482929"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482929"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482922"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482922"><span class="hs-identifier hs-var">nlb</span></a></span></span><span> </span><span id="local-6989586621679482921"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482921"><span class="hs-identifier hs-var">nrb</span></a></span></span><span> </span><span id="local-6989586621679482920"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482920"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat) s i.
SNat nl -&gt; SNat nr -&gt; TypedScore nl nr s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482931"><span class="hs-identifier hs-var">nla</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482930"><span class="hs-identifier hs-var">nra</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482919"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-337"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679482919"><span class="annot"><span class="annottext">res :: TypedScore nl nr s i
</span><a href="#local-6989586621679482919"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;illegal plus&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">nl :~: nl
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">testEquality</span></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482931"><span class="hs-identifier hs-var">nla</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482922"><span class="hs-identifier hs-var">nlb</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">nr :~: nr
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">testEquality</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482930"><span class="hs-identifier hs-var">nra</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482921"><span class="hs-identifier hs-var">nrb</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">forall s i (nl :: Nat) (nr :: Nat).
(Semiring s, Eq i) =&gt;
TypedScore nl nr s i
-&gt; TypedScore nl nr s i -&gt; Maybe (TypedScore nl nr s i)
</span><a href="Scoring.FunTyped.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482929"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482920"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">{- | Combines the 'Score's of two edges with a @split@ operation into the score of the parent edge.
 This is expected to be called on compatible scores
 and will throw an error otherwise to indicate parser bugs.

 &gt; a-b   b-c
 &gt; --------- unsplit
 &gt;    a-c
-}</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Scoring.FunTyped.html#unsplitScores"><span class="hs-identifier hs-type">unsplitScores</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679483592"><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679483591"><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-353"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-comment">-- ^ The score of the split operation.</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the left child edge.</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the right child edge.</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the parent edge, if it exists.</span><span>
</span><span id="line-362"></span><span id="unsplitScores"><span class="annot"><span class="annottext">unsplitScores :: forall s i.
(Semiring s, Eq i, Show i, Show s) =&gt;
s -&gt; Score s i -&gt; Score s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#unsplitScores"><span class="hs-identifier hs-var hs-var">unsplitScores</span></a></span></span><span> </span><span id="local-6989586621679482906"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482905"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482905"><span class="hs-identifier hs-var">nll</span></a></span></span><span> </span><span id="local-6989586621679482904"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482904"><span class="hs-identifier hs-var">nrl</span></a></span></span><span> </span><span id="local-6989586621679482903"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482903"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482893"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482893"><span class="hs-identifier hs-var">nlr</span></a></span></span><span> </span><span id="local-6989586621679482892"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482892"><span class="hs-identifier hs-var">nrr</span></a></span></span><span> </span><span id="local-6989586621679482891"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482891"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat) s i.
SNat nl -&gt; SNat nr -&gt; TypedScore nl nr s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482905"><span class="hs-identifier hs-var">nll</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482892"><span class="hs-identifier hs-var">nrr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482890"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="annottext">nr :~: nl
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">testEquality</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482904"><span class="hs-identifier hs-var">nrl</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482893"><span class="hs-identifier hs-var">nlr</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">forall s i (nl :: Nat) (n :: Nat) (nr :: Nat).
(Semiring s, Eq i, Show i) =&gt;
TypedScore nl n s i
-&gt; TypedScore n nr s i -&gt; Maybe (TypedScore nl nr s i)
</span><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat).
TypedScore nl nr s i -&gt; TypedScore nl nr s i
</span><a href="#local-6989586621679482885"><span class="hs-identifier hs-var">prep</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482903"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482891"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-366"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621679482890"><span class="annot"><span class="annottext">err :: TypedScore nl nr s i
</span><a href="#local-6989586621679482890"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Attempting illegal unsplit: left=&quot;</span></span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482903"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, right=&quot;</span></span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482891"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679483583"><span id="local-6989586621679483584"><span class="annot"><a href="#local-6989586621679482885"><span class="hs-identifier hs-type">prep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483584"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483583"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483584"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483583"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483592"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483591"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679482885"><span class="annot"><span class="annottext">prep :: forall (nl :: Nat) (nr :: Nat).
TypedScore nl nr s i -&gt; TypedScore nl nr s i
</span><a href="#local-6989586621679482885"><span class="hs-identifier hs-var hs-var">prep</span></a></span></span><span> </span><span id="local-6989586621679482884"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482884"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482884"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679482880"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482880"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s i. s -&gt; TypedScore 'Z 'Z s i
</span><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-var">SVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482880"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679482876"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482876"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679482875"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482875"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; LeftHoles n s -&gt; LeftHoles n s
</span><a href="Scoring.FunTyped.html#prependLeft"><span class="hs-identifier hs-var">prependLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482876"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482875"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span id="local-6989586621679482871"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679482870"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679482870"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-var">prependRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679482870"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span id="local-6989586621679482866"><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482866"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679482865"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679482865"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679482864"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482864"><span class="hs-identifier hs-var">ir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482866"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#prependRight"><span class="hs-identifier hs-var">prependRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679482865"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482864"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">{- | Creates the 'Score' of a left parent edge from a left child edge of an @unspread@.
 Will throw an error if called on invalid input to indicate parser bugs.
-}</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Scoring.FunTyped.html#unspreadScoresLeft"><span class="hs-identifier hs-type">unspreadScoresLeft</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679483575"><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679483576"><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-385"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-comment">-- ^ The new ID that marks both parent edges</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the left child edge.</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the left parent edge, if it exists.</span><span>
</span><span id="line-392"></span><span id="unspreadScoresLeft"><span class="annot"><span class="annottext">unspreadScoresLeft :: forall s i.
(Eq i, Show i, Semiring s, Show s) =&gt;
i -&gt; Score s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#unspreadScoresLeft"><span class="hs-identifier hs-var hs-var">unspreadScoresLeft</span></a></span></span><span> </span><span id="local-6989586621679482859"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679482859"><span class="hs-identifier hs-var">newid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span id="local-6989586621679482857"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482857"><span class="hs-identifier hs-var">nr</span></a></span></span><span> </span><span id="local-6989586621679482856"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482856"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="annottext">forall (n :: Nat) r. SNat n -&gt; (AddHole n =&gt; r) -&gt; r
</span><a href="Scoring.FunTyped.html#canAddHole"><span class="hs-identifier hs-var">canAddHole</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482857"><span class="hs-identifier hs-var">nr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat) s i.
SNat nl -&gt; SNat nr -&gt; TypedScore nl nr s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat 'Z
</span><span class="hs-identifier hs-var">SZ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Nat). AddHole n =&gt; SNat n -&gt; SNat (CreateHole n)
</span><a href="Scoring.FunTyped.html#addHole"><span class="hs-identifier hs-var">addHole</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482857"><span class="hs-identifier hs-var">nr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (nr :: Nat).
TypedScore 'Z nr s i -&gt; TypedScore 'Z (CreateHole nr) s i
</span><a href="#local-6989586621679482853"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482856"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-394"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679482852"><span class="annot"><span class="annottext">newir :: RightId i
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var hs-var">newir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. i -&gt; RightId i
</span><a href="Scoring.FunTyped.html#RightId"><span class="hs-identifier hs-var">RightId</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679482859"><span class="hs-identifier hs-var">newid</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-comment">-- wrap the left input score into a new layer with a new ID</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679483570"><span class="annot"><a href="#local-6989586621679482853"><span class="hs-identifier hs-type">wrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="annot"><a href="#local-6989586621679483570"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-type">CreateHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483570"><span class="hs-identifier hs-type">nr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483575"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483576"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679482853"><span class="annot"><span class="annottext">wrap :: forall (nr :: Nat).
TypedScore 'Z nr s i -&gt; TypedScore 'Z (CreateHole nr) s i
</span><a href="#local-6989586621679482853"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679482848"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482848"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat). s -&gt; LeftHoles n s -&gt; LeftHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleLeft"><span class="hs-identifier hs-var">addHoleLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.one</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. s -&gt; LeftHoles 'Z s
</span><a href="Scoring.FunTyped.html#mkLeftHole"><span class="hs-identifier hs-var">mkLeftHole</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482848"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var">newir</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><a href="#local-6989586621679482853"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679482843"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482843"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="annot"><span class="annottext">RightId i
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) s i.
LeftHoles nl s -&gt; RightId i -&gt; TypedScore 'Z ('S nl) s i
</span><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-var">SLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat). s -&gt; LeftHoles n s -&gt; LeftHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleLeft"><span class="hs-identifier hs-var">addHoleLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.one</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482843"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var">newir</span></a></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Scoring.FunTyped.html#unspreadScoresLeft"><span class="hs-identifier hs-var">unspreadScoresLeft</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679482838"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482838"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Attempting illegal left-unspread on &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482838"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">{- | Creates the 'Score' of a right parent edge
 from the middle and right child edges of an @unspread@
 and a @spread@ operation.
-}</span><span>
</span><span id="line-407"></span><span class="annot"><a href="Scoring.FunTyped.html#unspreadScoresRight"><span class="hs-identifier hs-type">unspreadScoresRight</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679483564"><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679483563"><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-409"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-comment">-- ^ The new ID that marks both parent edges.</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-comment">-- ^ The score of the @spread@ operation.</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the middle child edge.</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the right child edge.</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-comment">-- ^ The 'Score' of the right parent edge, if it exists.</span><span>
</span><span id="line-420"></span><span id="unspreadScoresRight"><span class="annot"><span class="annottext">unspreadScoresRight :: forall i s.
(Eq i, Semiring s, Show i, Show s) =&gt;
i -&gt; s -&gt; Score s i -&gt; Score s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#unspreadScoresRight"><span class="hs-identifier hs-var hs-var">unspreadScoresRight</span></a></span></span><span> </span><span id="local-6989586621679482833"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679482833"><span class="hs-identifier hs-var">newid</span></a></span></span><span> </span><span id="local-6989586621679482832"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482832"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482831"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482831"><span class="hs-identifier hs-var">nlm</span></a></span></span><span> </span><span id="local-6989586621679482830"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482830"><span class="hs-identifier hs-var">nrm</span></a></span></span><span> </span><span id="local-6989586621679482829"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482829"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-type">MkScore</span></a></span><span> </span><span id="local-6989586621679482821"><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482821"><span class="hs-identifier hs-var">nlr</span></a></span></span><span> </span><span id="local-6989586621679482820"><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482820"><span class="hs-identifier hs-var">nrr</span></a></span></span><span> </span><span id="local-6989586621679482819"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482819"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">forall (n :: Nat) r. SNat n -&gt; (AddHole n =&gt; r) -&gt; r
</span><a href="Scoring.FunTyped.html#canAddHole"><span class="hs-identifier hs-var">canAddHole</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482831"><span class="hs-identifier hs-var">nlm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat) s i.
SNat nl -&gt; SNat nr -&gt; TypedScore nl nr s i -&gt; Score s i
</span><a href="Scoring.FunTyped.html#MkScore"><span class="hs-identifier hs-var">MkScore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Nat). AddHole n =&gt; SNat n -&gt; SNat (CreateHole n)
</span><a href="Scoring.FunTyped.html#addHole"><span class="hs-identifier hs-var">addHole</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482831"><span class="hs-identifier hs-var">nlm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482820"><span class="hs-identifier hs-var">nrr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">TypedScore (CreateHole nl) nr s i
</span><a href="#local-6989586621679482814"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="annottext">nr :~: nl
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">testEquality</span></span><span> </span><span class="annot"><span class="annottext">SNat nr
</span><a href="#local-6989586621679482830"><span class="hs-identifier hs-var">nrm</span></a></span><span> </span><span class="annot"><span class="annottext">SNat nl
</span><a href="#local-6989586621679482821"><span class="hs-identifier hs-var">nlr</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679482806"><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482806"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s i (nl :: Nat) (n :: Nat) (nr :: Nat).
(Semiring s, Eq i, Show i) =&gt;
TypedScore nl n s i
-&gt; TypedScore n nr s i -&gt; Maybe (TypedScore nl nr s i)
</span><a href="Scoring.FunTyped.html#times"><span class="hs-identifier hs-var">times</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482829"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482819"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (nl :: Nat) (nr :: Nat).
TypedScore nl nr s i -&gt; TypedScore (CreateHole nl) nr s i
</span><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482806"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-425"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679482814"><span class="annot"><span class="annottext">err :: TypedScore (CreateHole nl) nr s i
</span><a href="#local-6989586621679482814"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Attempting illegal right-unspread: m=&quot;</span></span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482829"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, r=&quot;</span></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypedScore nl nr s i
</span><a href="#local-6989586621679482819"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-comment">-- generate a value on the right</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-comment">-- that consumes the left parent edge's value when supplied</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-comment">-- and combines with m on the right</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621679482804"><span class="annot"><span class="annottext">newil :: LeftId i
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var hs-var">newil</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. i -&gt; LeftId i
</span><a href="Scoring.FunTyped.html#LeftId"><span class="hs-identifier hs-var">LeftId</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679482833"><span class="hs-identifier hs-var">newid</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679483553"><span id="local-6989586621679483554"><span class="annot"><a href="#local-6989586621679482805"><span class="hs-identifier hs-type">unwrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483554"><span class="hs-identifier hs-type">nl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483553"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scoring.FunTyped.html#TypedScore"><span class="hs-identifier hs-type">TypedScore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#CreateHole"><span class="hs-identifier hs-type">CreateHole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483554"><span class="hs-identifier hs-type">nl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679483553"><span class="hs-identifier hs-type">nr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483563"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483564"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679482805"><span class="annot"><span class="annottext">unwrap :: forall (nl :: Nat) (nr :: Nat).
TypedScore nl nr s i -&gt; TypedScore (CreateHole nl) nr s i
</span><a href="#local-6989586621679482805"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SVal"><span class="hs-identifier hs-type">SVal</span></a></span><span> </span><span id="local-6989586621679482799"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482799"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">newil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-var">addHoleRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482832"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Semiring s =&gt; s -&gt; RightHoles 'Z s
</span><a href="Scoring.FunTyped.html#mkRightHole"><span class="hs-identifier hs-var">mkRightHole</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482799"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- [op, s]</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-type">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679482795"><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679482795"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) s.
LeftId i -&gt; RightHoles nl s -&gt; TypedScore ('S nl) 'Z s i
</span><a href="Scoring.FunTyped.html#SRight"><span class="hs-identifier hs-var">SRight</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">newil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-var">addHoleRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482832"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">RightHoles nl s
</span><a href="#local-6989586621679482795"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SLeft"><span class="hs-identifier hs-type">SLeft</span></a></span><span> </span><span id="local-6989586621679482788"><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482788"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679482787"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482787"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">newil</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles n s
</span><a href="Scoring.FunTyped.html#appendRight"><span class="hs-operator hs-var">`appendRight`</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-var">addHoleRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482832"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Semiring s =&gt; s -&gt; RightHoles 'Z s
</span><a href="Scoring.FunTyped.html#mkRightHole"><span class="hs-identifier hs-var">mkRightHole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.one</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LeftHoles nr s
</span><a href="#local-6989586621679482788"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482787"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-type">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679482783"><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679482783"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621679482782"><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482782"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i (nl :: Nat) (nr :: Nat) s.
LeftId i
-&gt; BothHoles nl nr s -&gt; RightId i -&gt; TypedScore ('S nl) ('S nr) s i
</span><a href="Scoring.FunTyped.html#SBoth"><span class="hs-identifier hs-var">SBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LeftId i
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">newil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (n :: Nat).
Semiring s =&gt;
s -&gt; RightHoles n s -&gt; RightHoles ('S n) s
</span><a href="Scoring.FunTyped.html#addHoleRight"><span class="hs-identifier hs-var">addHoleRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679482832"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BothHoles nl nr s
</span><a href="#local-6989586621679482783"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RightId i
</span><a href="#local-6989586621679482782"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-442"></span></pre></body></html>