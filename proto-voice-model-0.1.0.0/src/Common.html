<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-type-signatures #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Common types and functionality that are used throughout the model.</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Common</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Paths #paths#</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-comment">-- | Paths encode sequences of alternating objects (such as nodes and edges).</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">-- They are often used to encode sequences of slices and transitions.</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-comment">-- Note that dependending on context,</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-comment">-- both slice-transition-slice and transition-slice-transition orders are used.</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier">pathLen</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier">pathHead</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier">pathSetHead</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier">mapArounds</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier">mapAroundsWithIndex</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier">mapBetweens</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#reversePath"><span class="hs-identifier">reversePath</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier">pathArounds</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier">pathBetweens</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * StartStop #startstop#</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- | 'StartStop' is a wrapper that augments a type with special values for beginning and end.</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier">StartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier">onlyInner</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier">getInner</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier">getInnerE</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier">isInner</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier">isStart</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier">isStop</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier">distStartStop</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Evaluators #evals#</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-comment">-- | Evaluators ('Eval') are the main parsing interface for a grammar.</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-comment">-- They bundle a number of functions that compute local &quot;completions&quot;</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-comment">-- (i.e., parent objects and generative operations)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-comment">-- from child objects.</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-comment">-- Parsers use these evaluators to generically parse an input sequence</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-comment">-- since all the grammar-specific parsing code is provided by the evaluator.</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">-- Evaluators can be transformed and combined using 'mapEvalScore' and 'productEval' respectively.</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier">SplitType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier">UnspreadMiddle</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier">UnspreadLeft</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier">UnspreadRight</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier">Unsplit</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier">IsLast</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapEvalScore"><span class="hs-identifier">mapEvalScore</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#productEval"><span class="hs-identifier">productEval</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Special Restricting Evaluators #special-evals#</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- | Some special evaluators that can be combined with grammar-specific evaluators</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- to restrict the possibile derivations.</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier">RightBranchSpread</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier">evalRightBranchSpread</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#rightBranchSpread"><span class="hs-identifier">rightBranchSpread</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier">Merged</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier">evalSplitBeforeSpread</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#splitFirst"><span class="hs-identifier">splitFirst</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Leftmost Derivations #leftmost#</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- | Derivations can be represented as lists of operations in leftmost-first order.</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- In this order, each operation (split, spread, or freeze)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- is applied to the leftmost non-terminal transition(s).</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- $leftmostdoc</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier">Leftmost</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier">LMDouble</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier">LMFreezeLeft</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-identifier">LMFreezeOnly</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier">LMSingle</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier">LMSplitLeft</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-identifier">LMSplitOnly</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-identifier">LMSplitRight</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-identifier">LMSpread</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier">LeftmostSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier">LeftmostDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier">Analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#debugAnalysis"><span class="hs-identifier">debugAnalysis</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mkLeftmostEval"><span class="hs-identifier">mkLeftmostEval</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Monadic Interface for Constructing Derivations #monadicDeriv#</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-comment">-- $monadicdoc</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#PartialDerivation"><span class="hs-identifier">PartialDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier">DerivationInfo</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier">IndexedWriter</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#itell"><span class="hs-identifier">itell</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier">DerivationAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#buildDerivation"><span class="hs-identifier">buildDerivation</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#buildPartialDerivation"><span class="hs-identifier">buildPartialDerivation</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#split"><span class="hs-identifier">split</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#freeze"><span class="hs-identifier">freeze</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#splitRight"><span class="hs-identifier">splitRight</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#spread"><span class="hs-identifier">spread</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Derivations Semiring #derivSemiring#</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="hs-comment">-- | A generic semiring that represents a collection of derivations as prefix trees.</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier">Derivations</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier">mapDerivations</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#flattenDerivations"><span class="hs-identifier">flattenDerivations</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier">flattenDerivationsRed</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier">firstDerivation</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities #utils#</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#traceLevel"><span class="hs-identifier">traceLevel</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#traceIf"><span class="hs-identifier">traceIf</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#showTex"><span class="hs-identifier">showTex</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#showTexT"><span class="hs-identifier">showTexT</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Indexed</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MI</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">except</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MW</span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.:)</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unexpected</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bimap</span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stimesMonoid</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semiring</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Nat</span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(+)</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=)</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Unicode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Pitch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Notation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ReadP</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Path: sequences of alternating objects</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- ======================================</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">{- | A Path is a datastructure that represents a sequence of alternating objects,
 /arounds/ and /betweens/,
 starting and ending with the same type.
 An example would be a path in a graph,
 starting and ending with a node with edges in-between.
-}</span><span>
</span><span id="line-175"></span><span id="local-6989586621679496287"><span id="local-6989586621679496288"></span></span><span class="hs-keyword">data</span><span> </span><span id="Path"><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span id="local-6989586621679497551"><span class="annot"><a href="#local-6989586621679497551"><span class="hs-identifier hs-type">around</span></a></span></span><span> </span><span id="local-6989586621679497550"><span class="annot"><a href="#local-6989586621679497550"><span class="hs-identifier hs-type">between</span></a></span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Path"><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497551"><span class="hs-identifier hs-type">around</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497550"><span class="hs-identifier hs-type">between</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497551"><span class="hs-identifier hs-type">around</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497550"><span class="hs-identifier hs-type">between</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PathEnd"><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497551"><span class="hs-identifier hs-type">around</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679496277"><span id="local-6989586621679496283"><span class="annot"><span class="annottext">Path around between -&gt; Path around between -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall around between.
(Eq around, Eq between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
/= :: Path around between -&gt; Path around between -&gt; Bool
$c/= :: forall around between.
(Eq around, Eq between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
== :: Path around between -&gt; Path around between -&gt; Bool
$c== :: forall around between.
(Eq around, Eq between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496249"><span id="local-6989586621679496251"><span id="local-6989586621679496254"><span id="local-6989586621679496257"><span id="local-6989586621679496260"><span id="local-6989586621679496266"><span id="local-6989586621679496272"><span class="annot"><span class="annottext">Path around between -&gt; Path around between -&gt; Bool
Path around between -&gt; Path around between -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {around} {between}.
(Ord around, Ord between) =&gt;
Eq (Path around between)
forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Ordering
forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
min :: Path around between -&gt; Path around between -&gt; Path around between
$cmin :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
max :: Path around between -&gt; Path around between -&gt; Path around between
$cmax :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
&gt;= :: Path around between -&gt; Path around between -&gt; Bool
$c&gt;= :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&gt; :: Path around between -&gt; Path around between -&gt; Bool
$c&gt; :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&lt;= :: Path around between -&gt; Path around between -&gt; Bool
$c&lt;= :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&lt; :: Path around between -&gt; Path around between -&gt; Bool
$c&lt; :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Bool
compare :: Path around between -&gt; Path around between -&gt; Ordering
$ccompare :: forall around between.
(Ord around, Ord between) =&gt;
Path around between -&gt; Path around between -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall around between x.
Rep (Path around between) x -&gt; Path around between
forall around between x.
Path around between -&gt; Rep (Path around between) x
$cto :: forall around between x.
Rep (Path around between) x -&gt; Path around between
$cfrom :: forall around between x.
Path around between -&gt; Rep (Path around between) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496239"><span id="local-6989586621679496241"><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679496236"><span class="annot"><span class="annottext">bimap :: forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Path a c -&gt; Path b d
</span><a href="#local-6989586621679496236"><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></a></span></span><span> </span><span id="local-6989586621679496235"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679496235"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="annot"><span class="annottext">c -&gt; d
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496234"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496234"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679496235"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496234"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">bimap</span></span><span> </span><span id="local-6989586621679496233"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679496233"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span id="local-6989586621679496232"><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679496232"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496231"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496231"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496230"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679496230"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496229"><span class="annot"><span class="annottext">Path a c
</span><a href="#local-6989586621679496229"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679496233"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496231"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679496232"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679496230"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679496233"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679496232"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Path a c
</span><a href="#local-6989586621679496229"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496224"><span id="local-6989586621679496227"><span id="local-6989586621679497526"><span id="local-6989586621679497527"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497526"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497526"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679496211"><span class="annot"><span class="annottext">show :: Path a b -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496209"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496209"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496208"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496208"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496207"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496207"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496209"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n+-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496208"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496207"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496206"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496206"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496206"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Returns the number of /arounds/ in the path.</span><span>
</span><span id="line-189"></span><span id="local-6989586621679497522"><span id="local-6989586621679497523"><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier hs-type">pathLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497522"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-190"></span><span id="pathLen"><span class="annot"><span class="annottext">pathLen :: forall a b. Path a b -&gt; Int
</span><a href="Common.html#pathLen"><span class="hs-identifier hs-var hs-var">pathLen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679496202"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496202"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; Int
</span><a href="Common.html#pathLen"><span class="hs-identifier hs-var">pathLen</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496202"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier hs-var">pathLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Returns the first /around/ in the path.</span><span>
</span><span id="line-194"></span><span id="local-6989586621679497517"><span id="local-6989586621679497518"><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier hs-type">pathHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497518"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497517"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497518"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-195"></span><span id="pathHead"><span class="annot"><span class="annottext">pathHead :: forall a b. Path a b -&gt; a
</span><a href="Common.html#pathHead"><span class="hs-identifier hs-var hs-var">pathHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496200"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496200"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496200"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier hs-var">pathHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496199"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496199"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496199"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Replaces the first /around/ in the path.</span><span>
</span><span id="line-199"></span><span id="local-6989586621679497513"><span id="local-6989586621679497514"><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier hs-type">pathSetHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497513"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497513"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-200"></span><span id="pathSetHead"><span class="annot"><span class="annottext">pathSetHead :: forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var hs-var">pathSetHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679496198"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496198"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496197"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496197"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679496196"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496196"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496196"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496198"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496197"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679496195"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496195"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496195"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Maps a function over every /around/ in the path.</span><span>
</span><span id="line-204"></span><span id="local-6989586621679496192"><span id="local-6989586621679496193"><span id="local-6989586621679496194"><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier hs-type">mapArounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496193"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496192"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496193"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496192"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-205"></span><span id="mapArounds"><span class="annot"><span class="annottext">mapArounds :: forall a b c. (a -&gt; b) -&gt; Path a c -&gt; Path b c
</span><a href="Common.html#mapArounds"><span class="hs-identifier hs-var hs-var">mapArounds</span></a></span></span><span> </span><span id="local-6989586621679496191"><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679496191"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496190"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496190"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496189"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496189"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496188"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496188"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679496191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496190"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496189"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b) -&gt; Path a c -&gt; Path b c
</span><a href="Common.html#mapArounds"><span class="hs-identifier hs-var">mapArounds</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679496191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496188"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier hs-var">mapArounds</span></a></span><span> </span><span id="local-6989586621679496187"><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679496187"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496186"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496186"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679496187"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496186"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Maps a function over every /around/ in the path together with its index.</span><span>
</span><span id="line-209"></span><span id="local-6989586621679497505"><span id="local-6989586621679497506"><span id="local-6989586621679497507"><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-type">mapAroundsWithIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497506"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497505"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497506"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497505"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-210"></span><span id="mapAroundsWithIndex"><span class="annot"><span class="annottext">mapAroundsWithIndex :: forall a a' b. Int -&gt; (Int -&gt; a -&gt; a') -&gt; Path a b -&gt; Path a' b
</span><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var hs-var">mapAroundsWithIndex</span></a></span></span><span> </span><span id="local-6989586621679496183"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679496183"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679496182"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679496182"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496181"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496181"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496180"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496180"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496179"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496179"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679496182"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679496183"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496181"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496180"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a a' b. Int -&gt; (Int -&gt; a -&gt; a') -&gt; Path a b -&gt; Path a' b
</span><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var">mapAroundsWithIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679496183"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679496182"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496179"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var">mapAroundsWithIndex</span></a></span><span> </span><span id="local-6989586621679496178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679496178"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679496177"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679496177"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496176"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496176"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679496177"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679496178"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496176"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Maps a function over every /between/ and its adjacent /arounds/ in the path.</span><span>
</span><span id="line-215"></span><span id="local-6989586621679497499"><span id="local-6989586621679497500"><span id="local-6989586621679497501"><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier hs-type">mapBetweens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497500"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497499"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497500"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679497499"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-216"></span><span id="mapBetweens"><span class="annot"><span class="annottext">mapBetweens :: forall a b c. (a -&gt; b -&gt; a -&gt; c) -&gt; Path a b -&gt; [c]
</span><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var hs-var">mapBetweens</span></a></span></span><span> </span><span id="local-6989586621679496175"><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679496175"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496174"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496174"><span class="hs-identifier hs-var">al</span></a></span></span><span> </span><span id="local-6989586621679496173"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496173"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496172"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496172"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679496175"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496174"><span class="hs-identifier hs-var">al</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496173"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496171"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; a -&gt; c) -&gt; Path a b -&gt; [c]
</span><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var">mapBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679496175"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496172"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-217"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679496171"><span class="annot"><span class="annottext">ar :: a
</span><a href="#local-6989586621679496171"><span class="hs-identifier hs-var hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; a
</span><a href="Common.html#pathHead"><span class="hs-identifier hs-var">pathHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496172"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var">mapBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Reverses the path.</span><span>
</span><span id="line-222"></span><span id="local-6989586621679497493"><span id="local-6989586621679497494"><span class="annot"><a href="Common.html#reversePath"><span class="hs-identifier hs-type">reversePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497493"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497493"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-223"></span><span id="reversePath"><span class="annot"><span class="annottext">reversePath :: forall a b. Path a b -&gt; Path a b
</span><a href="Common.html#reversePath"><span class="hs-identifier hs-var hs-var">reversePath</span></a></span></span><span> </span><span id="local-6989586621679496170"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496170"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496170"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496169"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496169"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496169"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496168"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496168"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496167"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496167"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496166"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496166"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {t} {around}.
t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679496165"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496167"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496166"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496168"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679496165"><span class="annot"><span class="annottext">go :: t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679496165"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679496164"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496164"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496163"><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679496163"><span class="hs-identifier hs-var">aEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679496162"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496162"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679496163"><span class="hs-identifier hs-var">aEnd</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496164"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496162"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="#local-6989586621679496165"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679496161"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496161"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496160"><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679496160"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679496159"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496159"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span id="local-6989586621679496158"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496158"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679496157"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496157"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679496165"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496159"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496158"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679496160"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679496161"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679496157"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Returns the list of /arounds/  in the path.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679497487"><span id="local-6989586621679497488"><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier hs-type">pathArounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497487"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679497488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-232"></span><span id="pathArounds"><span class="annot"><span class="annottext">pathArounds :: forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var hs-var">pathArounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679496156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496156"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679496155"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496155"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496156"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496155"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679496154"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496154"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496154"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Returns the list of /betweens/ in the path).</span><span>
</span><span id="line-236"></span><span id="local-6989586621679497483"><span id="local-6989586621679497484"><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier hs-type">pathBetweens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497484"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497483"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679497483"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-237"></span><span id="pathBetweens"><span class="annot"><span class="annottext">pathBetweens :: forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var hs-var">pathBetweens</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679496153"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496153"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679496152"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496152"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679496153"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679496152"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- StartStop</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- =========</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">{- | A container type that augements the type @a@
 with symbols for beginning ('Start', &#8906;) and end ('Stop', &#8905;).
 Every other value is wrapped in an @Inner@ constructor.
-}</span><span>
</span><span id="line-247"></span><span id="local-6989586621679496150"><span id="local-6989586621679496151"></span></span><span class="hs-keyword">data</span><span> </span><span id="StartStop"><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-var">StartStop</span></a></span></span><span> </span><span id="local-6989586621679497479"><span class="annot"><a href="#local-6989586621679497479"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Start"><span class="annot"><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Inner"><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497479"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Stop"><span class="annot"><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679496126"><span id="local-6989586621679496128"><span id="local-6989586621679496131"><span id="local-6989586621679496134"><span id="local-6989586621679496137"><span id="local-6989586621679496140"><span id="local-6989586621679496143"><span class="annot"><span class="annottext">StartStop a -&gt; StartStop a -&gt; Bool
StartStop a -&gt; StartStop a -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a}. Ord a =&gt; Eq (StartStop a)
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Ordering
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
min :: StartStop a -&gt; StartStop a -&gt; StartStop a
$cmin :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
max :: StartStop a -&gt; StartStop a -&gt; StartStop a
$cmax :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
&gt;= :: StartStop a -&gt; StartStop a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&gt; :: StartStop a -&gt; StartStop a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&lt;= :: StartStop a -&gt; StartStop a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&lt; :: StartStop a -&gt; StartStop a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
compare :: StartStop a -&gt; StartStop a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496121"><span id="local-6989586621679496124"><span class="annot"><span class="annottext">StartStop a -&gt; StartStop a -&gt; Bool
forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StartStop a -&gt; StartStop a -&gt; Bool
$c/= :: forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
== :: StartStop a -&gt; StartStop a -&gt; Bool
$c== :: forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (StartStop a) x -&gt; StartStop a
forall a x. StartStop a -&gt; Rep (StartStop a) x
$cto :: forall a x. Rep (StartStop a) x -&gt; StartStop a
$cfrom :: forall a x. StartStop a -&gt; Rep (StartStop a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496117"><span class="annot"><span class="annottext">forall a. NFData a =&gt; StartStop a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: StartStop a -&gt; ()
$crnf :: forall a. NFData a =&gt; StartStop a -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496110"><span id="local-6989586621679496112"><span class="annot"><span class="annottext">forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall {a}. Hashable a =&gt; Eq (StartStop a)
forall a. Hashable a =&gt; Int -&gt; StartStop a -&gt; Int
forall a. Hashable a =&gt; StartStop a -&gt; Int
hash :: StartStop a -&gt; Int
$chash :: forall a. Hashable a =&gt; StartStop a -&gt; Int
hashWithSalt :: Int -&gt; StartStop a -&gt; Int
$chashWithSalt :: forall a. Hashable a =&gt; Int -&gt; StartStop a -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496105"><span id="local-6989586621679496107"><span class="annot"><span class="annottext">forall a b. a -&gt; StartStop b -&gt; StartStop a
forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; StartStop b -&gt; StartStop a
$c&lt;$ :: forall a b. a -&gt; StartStop b -&gt; StartStop a
fmap :: forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
$cfmap :: forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496066"><span id="local-6989586621679496068"><span id="local-6989586621679496070"><span id="local-6989586621679496072"><span id="local-6989586621679496074"><span id="local-6989586621679496076"><span id="local-6989586621679496078"><span id="local-6989586621679496080"><span id="local-6989586621679496082"><span id="local-6989586621679496084"><span id="local-6989586621679496086"><span id="local-6989586621679496088"><span id="local-6989586621679496090"><span id="local-6989586621679496092"><span id="local-6989586621679496094"><span id="local-6989586621679496099"><span id="local-6989586621679496101"><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
forall a. Num a =&gt; StartStop a -&gt; a
forall a. Ord a =&gt; StartStop a -&gt; a
forall m. Monoid m =&gt; StartStop m -&gt; m
forall a. StartStop a -&gt; Bool
forall a. StartStop a -&gt; Int
forall a. StartStop a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: forall a. Num a =&gt; StartStop a -&gt; a
$cproduct :: forall a. Num a =&gt; StartStop a -&gt; a
sum :: forall a. Num a =&gt; StartStop a -&gt; a
$csum :: forall a. Num a =&gt; StartStop a -&gt; a
minimum :: forall a. Ord a =&gt; StartStop a -&gt; a
$cminimum :: forall a. Ord a =&gt; StartStop a -&gt; a
maximum :: forall a. Ord a =&gt; StartStop a -&gt; a
$cmaximum :: forall a. Ord a =&gt; StartStop a -&gt; a
elem :: forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
length :: forall a. StartStop a -&gt; Int
$clength :: forall a. StartStop a -&gt; Int
null :: forall a. StartStop a -&gt; Bool
$cnull :: forall a. StartStop a -&gt; Bool
toList :: forall a. StartStop a -&gt; [a]
$ctoList :: forall a. StartStop a -&gt; [a]
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
fold :: forall m. Monoid m =&gt; StartStop m -&gt; m
$cfold :: forall m. Monoid m =&gt; StartStop m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679496048"><span id="local-6989586621679496050"><span id="local-6989586621679496052"><span id="local-6989586621679496059"><span class="annot"><span class="annottext">Functor StartStop
Foldable StartStop
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- some instances for StartStop</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496041"><span id="local-6989586621679496044"><span id="local-6989586621679497437"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497437"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679496039"><span class="annot"><span class="annottext">show :: StartStop a -&gt; String
</span><a href="#local-6989586621679496039"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679496038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496038"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496038"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496030"><span id="local-6989586621679496032"><span id="local-6989586621679496035"><span id="local-6989586621679497433"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679497433"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497433"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679496027"><span class="annot"><span class="annottext">showNotation :: StartStop a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showNotation</span></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679496025"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496025"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496025"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679496024"><span class="annot"><span class="annottext">parseNotation :: ReadP (StartStop a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseNotation</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ReadP a
</span><span class="hs-identifier hs-var">ReadP.pfail</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496019"><span id="local-6989586621679497428"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497428"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679496005"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (StartStop a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;start&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stop&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span id="local-6989586621679496002"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679496002"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679496002"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- some helper functions for StartStop</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">{- | From a list of @StartStop@s returns only the elements that are not @:&#8906;@ or @:&#8905;@,
 unwrapped to their original type.
-}</span><span>
</span><span id="line-276"></span><span id="local-6989586621679497423"><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-type">onlyInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679497423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-277"></span><span id="onlyInner"><span class="annot"><span class="annottext">onlyInner :: forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var hs-var">onlyInner</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679496000"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496000"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679495999"><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679495999"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679496000"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679495999"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-279"></span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679495998"><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679495998"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679495998"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Returns the content of an 'Inner', or 'Nothing'.</span><span>
</span><span id="line-282"></span><span id="local-6989586621679497421"><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier hs-type">getInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497421"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679497421"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-283"></span><span id="getInner"><span class="annot"><span class="annottext">getInner :: forall a. StartStop a -&gt; Maybe a
</span><a href="Common.html#getInner"><span class="hs-identifier hs-var hs-var">getInner</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679495997"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495997"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495997"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier hs-var">getInner</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Returns the content of an 'Inner', or a 'Left' with an error message.</span><span>
</span><span id="line-287"></span><span id="local-6989586621679497419"><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-type">getInnerE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679497419"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-288"></span><span id="getInnerE"><span class="annot"><span class="annottext">getInnerE :: forall a. StartStop a -&gt; Either String a
</span><a href="Common.html#getInnerE"><span class="hs-identifier hs-var hs-var">getInnerE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679495994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495994"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495994"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-var">getInnerE</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected inner but found &#8906;&quot;</span></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-var">getInnerE</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected inner but found &#8905;&quot;</span></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | Returns 'True' iff the argument is an 'Inner'.</span><span>
</span><span id="line-293"></span><span id="local-6989586621679495993"><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier hs-type">isInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679495993"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-294"></span><span id="isInner"><span class="annot"><span class="annottext">isInner :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isInner"><span class="hs-identifier hs-var hs-var">isInner</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier hs-var">isInner</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Returns 'True' iff the argument is 'Start'.</span><span>
</span><span id="line-298"></span><span id="local-6989586621679495992"><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier hs-type">isStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679495992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-299"></span><span id="isStart"><span class="annot"><span class="annottext">isStart :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isStart"><span class="hs-identifier hs-var hs-var">isStart</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier hs-var">isStart</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Returns 'True' iff the argument is 'Stop'.</span><span>
</span><span id="line-303"></span><span id="local-6989586621679495991"><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier hs-type">isStop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679495991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-304"></span><span id="isStop"><span class="annot"><span class="annottext">isStop :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isStop"><span class="hs-identifier hs-var hs-var">isStop</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier hs-var">isStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Turns a pair within a 'StartStop' into a pair of 'StartStop's</span><span>
</span><span id="line-308"></span><span id="local-6989586621679497411"><span id="local-6989586621679497412"><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-type">distStartStop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497411"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497411"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-309"></span><span id="distStartStop"><span class="annot"><span class="annottext">distStartStop :: forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var hs-var">distStartStop</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop (a, b)
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (a, b)
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495990"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495990"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495989"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679495989"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679495990"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679495989"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- evaluator interface</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- ===================</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- | A flag indicating whether an operation is performed on the last transition.</span><span>
</span><span id="line-317"></span><span class="hs-keyword">type</span><span> </span><span id="IsLast"><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier hs-var">IsLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">{- | A flag that indicates where a split has been performed,
 on the left transition, the right transition, or the only transition
-}</span><span>
</span><span id="line-322"></span><span class="hs-keyword">data</span><span> </span><span id="SplitType"><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier hs-var">SplitType</span></a></span></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LeftOfTwo"><span class="annot"><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RightOfTwo"><span class="annot"><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SingleOfOne"><span class="annot"><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">{- | An evaluator for unspreads.
 Takes the two child slices and the middle transition.
 Returns the parent slice and the spread operation, if possible.
-}</span><span>
</span><span id="line-331"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadMiddle"><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-var">UnspreadMiddle</span></a></span></span><span> </span><span id="local-6989586621679495985"><span class="annot"><a href="#local-6989586621679495985"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679495984"><span class="annot"><a href="#local-6989586621679495984"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679495983"><span class="annot"><a href="#local-6989586621679495983"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679495984"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495985"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495984"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679495984"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495983"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">{- | An evaluator returning the possible left parent edges of an unspread.
 The first argument is a pair of left child transition and left child slice.
 The second argument is the parent slice.
-}</span><span>
</span><span id="line-337"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadLeft"><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-var">UnspreadLeft</span></a></span></span><span> </span><span id="local-6989586621679495982"><span class="annot"><a href="#local-6989586621679495982"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679495981"><span class="annot"><a href="#local-6989586621679495981"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679495982"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495981"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679495981"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679495982"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">{- | An evaluator returning the possible right parent edges of an unspread.
 The first argument is a pair of right child slice and right child transition.
 The second argument is the parent slice.
-}</span><span>
</span><span id="line-343"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadRight"><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-var">UnspreadRight</span></a></span></span><span> </span><span id="local-6989586621679495980"><span class="annot"><a href="#local-6989586621679495980"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679495979"><span class="annot"><a href="#local-6989586621679495979"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679495979"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495980"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679495979"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679495980"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">{- | An evaluator for unsplits.
 Returns possible unsplits of a given pair of transitions.
-}</span><span>
</span><span id="line-348"></span><span class="hs-keyword">type</span><span> </span><span id="Unsplit"><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier hs-var">Unsplit</span></a></span></span><span> </span><span id="local-6989586621679495978"><span class="annot"><a href="#local-6989586621679495978"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679495977"><span class="annot"><a href="#local-6989586621679495977"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679495976"><span class="annot"><a href="#local-6989586621679495976"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679495977"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679495978"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679495977"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679495978"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679495977"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier hs-type">SplitType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679495978"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679495976"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">{- | A combined evaluator for unsplits, unspreads, and unfreezes.
 Additionally, contains a function for mapping terminal slices to derivation slices.
-}</span><span>
</span><span id="line-354"></span><span class="hs-keyword">data</span><span> </span><span id="Eval"><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span></span><span> </span><span id="local-6989586621679497408"><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679497407"><span class="annot"><a href="#local-6989586621679497407"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679497406"><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679497405"><span class="annot"><a href="#local-6989586621679497405"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679497404"><span class="annot"><a href="#local-6989586621679497404"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Eval"><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="evalUnspreadMiddle"><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var hs-var">evalUnspreadMiddle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-type">UnspreadMiddle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497404"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnspreadLeft"><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var hs-var">evalUnspreadLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-type">UnspreadLeft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnspreadRight"><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var hs-var">evalUnspreadRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-type">UnspreadRight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnsplit"><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var hs-var">evalUnsplit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier hs-type">Unsplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497404"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnfreeze"><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var hs-var">evalUnfreeze</span></a></span></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679497407"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier hs-type">IsLast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497408"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497404"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalSlice"><span class="annot"><span class="annottext">forall tr tr' slc slc' v. Eval tr tr' slc slc' v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var hs-var">evalSlice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497405"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497406"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Maps a function over all scores produced by the evaluator.</span><span>
</span><span id="line-365"></span><span id="local-6989586621679497363"><span id="local-6989586621679497364"><span id="local-6989586621679497365"><span id="local-6989586621679497366"><span id="local-6989586621679497367"><span id="local-6989586621679497368"><span class="annot"><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-type">mapEvalScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497368"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497367"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497366"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497365"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497364"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497363"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497368"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497366"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497365"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497364"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497363"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497367"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-366"></span><span id="mapEvalScore"><span class="annot"><span class="annottext">mapEvalScore :: forall v w tr tr' slc slc'.
(v -&gt; w) -&gt; Eval tr tr' slc slc' v -&gt; Eval tr tr' slc slc' w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var hs-var">mapEvalScore</span></a></span></span><span> </span><span id="local-6989586621679495959"><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679495959"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679495958"><span class="annot"><span class="annottext">UnspreadMiddle tr slc v
</span><a href="#local-6989586621679495958"><span class="hs-identifier hs-var">unspreadm</span></a></span></span><span> </span><span id="local-6989586621679495957"><span class="annot"><span class="annottext">UnspreadLeft tr slc
</span><a href="#local-6989586621679495957"><span class="hs-identifier hs-var">unspreadl</span></a></span></span><span> </span><span id="local-6989586621679495956"><span class="annot"><span class="annottext">UnspreadRight tr slc
</span><a href="#local-6989586621679495956"><span class="hs-identifier hs-var">unspreadr</span></a></span></span><span> </span><span id="local-6989586621679495955"><span class="annot"><span class="annottext">Unsplit tr slc v
</span><a href="#local-6989586621679495955"><span class="hs-identifier hs-var">unsplit</span></a></span></span><span> </span><span id="local-6989586621679495954"><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="#local-6989586621679495954"><span class="hs-identifier hs-var">uf</span></a></span></span><span> </span><span id="local-6989586621679495953"><span class="annot"><span class="annottext">slc' -&gt; slc
</span><a href="#local-6989586621679495953"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
UnspreadMiddle tr slc v
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">(slc, tr, slc) -&gt; Maybe (slc, w)
</span><a href="#local-6989586621679495952"><span class="hs-identifier hs-var">unspreadm'</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">UnspreadLeft tr slc
</span><a href="#local-6989586621679495957"><span class="hs-identifier hs-var">unspreadl</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">UnspreadRight tr slc
</span><a href="#local-6989586621679495956"><span class="hs-identifier hs-var">unspreadr</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; SplitType -&gt; [(tr, w)]
</span><a href="#local-6989586621679495951"><span class="hs-identifier hs-var">unsplit'</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, w)]
</span><a href="#local-6989586621679495950"><span class="hs-identifier hs-var">uf'</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">slc' -&gt; slc
</span><a href="#local-6989586621679495953"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-374"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679495952"><span class="annot"><span class="annottext">unspreadm' :: (slc, tr, slc) -&gt; Maybe (slc, w)
</span><a href="#local-6989586621679495952"><span class="hs-identifier hs-var hs-var">unspreadm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679495959"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc v
</span><a href="#local-6989586621679495958"><span class="hs-identifier hs-var">unspreadm</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679495951"><span class="annot"><span class="annottext">unsplit' :: StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; SplitType -&gt; [(tr, w)]
</span><a href="#local-6989586621679495951"><span class="hs-identifier hs-var hs-var">unsplit'</span></a></span></span><span> </span><span id="local-6989586621679495948"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495948"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679495947"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679495947"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679495946"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679495946"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679495945"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679495945"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679495944"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495944"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679495943"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679495943"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679495959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unsplit tr slc v
</span><a href="#local-6989586621679495955"><span class="hs-identifier hs-var">unsplit</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495948"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679495947"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679495946"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679495945"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495944"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679495943"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679495950"><span class="annot"><span class="annottext">uf' :: StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, w)]
</span><a href="#local-6989586621679495950"><span class="hs-identifier hs-var hs-var">uf'</span></a></span></span><span> </span><span id="local-6989586621679495942"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495942"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679495941"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679495941"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679495940"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495940"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679495939"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679495939"><span class="hs-identifier hs-var">isLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679495959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="#local-6989586621679495954"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495942"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679495941"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679495940"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679495939"><span class="hs-identifier hs-var">isLast</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- product evaluators</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- ------------------</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">{- | Combine two evaluators into a product evaluator.
 Each evaluation function returns the product of the two component evaluators' results.
-}</span><span>
</span><span id="line-385"></span><span id="local-6989586621679497344"><span id="local-6989586621679497345"><span id="local-6989586621679497346"><span id="local-6989586621679497347"><span id="local-6989586621679497348"><span id="local-6989586621679497349"><span id="local-6989586621679497350"><span id="local-6989586621679497351"><span class="annot"><a href="Common.html#productEval"><span class="hs-identifier hs-type">productEval</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497351"><span class="hs-identifier hs-type">tr1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497350"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497349"><span class="hs-identifier hs-type">slc1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497348"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497347"><span class="hs-identifier hs-type">v1</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497346"><span class="hs-identifier hs-type">tr2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497350"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497345"><span class="hs-identifier hs-type">slc2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497348"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497344"><span class="hs-identifier hs-type">v2</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497351"><span class="hs-identifier hs-type">tr1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497346"><span class="hs-identifier hs-type">tr2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497350"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497349"><span class="hs-identifier hs-type">slc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497345"><span class="hs-identifier hs-type">slc2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497348"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497347"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497344"><span class="hs-identifier hs-type">v2</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-389"></span><span id="productEval"><span class="annot"><span class="annottext">productEval :: forall tr1 tr' slc1 slc' v1 tr2 slc2 v2.
Eval tr1 tr' slc1 slc' v1
-&gt; Eval tr2 tr' slc2 slc' v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var hs-var">productEval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679495919"><span class="annot"><span class="annottext">UnspreadMiddle tr1 slc1 v1
</span><a href="#local-6989586621679495919"><span class="hs-identifier hs-var">unspreadm1</span></a></span></span><span> </span><span id="local-6989586621679495918"><span class="annot"><span class="annottext">UnspreadLeft tr1 slc1
</span><a href="#local-6989586621679495918"><span class="hs-identifier hs-var">unspreadl1</span></a></span></span><span> </span><span id="local-6989586621679495917"><span class="annot"><span class="annottext">UnspreadRight tr1 slc1
</span><a href="#local-6989586621679495917"><span class="hs-identifier hs-var">unspreadr1</span></a></span></span><span> </span><span id="local-6989586621679495916"><span class="annot"><span class="annottext">Unsplit tr1 slc1 v1
</span><a href="#local-6989586621679495916"><span class="hs-identifier hs-var">merge1</span></a></span></span><span> </span><span id="local-6989586621679495915"><span class="annot"><span class="annottext">StartStop slc1
-&gt; Maybe tr' -&gt; StartStop slc1 -&gt; Bool -&gt; [(tr1, v1)]
</span><a href="#local-6989586621679495915"><span class="hs-identifier hs-var">thaw1</span></a></span></span><span> </span><span id="local-6989586621679495914"><span class="annot"><span class="annottext">slc' -&gt; slc1
</span><a href="#local-6989586621679495914"><span class="hs-identifier hs-var">slice1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679495913"><span class="annot"><span class="annottext">UnspreadMiddle tr2 slc2 v2
</span><a href="#local-6989586621679495913"><span class="hs-identifier hs-var">unspreadm2</span></a></span></span><span> </span><span id="local-6989586621679495912"><span class="annot"><span class="annottext">UnspreadLeft tr2 slc2
</span><a href="#local-6989586621679495912"><span class="hs-identifier hs-var">unspreadl2</span></a></span></span><span> </span><span id="local-6989586621679495911"><span class="annot"><span class="annottext">UnspreadRight tr2 slc2
</span><a href="#local-6989586621679495911"><span class="hs-identifier hs-var">unspreadr2</span></a></span></span><span> </span><span id="local-6989586621679495910"><span class="annot"><span class="annottext">Unsplit tr2 slc2 v2
</span><a href="#local-6989586621679495910"><span class="hs-identifier hs-var">merge2</span></a></span></span><span> </span><span id="local-6989586621679495909"><span class="annot"><span class="annottext">StartStop slc2
-&gt; Maybe tr' -&gt; StartStop slc2 -&gt; Bool -&gt; [(tr2, v2)]
</span><a href="#local-6989586621679495909"><span class="hs-identifier hs-var">thaw2</span></a></span></span><span> </span><span id="local-6989586621679495908"><span class="annot"><span class="annottext">slc' -&gt; slc2
</span><a href="#local-6989586621679495908"><span class="hs-identifier hs-var">slice2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
UnspreadMiddle tr slc v
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">((slc1, slc2), (tr1, tr2), (slc1, slc2))
-&gt; Maybe ((slc1, slc2), (v1, v2))
</span><a href="#local-6989586621679495907"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">((tr1, tr2), (slc1, slc2)) -&gt; (slc1, slc2) -&gt; [(tr1, tr2)]
</span><a href="#local-6989586621679495906"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">((slc1, slc2), (tr1, tr2)) -&gt; (slc1, slc2) -&gt; [(tr1, tr2)]
</span><a href="#local-6989586621679495905"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
-&gt; (tr1, tr2)
-&gt; (slc1, slc2)
-&gt; (tr1, tr2)
-&gt; StartStop (slc1, slc2)
-&gt; SplitType
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679495904"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
-&gt; Maybe tr'
-&gt; StartStop (slc1, slc2)
-&gt; Bool
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679495903"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">slc' -&gt; (slc1, slc2)
</span><a href="#local-6989586621679495902"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-391"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679495907"><span class="annot"><span class="annottext">unspreadm :: ((slc1, slc2), (tr1, tr2), (slc1, slc2))
-&gt; Maybe ((slc1, slc2), (v1, v2))
</span><a href="#local-6989586621679495907"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679495901"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495901"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495900"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495900"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495899"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495899"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495898"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495898"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495897"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495897"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495896"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495896"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495895"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495895"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495894"><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495894"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr1 slc1 v1
</span><a href="#local-6989586621679495919"><span class="hs-identifier hs-var">unspreadm1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495901"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495899"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495897"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495893"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495893"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495892"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495892"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr2 slc2 v2
</span><a href="#local-6989586621679495913"><span class="hs-identifier hs-var">unspreadm2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495900"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495898"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495896"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495895"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495893"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495894"><span class="hs-identifier hs-var">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495892"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679495906"><span class="annot"><span class="annottext">unspreadl :: ((tr1, tr2), (slc1, slc2)) -&gt; (slc1, slc2) -&gt; [(tr1, tr2)]
</span><a href="#local-6989586621679495906"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679495891"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495891"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495890"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495890"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495889"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495889"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495888"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495888"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495887"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495887"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495886"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495886"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679495885"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495885"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadLeft tr1 slc1
</span><a href="#local-6989586621679495918"><span class="hs-identifier hs-var">unspreadl1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495891"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495889"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495887"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679495884"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495884"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadLeft tr2 slc2
</span><a href="#local-6989586621679495912"><span class="hs-identifier hs-var">unspreadl2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495890"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495888"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495886"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495885"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495884"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679495905"><span class="annot"><span class="annottext">unspreadr :: ((slc1, slc2), (tr1, tr2)) -&gt; (slc1, slc2) -&gt; [(tr1, tr2)]
</span><a href="#local-6989586621679495905"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679495883"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495883"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495882"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495882"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495881"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495881"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495880"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495880"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495879"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495879"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495878"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495878"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679495877"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495877"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadRight tr1 slc1
</span><a href="#local-6989586621679495917"><span class="hs-identifier hs-var">unspreadr1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495883"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495881"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495879"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679495876"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495876"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadRight tr2 slc2
</span><a href="#local-6989586621679495911"><span class="hs-identifier hs-var">unspreadr2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495882"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495880"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495878"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495877"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495876"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679495904"><span class="annot"><span class="annottext">merge :: StartStop (slc1, slc2)
-&gt; (tr1, tr2)
-&gt; (slc1, slc2)
-&gt; (tr1, tr2)
-&gt; StartStop (slc1, slc2)
-&gt; SplitType
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679495904"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621679495875"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495875"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495874"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495874"><span class="hs-identifier hs-var">tl1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495873"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495873"><span class="hs-identifier hs-var">tl2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495872"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495872"><span class="hs-identifier hs-var">sm1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495871"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495871"><span class="hs-identifier hs-var">sm2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495870"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495870"><span class="hs-identifier hs-var">tr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495869"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495869"><span class="hs-identifier hs-var">tr2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679495868"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495868"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679495867"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679495867"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495866"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495866"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495865"><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495865"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unsplit tr1 slc1 v1
</span><a href="#local-6989586621679495916"><span class="hs-identifier hs-var">merge1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495864"><span class="hs-identifier hs-var">sl1</span></a></span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495874"><span class="hs-identifier hs-var">tl1</span></a></span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679495872"><span class="hs-identifier hs-var">sm1</span></a></span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495870"><span class="hs-identifier hs-var">tr1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495863"><span class="hs-identifier hs-var">sr1</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679495867"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495862"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495862"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495861"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495861"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unsplit tr2 slc2 v2
</span><a href="#local-6989586621679495910"><span class="hs-identifier hs-var">merge2</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495860"><span class="hs-identifier hs-var">sl2</span></a></span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495873"><span class="hs-identifier hs-var">tl2</span></a></span><span> </span><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679495871"><span class="hs-identifier hs-var">sm2</span></a></span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495869"><span class="hs-identifier hs-var">tr2</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495859"><span class="hs-identifier hs-var">sr2</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679495867"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495866"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495862"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495865"><span class="hs-identifier hs-var">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495861"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495864"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495864"><span class="hs-identifier hs-var">sl1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495860"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495860"><span class="hs-identifier hs-var">sl2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495875"><span class="hs-identifier hs-var">sl</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495863"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495863"><span class="hs-identifier hs-var">sr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495859"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495859"><span class="hs-identifier hs-var">sr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495868"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679495903"><span class="annot"><span class="annottext">thaw :: StartStop (slc1, slc2)
-&gt; Maybe tr'
-&gt; StartStop (slc1, slc2)
-&gt; Bool
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679495903"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span id="local-6989586621679495858"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495858"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679495857"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679495857"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679495856"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495856"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679495855"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679495855"><span class="hs-identifier hs-var">isLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495854"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495854"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495853"><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495853"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StartStop slc1
-&gt; Maybe tr' -&gt; StartStop slc1 -&gt; Bool -&gt; [(tr1, v1)]
</span><a href="#local-6989586621679495915"><span class="hs-identifier hs-var">thaw1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495852"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679495857"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495851"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679495855"><span class="hs-identifier hs-var">isLast</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495850"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495850"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495849"><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495849"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StartStop slc2
-&gt; Maybe tr' -&gt; StartStop slc2 -&gt; Bool -&gt; [(tr2, v2)]
</span><a href="#local-6989586621679495909"><span class="hs-identifier hs-var">thaw2</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495848"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679495857"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495847"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679495855"><span class="hs-identifier hs-var">isLast</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679495854"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679495850"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v1
</span><a href="#local-6989586621679495853"><span class="hs-identifier hs-var">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v2
</span><a href="#local-6989586621679495849"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495852"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495852"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495848"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495848"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495858"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679495851"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679495851"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495847"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679495847"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679495856"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621679495902"><span class="annot"><span class="annottext">slice :: slc' -&gt; (slc1, slc2)
</span><a href="#local-6989586621679495902"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679495846"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679495846"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc' -&gt; slc1
</span><a href="#local-6989586621679495914"><span class="hs-identifier hs-var">slice1</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679495846"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc' -&gt; slc2
</span><a href="#local-6989586621679495908"><span class="hs-identifier hs-var">slice2</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679495846"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- restricting branching</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- ---------------------</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | A flag that is used to restrict spread operations to right branching.</span><span>
</span><span id="line-424"></span><span id="local-6989586621679495844"><span id="local-6989586621679495845"></span></span><span class="hs-keyword">data</span><span> </span><span id="RightBranchSpread"><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-var">RightBranchSpread</span></a></span></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RBBranches"><span class="annot"><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RBClear"><span class="annot"><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495838"><span id="local-6989586621679495840"><span class="annot"><span class="annottext">RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c/= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
== :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c== :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495819"><span id="local-6989586621679495821"><span id="local-6989586621679495824"><span id="local-6989586621679495827"><span id="local-6989586621679495830"><span id="local-6989586621679495832"><span id="local-6989586621679495834"><span class="annot"><span class="annottext">Eq RightBranchSpread
RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
$cmin :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
max :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
$cmax :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
&gt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&gt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&gt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&gt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&lt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&lt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&lt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&lt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
compare :: RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
$ccompare :: RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495813"><span id="local-6989586621679495815"><span id="local-6989586621679495817"><span class="annot"><span class="annottext">Int -&gt; RightBranchSpread -&gt; ShowS
[RightBranchSpread] -&gt; ShowS
RightBranchSpread -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RightBranchSpread] -&gt; ShowS
$cshowList :: [RightBranchSpread] -&gt; ShowS
show :: RightBranchSpread -&gt; String
$cshow :: RightBranchSpread -&gt; String
showsPrec :: Int -&gt; RightBranchSpread -&gt; ShowS
$cshowsPrec :: Int -&gt; RightBranchSpread -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep RightBranchSpread x -&gt; RightBranchSpread
forall x. RightBranchSpread -&gt; Rep RightBranchSpread x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep RightBranchSpread x -&gt; RightBranchSpread
$cfrom :: forall x. RightBranchSpread -&gt; Rep RightBranchSpread x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495809"><span class="annot"><span class="annottext">RightBranchSpread -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: RightBranchSpread -&gt; ()
$crnf :: RightBranchSpread -&gt; ()
</span><a href="#local-6989586621679495809"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495803"><span id="local-6989586621679495805"><span class="annot"><span class="annottext">Eq RightBranchSpread
Int -&gt; RightBranchSpread -&gt; Int
RightBranchSpread -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: RightBranchSpread -&gt; Int
$chash :: RightBranchSpread -&gt; Int
hashWithSalt :: Int -&gt; RightBranchSpread -&gt; Int
$chashWithSalt :: Int -&gt; RightBranchSpread -&gt; Int
</span><a href="#local-6989586621679495803"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">{- | An evaluator that doesn't parse the input but restricts spread operations to right branching.
 Legal combinations will just return a singleton @()@ while illegal combinations return nothing.
 Combine this with any evaluator as a product (using 'productEval' or 'rightBranchSpread')
 to make the evaluator right-branching.
-}</span><span>
</span><span id="line-434"></span><span id="local-6989586621679497334"><span id="local-6989586621679497335"><span class="annot"><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-type">evalRightBranchSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-type">RightBranchSpread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497335"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497334"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-435"></span><span id="evalRightBranchSpread"><span class="annot"><span class="annottext">evalRightBranchSpread :: forall tr' slc'. Eval RightBranchSpread tr' () slc' ()
</span><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-var hs-var">evalRightBranchSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
UnspreadMiddle tr slc v
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {c}. (a, RightBranchSpread, c) -&gt; Maybe ((), ())
</span><a href="#local-6989586621679495802"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p}. p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679495801"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p}. p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679495800"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p} {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679495799"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679495798"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p}. p -&gt; ()
</span><a href="#local-6989586621679495797"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-436"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679495802"><span class="annot"><span class="annottext">unspreadm :: (a, RightBranchSpread, c) -&gt; Maybe ((), ())
</span><a href="#local-6989586621679495802"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="#local-6989586621679495802"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621679495801"><span class="annot"><span class="annottext">unspreadl :: p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679495801"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621679495800"><span class="annot"><span class="annottext">unspreadr :: p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679495800"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621679495799"><span class="annot"><span class="annottext">merge :: p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679495799"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679495798"><span class="annot"><span class="annottext">thaw :: p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679495798"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span>  </span><span id="local-6989586621679495797"><span class="annot"><span class="annottext">slice :: p -&gt; ()
</span><a href="#local-6989586621679495797"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Restrict any evaluator to right-branching spreads.</span><span>
</span><span id="line-446"></span><span id="local-6989586621679497312"><span id="local-6989586621679497313"><span id="local-6989586621679497314"><span id="local-6989586621679497315"><span id="local-6989586621679497316"><span class="annot"><a href="Common.html#rightBranchSpread"><span class="hs-identifier hs-type">rightBranchSpread</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497316"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497315"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497314"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497313"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497312"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-type">RightBranchSpread</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497316"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497315"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497314"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497313"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497312"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span><span>
</span><span id="line-448"></span><span id="rightBranchSpread"><span class="annot"><span class="annottext">rightBranchSpread :: forall tr tr' slc slc' w.
Eval tr tr' slc slc' w
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' w
</span><a href="Common.html#rightBranchSpread"><span class="hs-identifier hs-var hs-var">rightBranchSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v w tr tr' slc slc'.
(v -&gt; w) -&gt; Eval tr tr' slc slc' v -&gt; Eval tr tr' slc slc' w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var">mapEvalScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall tr1 tr' slc1 slc' v1 tr2 slc2 v2.
Eval tr1 tr' slc1 slc' v1
-&gt; Eval tr2 tr' slc2 slc' v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var">productEval</span></a></span><span> </span><span class="annot"><span class="annottext">forall tr' slc'. Eval RightBranchSpread tr' () slc' ()
</span><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-var">evalRightBranchSpread</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">-- restricting derivation order</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- ----------------------------</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">{- | A flag for indicating whether a transition is the result of a split or not.
 This is used for restricting the order of splits and spreads.
-}</span><span>
</span><span id="line-456"></span><span id="local-6989586621679495795"><span id="local-6989586621679495796"></span></span><span class="hs-keyword">data</span><span> </span><span id="Merged"><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Merged"><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotMerged"><span class="annot"><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495789"><span id="local-6989586621679495791"><span class="annot"><span class="annottext">Merged -&gt; Merged -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Merged -&gt; Merged -&gt; Bool
$c/= :: Merged -&gt; Merged -&gt; Bool
== :: Merged -&gt; Merged -&gt; Bool
$c== :: Merged -&gt; Merged -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495770"><span id="local-6989586621679495772"><span id="local-6989586621679495775"><span id="local-6989586621679495778"><span id="local-6989586621679495781"><span id="local-6989586621679495783"><span id="local-6989586621679495785"><span class="annot"><span class="annottext">Eq Merged
Merged -&gt; Merged -&gt; Bool
Merged -&gt; Merged -&gt; Ordering
Merged -&gt; Merged -&gt; Merged
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Merged -&gt; Merged -&gt; Merged
$cmin :: Merged -&gt; Merged -&gt; Merged
max :: Merged -&gt; Merged -&gt; Merged
$cmax :: Merged -&gt; Merged -&gt; Merged
&gt;= :: Merged -&gt; Merged -&gt; Bool
$c&gt;= :: Merged -&gt; Merged -&gt; Bool
&gt; :: Merged -&gt; Merged -&gt; Bool
$c&gt; :: Merged -&gt; Merged -&gt; Bool
&lt;= :: Merged -&gt; Merged -&gt; Bool
$c&lt;= :: Merged -&gt; Merged -&gt; Bool
&lt; :: Merged -&gt; Merged -&gt; Bool
$c&lt; :: Merged -&gt; Merged -&gt; Bool
compare :: Merged -&gt; Merged -&gt; Ordering
$ccompare :: Merged -&gt; Merged -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495764"><span id="local-6989586621679495766"><span id="local-6989586621679495768"><span class="annot"><span class="annottext">Int -&gt; Merged -&gt; ShowS
[Merged] -&gt; ShowS
Merged -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Merged] -&gt; ShowS
$cshowList :: [Merged] -&gt; ShowS
show :: Merged -&gt; String
$cshow :: Merged -&gt; String
showsPrec :: Int -&gt; Merged -&gt; ShowS
$cshowsPrec :: Int -&gt; Merged -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep Merged x -&gt; Merged
forall x. Merged -&gt; Rep Merged x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Merged x -&gt; Merged
$cfrom :: forall x. Merged -&gt; Rep Merged x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495760"><span class="annot"><span class="annottext">Merged -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Merged -&gt; ()
$crnf :: Merged -&gt; ()
</span><a href="#local-6989586621679495760"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495754"><span id="local-6989586621679495756"><span class="annot"><span class="annottext">Eq Merged
Int -&gt; Merged -&gt; Int
Merged -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Merged -&gt; Int
$chash :: Merged -&gt; Int
hashWithSalt :: Int -&gt; Merged -&gt; Int
$chashWithSalt :: Int -&gt; Merged -&gt; Int
</span><a href="#local-6989586621679495754"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-comment">{- | An evaluator that doesn't parse the input but restricts the order of operations
 to always have splits before spreads on the left and right transitions at a spread.
 Legal combinations will just return a singleton @()@ while illegal combinations return nothing.
 Combine this with any evaluator as a product (using 'productEval' or 'splitFirst')
 to make the evaluator order-restricted.
-}</span><span>
</span><span id="line-467"></span><span id="local-6989586621679497303"><span id="local-6989586621679497304"><span class="annot"><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-type">evalSplitBeforeSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-type">Merged</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497304"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497303"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-468"></span><span id="evalSplitBeforeSpread"><span class="annot"><span class="annottext">evalSplitBeforeSpread :: forall tr' slc'. Eval Merged tr' () slc' ()
</span><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-var hs-var">evalSplitBeforeSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
UnspreadMiddle tr slc v
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p}. p -&gt; Maybe ((), ())
</span><a href="#local-6989586621679495753"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b} {p}. (Merged, b) -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679495752"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {p}. (a, Merged) -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679495751"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p} {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679495750"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p} {p} {p} {p}. p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679495749"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">forall {p}. p -&gt; ()
</span><a href="#local-6989586621679495748"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-469"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679495753"><span class="annot"><span class="annottext">unspreadm :: p -&gt; Maybe ((), ())
</span><a href="#local-6989586621679495753"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679495752"><span class="annot"><span class="annottext">unspreadl :: (Merged, b) -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679495752"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><a href="#local-6989586621679495752"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679495751"><span class="annot"><span class="annottext">unspreadr :: (a, Merged) -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679495751"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><a href="#local-6989586621679495751"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621679495750"><span class="annot"><span class="annottext">merge :: p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679495750"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679495749"><span class="annot"><span class="annottext">thaw :: p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679495749"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679495748"><span class="annot"><span class="annottext">slice :: p -&gt; ()
</span><a href="#local-6989586621679495748"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | Restrict any evaluator to split-before-spread order.</span><span>
</span><span id="line-480"></span><span id="local-6989586621679497282"><span id="local-6989586621679497283"><span id="local-6989586621679497284"><span id="local-6989586621679497285"><span id="local-6989586621679497286"><span class="annot"><a href="Common.html#splitFirst"><span class="hs-identifier hs-type">splitFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497286"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497285"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497284"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497283"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497282"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-type">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497286"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497285"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497284"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679497283"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497282"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span><span>
</span><span id="line-481"></span><span id="splitFirst"><span class="annot"><span class="annottext">splitFirst :: forall tr tr' slc slc' w.
Eval tr tr' slc slc' w -&gt; Eval (Merged, tr) tr' ((), slc) slc' w
</span><a href="Common.html#splitFirst"><span class="hs-identifier hs-var hs-var">splitFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v w tr tr' slc slc'.
(v -&gt; w) -&gt; Eval tr tr' slc slc' v -&gt; Eval tr tr' slc slc' w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var">mapEvalScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall tr1 tr' slc1 slc' v1 tr2 slc2 v2.
Eval tr1 tr' slc1 slc' v1
-&gt; Eval tr2 tr' slc2 slc' v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var">productEval</span></a></span><span> </span><span class="annot"><span class="annottext">forall tr' slc'. Eval Merged tr' () slc' ()
</span><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-var">evalSplitBeforeSpread</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- left-most derivation outer operations</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- =====================================</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">{- $leftmostdoc

 More specifically, if there is only one open transition left, only two actions are possible,
 freezing or splitting that transition:

 &gt; freeze only:   split only:
 &gt; ...=[]&#8212;&#8212;&#8905;      ==[]&#8212;&#8212;&#8905;
 &gt; ...=[]==&#8905;         \  /
 &gt;                     []

 These options are encoded in 'LeftmostSingle'.

 If two or more transitions are still open, four actions are possible:

 &gt; freeze left:         split left:          split right:         spread:
 &gt; ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...
 &gt; ...=[]==[]&#8212;&#8212;[]&#8212;...        \  /                     \  /             \  /\  /
 &gt;                            []                       []               []&#8212;&#8212;[]

 These options are encoded in 'LeftmostDouble'.
 Note that the order of operations is restricted so that after a right split only
 only another right split or a spread are allowed.
 See [below](#monadicDeriv) for a way to construct leftmost derivations in a type-safe way,
 checking operation order and open transitions at compile time.

 Both single and double operations are combined in 'Leftmost'.
 All three operation containers are parameterized over the specific operations types for
 splits (@s@), spreads (@h@ for &quot;horizontalization&quot;), freezes (@f@).
-}</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Generative operations on a single transition (split or freeze).</span><span>
</span><span id="line-517"></span><span id="local-6989586621679495746"><span id="local-6989586621679495747"></span></span><span class="hs-keyword">data</span><span> </span><span id="LeftmostSingle"><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-var">LeftmostSingle</span></a></span></span><span> </span><span id="local-6989586621679497274"><span class="annot"><a href="#local-6989586621679497274"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497273"><span class="annot"><a href="#local-6989586621679497273"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMSingleSplit"><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-var">LMSingleSplit</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497274"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMSingleFreeze"><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-var">LMSingleFreeze</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497273"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495738"><span id="local-6989586621679495742"><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
/= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c/= :: forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
== :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c== :: forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495715"><span id="local-6989586621679495717"><span id="local-6989586621679495720"><span id="local-6989586621679495723"><span id="local-6989586621679495726"><span id="local-6989586621679495730"><span id="local-6989586621679495734"><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {s} {f}. (Ord s, Ord f) =&gt; Eq (LeftmostSingle s f)
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
min :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
$cmin :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
max :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
$cmax :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
&gt;= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&gt;= :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&gt; :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&gt; :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&lt;= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&lt;= :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&lt; :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&lt; :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
compare :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
$ccompare :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495705"><span id="local-6989586621679495707"><span id="local-6989586621679495713"><span class="annot"><span class="annottext">Int -&gt; LeftmostSingle s f -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f. (Show s, Show f) =&gt; Int -&gt; LeftmostSingle s f -&gt; ShowS
forall s f. (Show s, Show f) =&gt; [LeftmostSingle s f] -&gt; ShowS
forall s f. (Show s, Show f) =&gt; LeftmostSingle s f -&gt; String
showList :: [LeftmostSingle s f] -&gt; ShowS
$cshowList :: forall s f. (Show s, Show f) =&gt; [LeftmostSingle s f] -&gt; ShowS
show :: LeftmostSingle s f -&gt; String
$cshow :: forall s f. (Show s, Show f) =&gt; LeftmostSingle s f -&gt; String
showsPrec :: Int -&gt; LeftmostSingle s f -&gt; ShowS
$cshowsPrec :: forall s f. (Show s, Show f) =&gt; Int -&gt; LeftmostSingle s f -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
forall s f x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
$cto :: forall s f x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
$cfrom :: forall s f x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495701"><span class="annot"><span class="annottext">forall a. (a -&gt; ()) -&gt; NFData a
forall s f. (NFData s, NFData f) =&gt; LeftmostSingle s f -&gt; ()
rnf :: LeftmostSingle s f -&gt; ()
$crnf :: forall s f. (NFData s, NFData f) =&gt; LeftmostSingle s f -&gt; ()
</span><a href="#local-6989586621679495701"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495697"><span id="local-6989586621679495699"><span class="annot"><span class="annottext">forall a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
forall a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
forall s a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
forall s a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
$c&lt;$ :: forall s a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
fmap :: forall a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
$cfmap :: forall s a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495660"><span id="local-6989586621679495662"><span id="local-6989586621679495664"><span id="local-6989586621679495666"><span id="local-6989586621679495668"><span id="local-6989586621679495670"><span id="local-6989586621679495672"><span id="local-6989586621679495674"><span id="local-6989586621679495676"><span id="local-6989586621679495678"><span id="local-6989586621679495680"><span id="local-6989586621679495682"><span id="local-6989586621679495684"><span id="local-6989586621679495686"><span id="local-6989586621679495688"><span id="local-6989586621679495692"><span id="local-6989586621679495694"><span class="annot"><span class="annottext">forall a. LeftmostSingle s a -&gt; Bool
forall s a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
forall s m. Monoid m =&gt; LeftmostSingle s m -&gt; m
forall s a. LeftmostSingle s a -&gt; Bool
forall s a. LeftmostSingle s a -&gt; Int
forall s a. LeftmostSingle s a -&gt; [a]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: forall a. Num a =&gt; LeftmostSingle s a -&gt; a
$cproduct :: forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
sum :: forall a. Num a =&gt; LeftmostSingle s a -&gt; a
$csum :: forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
minimum :: forall a. Ord a =&gt; LeftmostSingle s a -&gt; a
$cminimum :: forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
maximum :: forall a. Ord a =&gt; LeftmostSingle s a -&gt; a
$cmaximum :: forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
elem :: forall a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
$celem :: forall s a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
length :: forall a. LeftmostSingle s a -&gt; Int
$clength :: forall s a. LeftmostSingle s a -&gt; Int
null :: forall a. LeftmostSingle s a -&gt; Bool
$cnull :: forall s a. LeftmostSingle s a -&gt; Bool
toList :: forall a. LeftmostSingle s a -&gt; [a]
$ctoList :: forall s a. LeftmostSingle s a -&gt; [a]
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
$cfoldl1 :: forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
$cfoldr1 :: forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldl' :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldl :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldr' :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldr :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
$cfoldMap' :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
$cfoldMap :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
fold :: forall m. Monoid m =&gt; LeftmostSingle s m -&gt; m
$cfold :: forall s m. Monoid m =&gt; LeftmostSingle s m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495644"><span id="local-6989586621679495646"><span id="local-6989586621679495648"><span id="local-6989586621679495654"><span class="annot"><span class="annottext">forall s. Functor (LeftmostSingle s)
forall s. Foldable (LeftmostSingle s)
forall s (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
forall s (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
$csequence :: forall s (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
$cmapM :: forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
$csequenceA :: forall s (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
$ctraverse :: forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679495638"><span id="local-6989586621679495640"><span id="local-6989586621679497266"><span id="local-6989586621679497267"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497267"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497266"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497267"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497266"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621679495553"><span class="annot"><span class="annottext">toJSON :: LeftmostSingle s f -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.genericToJSON</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Only&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679495482"><span class="annot"><span class="annottext">toEncoding :: LeftmostSingle s f -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-527"></span><span>      </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Only&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-comment">-- | Generative operations on two transitions (split left, freeze left, split right, or spread)</span><span>
</span><span id="line-530"></span><span id="local-6989586621679495478"><span id="local-6989586621679495479"></span></span><span class="hs-keyword">data</span><span> </span><span id="LeftmostDouble"><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-var">LeftmostDouble</span></a></span></span><span> </span><span id="local-6989586621679497148"><span class="annot"><a href="#local-6989586621679497148"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497147"><span class="annot"><a href="#local-6989586621679497147"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679497146"><span class="annot"><a href="#local-6989586621679497146"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMDoubleSplitLeft"><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-var">LMDoubleSplitLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497148"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleFreezeLeft"><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-var">LMDoubleFreezeLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497147"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleSplitRight"><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-var">LMDoubleSplitRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497148"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleSpread"><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-var">LMDoubleSpread</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679497146"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495466"><span id="local-6989586621679495472"><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h.
(Eq s, Eq f, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
/= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c/= :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
== :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c== :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495446"><span id="local-6989586621679495448"><span id="local-6989586621679495450"><span id="local-6989586621679495452"><span id="local-6989586621679495454"><span id="local-6989586621679495456"><span id="local-6989586621679495462"><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {s} {f} {h}.
(Ord s, Ord f, Ord h) =&gt;
Eq (LeftmostDouble s f h)
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
min :: LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
$cmin :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
max :: LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
$cmax :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
&gt;= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&gt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&gt; :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&gt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&lt;= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&lt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&lt; :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&lt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
compare :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
$ccompare :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495432"><span id="local-6989586621679495434"><span id="local-6989586621679495444"><span class="annot"><span class="annottext">Int -&gt; LeftmostDouble s f h -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; LeftmostDouble s f h -&gt; ShowS
forall s f h.
(Show s, Show f, Show h) =&gt;
[LeftmostDouble s f h] -&gt; ShowS
forall s f h.
(Show s, Show f, Show h) =&gt;
LeftmostDouble s f h -&gt; String
showList :: [LeftmostDouble s f h] -&gt; ShowS
$cshowList :: forall s f h.
(Show s, Show f, Show h) =&gt;
[LeftmostDouble s f h] -&gt; ShowS
show :: LeftmostDouble s f h -&gt; String
$cshow :: forall s f h.
(Show s, Show f, Show h) =&gt;
LeftmostDouble s f h -&gt; String
showsPrec :: Int -&gt; LeftmostDouble s f h -&gt; ShowS
$cshowsPrec :: forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; LeftmostDouble s f h -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h x.
Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
forall s f h x.
LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
$cto :: forall s f h x.
Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
$cfrom :: forall s f h x.
LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495428"><span class="annot"><span class="annottext">forall a. (a -&gt; ()) -&gt; NFData a
forall s f h.
(NFData s, NFData f, NFData h) =&gt;
LeftmostDouble s f h -&gt; ()
rnf :: LeftmostDouble s f h -&gt; ()
$crnf :: forall s f h.
(NFData s, NFData f, NFData h) =&gt;
LeftmostDouble s f h -&gt; ()
</span><a href="#local-6989586621679495428"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | Helper function for `LeftmostDouble`'s 'ToJSON' instance.</span><span>
</span><span id="line-538"></span><span id="lmDoubleToJSONName"><span class="annot"><span class="annottext">lmDoubleToJSONName :: ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var hs-var">lmDoubleToJSONName</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LMDoubleSpread&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hori&quot;</span></span><span>
</span><span id="line-539"></span><span class="annot"><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span> </span><span id="local-6989586621679495421"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679495421"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679495421"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679495415"><span id="local-6989586621679495417"><span id="local-6989586621679497143"><span id="local-6989586621679497144"><span id="local-6989586621679497145"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497145"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497144"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497143"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497145"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497144"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497143"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-542"></span><span>  </span><span id="local-6989586621679495308"><span class="annot"><span class="annottext">toJSON :: LeftmostDouble s f h -&gt; Value
</span><a href="#local-6989586621679495308"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.genericToJSON</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679495200"><span class="annot"><span class="annottext">toEncoding :: LeftmostDouble s f h -&gt; Encoding
</span><a href="#local-6989586621679495200"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-comment">-- | A combined datatype for all leftmost-derivation operations.</span><span>
</span><span id="line-547"></span><span id="local-6989586621679495198"><span id="local-6989586621679495199"></span></span><span class="hs-keyword">data</span><span> </span><span id="Leftmost"><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-var">Leftmost</span></a></span></span><span> </span><span id="local-6989586621679497139"><span class="annot"><a href="#local-6989586621679497139"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497138"><span class="annot"><a href="#local-6989586621679497138"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679497137"><span class="annot"><a href="#local-6989586621679497137"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMSingle"><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497139"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497138"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDouble"><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497139"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497138"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497137"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495192"><span id="local-6989586621679495196"><span class="annot"><span class="annottext">Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
/= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c/= :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
== :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c== :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495169"><span id="local-6989586621679495171"><span id="local-6989586621679495174"><span id="local-6989586621679495177"><span id="local-6989586621679495180"><span id="local-6989586621679495184"><span id="local-6989586621679495188"><span class="annot"><span class="annottext">Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {s} {f} {h}. (Ord s, Ord f, Ord h) =&gt; Eq (Leftmost s f h)
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
min :: Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
$cmin :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
max :: Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
$cmax :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
&gt;= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&gt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&gt; :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&gt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&lt;= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&lt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&lt; :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&lt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
compare :: Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
$ccompare :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495159"><span id="local-6989586621679495161"><span id="local-6989586621679495167"><span class="annot"><span class="annottext">Int -&gt; Leftmost s f h -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; Leftmost s f h -&gt; ShowS
forall s f h. (Show s, Show f, Show h) =&gt; [Leftmost s f h] -&gt; ShowS
forall s f h. (Show s, Show f, Show h) =&gt; Leftmost s f h -&gt; String
showList :: [Leftmost s f h] -&gt; ShowS
$cshowList :: forall s f h. (Show s, Show f, Show h) =&gt; [Leftmost s f h] -&gt; ShowS
show :: Leftmost s f h -&gt; String
$cshow :: forall s f h. (Show s, Show f, Show h) =&gt; Leftmost s f h -&gt; String
showsPrec :: Int -&gt; Leftmost s f h -&gt; ShowS
$cshowsPrec :: forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; Leftmost s f h -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
forall s f h x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
$cto :: forall s f h x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
$cfrom :: forall s f h x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495155"><span class="annot"><span class="annottext">forall a. (a -&gt; ()) -&gt; NFData a
forall s f h.
(NFData s, NFData f, NFData h) =&gt;
Leftmost s f h -&gt; ()
rnf :: Leftmost s f h -&gt; ()
$crnf :: forall s f h.
(NFData s, NFData f, NFData h) =&gt;
Leftmost s f h -&gt; ()
</span><a href="#local-6989586621679495155"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679495152"><span id="local-6989586621679497134"><span id="local-6989586621679497135"><span id="local-6989586621679497136"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497136"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497135"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497134"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497136"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497135"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497134"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621679495116"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Leftmost s f h)
</span><a href="#local-6989586621679495116"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Leftmost&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679495114"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679495114"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621679495113"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495113"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679495114"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621679495112"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679495114"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495113"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;freezeLeft&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;freezeOnly&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitLeft&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-560"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitRight&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-561"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitOnly&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-562"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;hori&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495112"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-comment">-- the JSON encoding uses &quot;hori&quot; instead of &quot;spread&quot;</span><span>
</span><span id="line-563"></span><span>      </span><span id="local-6989586621679495111"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495111"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Value -&gt; Parser a
</span><span class="hs-identifier hs-var">unexpected</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679495111"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679495105"><span id="local-6989586621679495107"><span id="local-6989586621679497117"><span id="local-6989586621679497118"><span id="local-6989586621679497119"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497119"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497118"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497117"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497119"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497118"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497117"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-566"></span><span>  </span><span id="local-6989586621679495102"><span class="annot"><span class="annottext">toJSON :: Leftmost s f h -&gt; Value
</span><a href="#local-6989586621679495102"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679495101"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679495101"><span class="hs-identifier hs-var">sg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679495101"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679495100"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679495100"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679495100"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span id="local-6989586621679495097"><span class="annot"><span class="annottext">toEncoding :: Leftmost s f h -&gt; Encoding
</span><a href="#local-6989586621679495097"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679495096"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679495096"><span class="hs-identifier hs-var">sg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679495096"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679495095"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679495095"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679495095"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-type">LMSplitLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497124"><span id="local-6989586621679497125"><span id="local-6989586621679497126"><span class="annot"><a href="#local-6989586621679497126"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497126"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497125"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497124"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-572"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMSplitLeft"><span id="%24mLMSplitLeft"><span id="LMSplitLeft"><span class="annot"><span class="annottext">$bLMSplitLeft :: forall s f h. s -&gt; Leftmost s f h
$mLMSplitLeft :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMSplitLeft"><span class="hs-identifier hs-var hs-var hs-var">LMSplitLeft</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495092"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span id="local-6989586621679495092"><span class="annot"><a href="#local-6989586621679495092"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-type">LMFreezeLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497127"><span id="local-6989586621679497128"><span id="local-6989586621679497129"><span class="annot"><a href="#local-6989586621679497129"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497128"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497129"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497127"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-575"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMFreezeLeft"><span id="%24mLMFreezeLeft"><span id="LMFreezeLeft"><span class="annot"><span class="annottext">$bLMFreezeLeft :: forall f s h. f -&gt; Leftmost s f h
$mLMFreezeLeft :: forall {r} {f} {s} {h}.
Leftmost s f h -&gt; (f -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMFreezeLeft"><span class="hs-identifier hs-var hs-var hs-var">LMFreezeLeft</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495089"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span id="local-6989586621679495089"><span class="annot"><a href="#local-6989586621679495089"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-type">LMSplitRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497106"><span id="local-6989586621679497107"><span id="local-6989586621679497108"><span class="annot"><a href="#local-6989586621679497108"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497108"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497107"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497106"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-578"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMSplitRight"><span id="%24mLMSplitRight"><span id="LMSplitRight"><span class="annot"><span class="annottext">$bLMSplitRight :: forall s f h. s -&gt; Leftmost s f h
$mLMSplitRight :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMSplitRight"><span class="hs-identifier hs-var hs-var hs-var">LMSplitRight</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495086"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-type">LMDoubleSplitRight</span></a></span><span> </span><span id="local-6989586621679495086"><span class="annot"><a href="#local-6989586621679495086"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-identifier hs-type">LMSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497121"><span id="local-6989586621679497122"><span id="local-6989586621679497123"><span class="annot"><a href="#local-6989586621679497123"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497122"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497121"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497123"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-581"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMSpread"><span id="%24mLMSpread"><span id="LMSpread"><span class="annot"><span class="annottext">$bLMSpread :: forall h s f. h -&gt; Leftmost s f h
$mLMSpread :: forall {r} {h} {s} {f}.
Leftmost s f h -&gt; (h -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMSpread"><span class="hs-identifier hs-var hs-var hs-var">LMSpread</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495083"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-type">LMDoubleSpread</span></a></span><span> </span><span id="local-6989586621679495083"><span class="annot"><a href="#local-6989586621679495083"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-type">LMSplitOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497098"><span id="local-6989586621679497099"><span id="local-6989586621679497100"><span class="annot"><a href="#local-6989586621679497100"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497100"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497099"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497098"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-584"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMSplitOnly"><span id="%24mLMSplitOnly"><span id="LMSplitOnly"><span class="annot"><span class="annottext">$bLMSplitOnly :: forall s f h. s -&gt; Leftmost s f h
$mLMSplitOnly :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMSplitOnly"><span class="hs-identifier hs-var hs-var hs-var">LMSplitOnly</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495080"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span id="local-6989586621679495080"><span class="annot"><a href="#local-6989586621679495080"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-type">LMFreezeOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679497093"><span id="local-6989586621679497094"><span id="local-6989586621679497095"><span class="annot"><a href="#local-6989586621679497094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497095"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497093"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-587"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bLMFreezeOnly"><span id="%24mLMFreezeOnly"><span id="LMFreezeOnly"><span class="annot"><span class="annottext">$bLMFreezeOnly :: forall f s h. f -&gt; Leftmost s f h
$mLMFreezeOnly :: forall {r} {f} {s} {h}.
Leftmost s f h -&gt; (f -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Common.html#%24bLMFreezeOnly"><span class="hs-identifier hs-var hs-var hs-var">LMFreezeOnly</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679495077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span id="local-6989586621679495077"><span class="annot"><a href="#local-6989586621679495077"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-pragma hs-type">LMSplitLeft</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-pragma hs-type">LMFreezeLeft</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-pragma hs-type">LMSplitRight</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-pragma hs-type">LMSpread</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-pragma hs-type">LMSplitOnly</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-pragma hs-type">LMFreezeOnly</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-comment">-- representing full analyses</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- ==========================</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">{- | Encodes an analysis of a piece,
 consisting of a &quot;top&quot; (the starting point of the derivation,
 i.e., the smallest reduction in the analysis)
 and a derivation of the piece's surface from the top.

 Use this type's 'FromJSON' instance to load an analysis exported by the protovoice annotation tool.
-}</span><span>
</span><span id="line-601"></span><span id="local-6989586621679495075"><span id="local-6989586621679495076"></span></span><span class="hs-keyword">data</span><span> </span><span id="Analysis"><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span></span><span> </span><span id="local-6989586621679497087"><span class="annot"><a href="#local-6989586621679497087"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497086"><span class="annot"><a href="#local-6989586621679497086"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679497085"><span class="annot"><a href="#local-6989586621679497085"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679497084"><span class="annot"><a href="#local-6989586621679497084"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679497083"><span class="annot"><a href="#local-6989586621679497083"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Analysis"><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="anaDerivation"><span class="annot"><span class="annottext">forall s f h tr slc. Analysis s f h tr slc -&gt; [Leftmost s f h]
</span><a href="Common.html#anaDerivation"><span class="hs-identifier hs-var hs-var">anaDerivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497087"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497086"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497085"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-comment">-- ^ The derivation steps.</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="anaTop"><span class="annot"><span class="annottext">forall s f h tr slc. Analysis s f h tr slc -&gt; Path tr slc
</span><a href="Common.html#anaTop"><span class="hs-identifier hs-var hs-var">anaTop</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497084"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497083"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-comment">-- ^ The starting configuration of the derivation.</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-comment">-- Starts with the first transition, 'Start' and 'Stop' are implied.</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679495065"><span id="local-6989586621679495070"><span class="annot"><span class="annottext">Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq tr, Eq slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
/= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c/= :: forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq tr, Eq slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
== :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c== :: forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq tr, Eq slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495039"><span id="local-6989586621679495041"><span id="local-6989586621679495044"><span id="local-6989586621679495047"><span id="local-6989586621679495050"><span id="local-6989586621679495055"><span id="local-6989586621679495061"><span class="annot"><span class="annottext">Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {s} {f} {h} {tr} {slc}.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Eq (Analysis s f h tr slc)
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
min :: Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
$cmin :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
max :: Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
$cmax :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
&gt;= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&gt;= :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&gt; :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&gt; :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&lt;= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&lt;= :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&lt; :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&lt; :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
compare :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
$ccompare :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord tr, Ord slc) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679495028"><span id="local-6989586621679495030"><span id="local-6989586621679495037"><span class="annot"><span class="annottext">Int -&gt; Analysis s f h tr slc -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Int -&gt; Analysis s f h tr slc -&gt; ShowS
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
[Analysis s f h tr slc] -&gt; ShowS
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Analysis s f h tr slc -&gt; String
showList :: [Analysis s f h tr slc] -&gt; ShowS
$cshowList :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
[Analysis s f h tr slc] -&gt; ShowS
show :: Analysis s f h tr slc -&gt; String
$cshow :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Analysis s f h tr slc -&gt; String
showsPrec :: Int -&gt; Analysis s f h tr slc -&gt; ShowS
$cshowsPrec :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Int -&gt; Analysis s f h tr slc -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h tr slc x.
Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
forall s f h tr slc x.
Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
$cto :: forall s f h tr slc x.
Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
$cfrom :: forall s f h tr slc x.
Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679495022"><span id="local-6989586621679497066"><span id="local-6989586621679497067"><span id="local-6989586621679497068"><span id="local-6989586621679497069"><span id="local-6989586621679497070"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497070"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497069"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497068"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497067"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679497066"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497070"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497069"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497068"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497067"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497066"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679494990"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Analysis s f h tr slc)
</span><a href="#local-6989586621679494990"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Analysis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679494989"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494989"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679494988"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494988"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494989"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;derivation&quot;</span></span><span>
</span><span id="line-613"></span><span>    </span><span id="local-6989586621679494987"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494987"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494989"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;start&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (StartStop slc)
</span><a href="#local-6989586621679494986"><span class="hs-identifier hs-var">parseSlice</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494987"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>      </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Start slice is not &#8906;.&quot;</span></span><span>
</span><span id="line-617"></span><span>    </span><span id="local-6989586621679494985"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679494985"><span class="hs-identifier hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494989"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;topSegments&quot;</span></span><span>
</span><span id="line-618"></span><span>    </span><span id="local-6989586621679494984"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494984"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Parser (Path tr slc)
</span><a href="#local-6989586621679494983"><span class="hs-identifier hs-var">parseTop</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679494985"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">anaDerivation :: [Leftmost s f h]
</span><a href="Common.html#anaDerivation"><span class="hs-identifier hs-var">anaDerivation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494988"><span class="hs-identifier hs-var">deriv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">anaTop :: Path tr slc
</span><a href="Common.html#anaTop"><span class="hs-identifier hs-var">anaTop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494984"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-620"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><a href="#local-6989586621679494983"><span class="hs-identifier hs-type">parseTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497067"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497066"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621679494983"><span class="annot"><span class="annottext">parseTop :: [Value] -&gt; Parser (Path tr slc)
</span><a href="#local-6989586621679494983"><span class="hs-identifier hs-var hs-var">parseTop</span></a></span></span><span> </span><span id="local-6989586621679494982"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679494982"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-623"></span><span>      </span><span id="local-6989586621679494981"><span class="annot"><span class="annottext">[(tr, StartStop slc)]
</span><a href="#local-6989586621679494981"><span class="hs-identifier hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (tr, StartStop slc)
</span><a href="#local-6989586621679494979"><span class="hs-identifier hs-var">parseSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679494982"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-624"></span><span>      </span><span class="annot"><span class="annottext">forall e a. [(e, StartStop a)] -&gt; Parser (Path e a)
</span><a href="#local-6989586621679494978"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, StartStop slc)]
</span><a href="#local-6989586621679494981"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-625"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-626"></span><span>      </span><span id="local-6989586621679497058"><span id="local-6989586621679497059"><span class="annot"><a href="#local-6989586621679494978"><span class="hs-identifier hs-type">mkPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497059"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497058"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497059"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497058"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-627"></span><span>      </span><span id="local-6989586621679494978"><span class="annot"><span class="annottext">mkPath :: forall e a. [(e, StartStop a)] -&gt; Parser (Path e a)
</span><a href="#local-6989586621679494978"><span class="hs-identifier hs-var hs-var">mkPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679494974"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679494974"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679494974"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-628"></span><span>      </span><span class="annot"><a href="#local-6989586621679494978"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679494973"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679494973"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679494972"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494972"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679494971"><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><a href="#local-6989586621679494971"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679494973"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494972"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall e a. [(e, StartStop a)] -&gt; Parser (Path e a)
</span><a href="#local-6989586621679494978"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><a href="#local-6989586621679494971"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-629"></span><span>      </span><span class="annot"><a href="#local-6989586621679494978"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid top path.&quot;</span></span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621679494986"><span class="annot"><span class="annottext">parseSlice :: Value -&gt; Parser (StartStop slc)
</span><a href="#local-6989586621679494986"><span class="hs-identifier hs-var hs-var">parseSlice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Slice&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679494968"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494968"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494968"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621679494965"><span class="annot"><span class="annottext">parseTrans :: Value -&gt; Parser tr
</span><a href="#local-6989586621679494965"><span class="hs-identifier hs-var hs-var">parseTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Transition&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679494964"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494964"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494964"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;edges&quot;</span></span><span>
</span><span id="line-632"></span><span>    </span><span id="local-6989586621679494979"><span class="annot"><span class="annottext">parseSegment :: Value -&gt; Parser (tr, StartStop slc)
</span><a href="#local-6989586621679494979"><span class="hs-identifier hs-var hs-var">parseSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Segment&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679494963"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494963"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-633"></span><span>      </span><span id="local-6989586621679494962"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494962"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494963"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;trans&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser tr
</span><a href="#local-6989586621679494965"><span class="hs-identifier hs-var">parseTrans</span></a></span><span>
</span><span id="line-634"></span><span>      </span><span id="local-6989586621679494961"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494961"><span class="hs-identifier hs-var">rslice</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679494963"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;rslice&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (StartStop slc)
</span><a href="#local-6989586621679494986"><span class="hs-identifier hs-var">parseSlice</span></a></span><span>
</span><span id="line-635"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494962"><span class="hs-identifier hs-var">trans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494961"><span class="hs-identifier hs-var">rslice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | Prints the steps and intermediate configurations of a derivation.</span><span>
</span><span id="line-638"></span><span class="annot"><a href="Common.html#debugAnalysis"><span class="hs-identifier hs-type">debugAnalysis</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679497055"><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679497054"><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679497053"><span class="annot"><a href="#local-6989586621679497053"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497051"><span class="annot"><a href="#local-6989586621679497051"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679497052"><span class="annot"><a href="#local-6989586621679497052"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-640"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497053"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679497052"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497053"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497051"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497052"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497053"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497051"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497052"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span id="debugAnalysis"><span class="annot"><span class="annottext">debugAnalysis :: forall tr slc s f h.
(Show tr, Show slc, Show s, Show h) =&gt;
(s -&gt; tr -&gt; Either String (tr, slc, tr))
-&gt; (f -&gt; tr -&gt; Either String tr)
-&gt; (h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr))
-&gt; Analysis s f h tr slc
-&gt; IO (Either String ())
</span><a href="Common.html#debugAnalysis"><span class="hs-identifier hs-var hs-var">debugAnalysis</span></a></span></span><span> </span><span id="local-6989586621679494875"><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679494875"><span class="hs-identifier hs-var">doSplit</span></a></span></span><span> </span><span id="local-6989586621679494874"><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679494874"><span class="hs-identifier hs-var">doFreeze</span></a></span></span><span> </span><span id="local-6989586621679494873"><span class="annot"><span class="annottext">h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr)
</span><a href="#local-6989586621679494873"><span class="hs-identifier hs-var">doSpread</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span id="local-6989586621679494872"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494872"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span id="local-6989586621679494871"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494871"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494871"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494872"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-649"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-650"></span><span>  </span><span class="annot"><a href="#local-6989586621679494870"><span class="hs-identifier hs-type">go</span></a></span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497055"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497054"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497053"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497051"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497052"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621679494870"><span class="annot"><span class="annottext">go :: StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679494869"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494869"><span class="hs-identifier hs-var">_sl</span></a></span></span><span> </span><span id="local-6989586621679494868"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494868"><span class="hs-identifier hs-var">_surface</span></a></span></span><span> </span><span id="local-6989586621679494867"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494867"><span class="hs-identifier hs-var">_ars</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Derivation incomplete.&quot;</span></span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494866"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494866"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679494865"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679494865"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679494864"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494864"><span class="hs-identifier hs-var">trans</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679494863"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494863"><span class="hs-identifier hs-var">_ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494862"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494862"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679494861"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494861"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494865"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494862"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679494859"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679494859"><span class="hs-identifier hs-var">single</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>        </span><span class="hs-comment">-- debugSingleStep (sl, trans, Stop) single</span><span>
</span><span id="line-662"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679494859"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-663"></span><span>          </span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span id="local-6989586621679494858"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494858"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-664"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;freezing only (terminating)&quot;</span></span><span>
</span><span id="line-665"></span><span>            </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679494874"><span class="hs-identifier hs-var">doFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494858"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494864"><span class="hs-identifier hs-var">trans</span></a></span><span>
</span><span id="line-666"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>          </span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span id="local-6989586621679494857"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494857"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-668"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting only: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494857"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-669"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679494856"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494856"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494855"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494855"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494854"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494854"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679494875"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494857"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494864"><span class="hs-identifier hs-var">trans</span></a></span><span>
</span><span id="line-670"></span><span>            </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494866"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494856"><span class="hs-identifier hs-var">ctl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494855"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494854"><span class="hs-identifier hs-var">ctr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494861"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Double operation on single transition.&quot;</span></span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494853"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494853"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679494852"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679494852"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679494851"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494851"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679494850"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494850"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679494849"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494849"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679494848"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494848"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494847"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494847"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679494846"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494846"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494852"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><span class="annottext">Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494845"><span class="hs-identifier hs-var">goDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494847"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494846"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494848"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494853"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494851"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494850"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494849"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span>
</span><span id="line-675"></span><span>  </span><span class="annot"><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494844"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494844"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679494843"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679494843"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679494842"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494842"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679494841"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494841"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679494840"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494840"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679494839"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494839"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679494838"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494838"><span class="hs-identifier hs-var">pathRest</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679494837"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494837"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494836"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494836"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679494835"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494835"><span class="hs-identifier hs-var">derivRest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494843"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span class="annot"><span class="annottext">Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494845"><span class="hs-identifier hs-var">goDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494836"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494835"><span class="hs-identifier hs-var">derivRest</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494837"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494844"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494842"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494841"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494840"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494839"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679494834"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494834"><span class="hs-identifier hs-var">tr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494834"><span class="hs-identifier hs-var">tr'</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494839"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679494838"><span class="hs-identifier hs-var">pathRest</span></a></span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span>  </span><span id="local-6989586621679494845"><span class="annot"><span class="annottext">goDouble :: Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494845"><span class="hs-identifier hs-var hs-var">goDouble</span></a></span></span><span> </span><span id="local-6989586621679494833"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494833"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679494832"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494832"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span id="local-6989586621679494831"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494831"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494830"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494830"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494829"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494829"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494828"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494828"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494827"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494827"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494826"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494826"><span class="hs-identifier hs-var">_sr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679494825"><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679494825"><span class="hs-identifier hs-var">mkRest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679494833"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single operation with several transitions left.&quot;</span></span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679494824"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679494824"><span class="hs-identifier hs-var">double</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-comment">-- observeDoubleStep (sl, tl, sm, tr, sr) ars double</span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679494824"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span id="local-6989586621679494823"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494823"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-687"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494831"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FreezeLeft after SplitRight.&quot;</span></span><span>
</span><span id="line-688"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;freezing left&quot;</span></span><span>
</span><span id="line-689"></span><span>          </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679494874"><span class="hs-identifier hs-var">doFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494823"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494829"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494828"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679494825"><span class="hs-identifier hs-var">mkRest</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494827"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494832"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-691"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span id="local-6989586621679494822"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494822"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-692"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494831"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SplitLeft after SplitRight.&quot;</span></span><span>
</span><span id="line-693"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting left: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494822"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-694"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679494821"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494821"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494820"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494820"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494819"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494819"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679494875"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494822"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494829"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-695"></span><span>          </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494830"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494821"><span class="hs-identifier hs-var">ctl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494820"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494819"><span class="hs-identifier hs-var">ctr</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494828"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679494825"><span class="hs-identifier hs-var">mkRest</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494827"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494832"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-696"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-type">LMDoubleSplitRight</span></a></span><span> </span><span id="local-6989586621679494818"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494818"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-697"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting right: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494818"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-698"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679494817"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494817"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494816"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494816"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494815"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494815"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679494875"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494818"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494827"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-699"></span><span>          </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494830"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494829"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494828"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494817"><span class="hs-identifier hs-var">ctl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494816"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679494825"><span class="hs-identifier hs-var">mkRest</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494815"><span class="hs-identifier hs-var">ctr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494832"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-700"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-type">LMDoubleSpread</span></a></span><span> </span><span id="local-6989586621679494814"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679494814"><span class="hs-identifier hs-var">spreadOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-701"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;spreading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679494814"><span class="hs-identifier hs-var">spreadOp</span></a></span><span>
</span><span id="line-702"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679494813"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494813"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494812"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494812"><span class="hs-identifier hs-var">csl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494811"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494811"><span class="hs-identifier hs-var">ctm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494810"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494810"><span class="hs-identifier hs-var">csr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494809"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494809"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr)
</span><a href="#local-6989586621679494873"><span class="hs-identifier hs-var">doSpread</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679494814"><span class="hs-identifier hs-var">spreadOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494829"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494828"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494827"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-703"></span><span>          </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679494870"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494830"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494813"><span class="hs-identifier hs-var">ctl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494812"><span class="hs-identifier hs-var">csl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494811"><span class="hs-identifier hs-var">ctm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494810"><span class="hs-identifier hs-var">csr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679494825"><span class="hs-identifier hs-var">mkRest</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494809"><span class="hs-identifier hs-var">ctr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679494832"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span class="hs-comment">-- evaluators</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- ==========</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="hs-comment">{- | Create a leftmost evaluator from position-independent evaluation functions
 that just return spread, split, and freeze operations
 by wrapping those into the appropriate 'Leftmost' constructors.
-}</span><span>
</span><span id="line-712"></span><span id="local-6989586621679497022"><span id="local-6989586621679497023"><span id="local-6989586621679497024"><span id="local-6989586621679497025"><span id="local-6989586621679497026"><span id="local-6989586621679497027"><span id="local-6989586621679497028"><span class="annot"><a href="Common.html#mkLeftmostEval"><span class="hs-identifier hs-type">mkLeftmostEval</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-type">UnspreadMiddle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497026"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-type">UnspreadLeft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-type">UnspreadRight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497025"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679497024"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679497023"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679497022"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497028"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497024"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497027"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497022"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497025"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497023"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497026"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-720"></span><span id="mkLeftmostEval"><span class="annot"><span class="annottext">mkLeftmostEval :: forall tr slc h s tr' f slc'.
UnspreadMiddle tr slc h
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; (StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)])
-&gt; (StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="Common.html#mkLeftmostEval"><span class="hs-identifier hs-var hs-var">mkLeftmostEval</span></a></span></span><span> </span><span id="local-6989586621679494799"><span class="annot"><span class="annottext">UnspreadMiddle tr slc h
</span><a href="#local-6989586621679494799"><span class="hs-identifier hs-var">unspreadm</span></a></span></span><span> </span><span id="local-6989586621679494798"><span class="annot"><span class="annottext">UnspreadLeft tr slc
</span><a href="#local-6989586621679494798"><span class="hs-identifier hs-var">unspreadl</span></a></span></span><span> </span><span id="local-6989586621679494797"><span class="annot"><span class="annottext">UnspreadRight tr slc
</span><a href="#local-6989586621679494797"><span class="hs-identifier hs-var">unspreadr</span></a></span></span><span> </span><span id="local-6989586621679494796"><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)]
</span><a href="#local-6989586621679494796"><span class="hs-identifier hs-var">unsplit</span></a></span></span><span> </span><span id="local-6989586621679494795"><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)]
</span><a href="#local-6989586621679494795"><span class="hs-identifier hs-var">uf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-721"></span><span>  </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
UnspreadMiddle tr slc v
-&gt; UnspreadLeft tr slc
-&gt; UnspreadRight tr slc
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span>
</span><span id="line-722"></span><span>    </span><span class="annot"><span class="annottext">(slc, tr, slc) -&gt; Maybe (slc, Leftmost s f h)
</span><a href="#local-6989586621679494794"><span class="hs-identifier hs-var">unspreadm'</span></a></span><span>
</span><span id="line-723"></span><span>    </span><span class="annot"><span class="annottext">UnspreadLeft tr slc
</span><a href="#local-6989586621679494798"><span class="hs-identifier hs-var">unspreadl</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><span class="annottext">UnspreadRight tr slc
</span><a href="#local-6989586621679494797"><span class="hs-identifier hs-var">unspreadr</span></a></span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; SplitType
-&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679494793"><span class="hs-identifier hs-var">unsplit'</span></a></span><span>
</span><span id="line-726"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679494792"><span class="hs-identifier hs-var">uf'</span></a></span><span>
</span><span id="line-727"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-728"></span><span>  </span><span id="local-6989586621679494787"><span class="annot"><span class="annottext">smap :: (b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679494787"><span class="hs-identifier hs-var hs-var">smap</span></a></span></span><span> </span><span id="local-6989586621679494786"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679494786"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679494786"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-comment">-- vm' :: UnspreadMiddle e a (Leftmost s f h)</span><span>
</span><span id="line-730"></span><span>  </span><span id="local-6989586621679494794"><span class="annot"><span class="annottext">unspreadm' :: (slc, tr, slc) -&gt; Maybe (slc, Leftmost s f h)
</span><a href="#local-6989586621679494794"><span class="hs-identifier hs-var hs-var">unspreadm'</span></a></span></span><span> </span><span id="local-6989586621679494785"><span class="annot"><span class="annottext">(slc, tr, slc)
</span><a href="#local-6989586621679494785"><span class="hs-identifier hs-var">vert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679494787"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h
</span><a href="#local-6989586621679494799"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">(slc, tr, slc)
</span><a href="#local-6989586621679494785"><span class="hs-identifier hs-var">vert</span></a></span><span>
</span><span id="line-731"></span><span>  </span><span id="local-6989586621679494793"><span class="annot"><span class="annottext">unsplit' :: StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; SplitType
-&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679494793"><span class="hs-identifier hs-var hs-var">unsplit'</span></a></span></span><span> </span><span id="local-6989586621679494784"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494784"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679494783"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494783"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679494782"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494782"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679494781"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494781"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679494780"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494780"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679494779"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679494779"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679494787"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
</span><a href="#local-6989586621679494778"><span class="hs-identifier hs-var">splitop</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, s)]
</span><a href="#local-6989586621679494777"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-732"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-733"></span><span>    </span><span id="local-6989586621679494777"><span class="annot"><span class="annottext">res :: [(tr, s)]
</span><a href="#local-6989586621679494777"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)]
</span><a href="#local-6989586621679494796"><span class="hs-identifier hs-var">unsplit</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494784"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494783"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679494782"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679494781"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494780"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621679494778"><span class="annot"><span class="annottext">splitop :: s -&gt; Leftmost s f h
</span><a href="#local-6989586621679494778"><span class="hs-identifier hs-var hs-var">splitop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679494779"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span>
</span><span id="line-736"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span>
</span><span id="line-737"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span>
</span><span id="line-738"></span><span>  </span><span id="local-6989586621679494792"><span class="annot"><span class="annottext">uf' :: StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679494792"><span class="hs-identifier hs-var hs-var">uf'</span></a></span></span><span> </span><span id="local-6989586621679494776"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494776"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679494775"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679494775"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679494774"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494774"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679494773"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494773"><span class="hs-identifier hs-var">isLast</span></a></span></span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494773"><span class="hs-identifier hs-var">isLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679494787"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, f)]
</span><a href="#local-6989586621679494772"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679494787"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, f)]
</span><a href="#local-6989586621679494772"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-741"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-742"></span><span>    </span><span id="local-6989586621679494772"><span class="annot"><span class="annottext">res :: [(tr, f)]
</span><a href="#local-6989586621679494772"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)]
</span><a href="#local-6989586621679494795"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494776"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679494775"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679494774"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="hs-comment">-- manually constructing derivations</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- =================================</span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="hs-comment">{- $monadicdoc

 Use these functions to manually build a derivation,
 checking leftmost-correctness in the type.
 A good way to do this is to start a derivation using `buildDerivation` or `buildPartialDerivation`
 and follow up with a @do@ block that contains a sequence of `split`,
 `freeze`, `splitRight` and `spread` actions..

 &gt; deriv :: [Leftmost () () ()] -- using unit for each operation type
 &gt; deriv = buildDerivation $ do -- start with 1 transition
 &gt;   split ()      -- (2 open transitions)
 &gt;   splitRight () -- (3 open)
 &gt;   spread ()     -- (4 open)
 &gt;   freeze ()     -- (3 open)
 &gt;   split ()      -- (4 open)
 &gt;   freeze ()     -- (3 open)
 &gt;   freeze ()     -- (2 open)
 &gt;   freeze ()     -- (1 open)
 &gt;   freeze ()     -- (0 open, end of derivation)

 The above example results in the following derivation graph:

 ![derivation of the above example](doc-images/monadic-deriv.svg)

 Since 'PartialDerivation' is an indexed monad
 (it's exact type changes between actions),
 using do-notation requires you to rebind its syntax to use indexed versions of '&gt;&gt;=' and '&gt;&gt;'
 using the @QualifiedDo@ extension.
 The easiest way to do use the generic operators from &quot;Language.Haskell.DoNotation&quot;
 by using this module as the @do@ qualifier:

 &gt; import qualified Language.Haskell.DoNotation as Do
 &gt;
 &gt; deriv = buildDerivation $ Do.do -- requires -XQualifiedDo
 &gt;   split ()
 &gt;   ...
-}</span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">{- | A wrapper around leftmost derivations
 that tracks information about the derivation state in the type.
 Number of open transitions: @openTrans@.
 Whether a right split has been performed at the current point: @afterRightSplit@.
-}</span><span>
</span><span id="line-790"></span><span class="hs-keyword">newtype</span><span> </span><span id="PartialDerivation"><span class="annot"><a href="Common.html#PartialDerivation"><span class="hs-identifier hs-var">PartialDerivation</span></a></span></span><span> </span><span id="local-6989586621679497009"><span class="annot"><a href="#local-6989586621679497009"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679497008"><span class="annot"><a href="#local-6989586621679497008"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679497007"><span class="annot"><a href="#local-6989586621679497007"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679497006"><span class="annot"><a href="#local-6989586621679497006"><span class="hs-identifier hs-type">openTrans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679497005"><span class="annot"><a href="#local-6989586621679497005"><span class="hs-identifier hs-type">afterRightSplit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PD"><span class="annot"><a href="Common.html#PD"><span class="hs-identifier hs-var">PD</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runPD"><span class="annot"><span class="annottext">forall s f h (openTrans :: Nat) (afterRightSplit :: Bool).
PartialDerivation s f h openTrans afterRightSplit
-&gt; [Leftmost s f h]
</span><a href="Common.html#runPD"><span class="hs-identifier hs-var hs-var">runPD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497009"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497008"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679497007"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">{- | An &quot;indexed&quot; version of a writer monad, i.e. one where the monad type between two steps can change.
 This can be used for tracking the number of open transitions in a derivation on the type level
 while still providing an monadic interface for constructing a derivation.
-}</span><span>
</span><span id="line-796"></span><span class="hs-keyword">newtype</span><span> </span><span id="IndexedWriter"><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-var">IndexedWriter</span></a></span></span><span> </span><span id="local-6989586621679496996"><span class="annot"><a href="#local-6989586621679496996"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679496995"><span class="annot"><a href="#local-6989586621679496995"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679496994"><span class="annot"><a href="#local-6989586621679496994"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621679496993"><span class="annot"><a href="#local-6989586621679496993"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IW"><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runIW"><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var hs-var">runIW</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MW.Writer</span></span><span> </span><span class="annot"><a href="#local-6989586621679496996"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496993"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496971"><span class="annot"><span class="hs-identifier hs-type">MI.IxFunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496971"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-799"></span><span>  </span><span id="local-6989586621679494760"><span class="annot"><span class="annottext">imap :: forall a b (j :: k) (k2 :: k1).
(a -&gt; b) -&gt; IndexedWriter w j k2 a -&gt; IndexedWriter w j k2 b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">imap</span></span></span><span> </span><span id="local-6989586621679494758"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679494758"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679494757"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494757"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679494758"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494757"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496955"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679496955"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxPointed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496955"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-802"></span><span>  </span><span id="local-6989586621679494746"><span class="annot"><span class="annottext">ireturn :: forall a (i :: k). a -&gt; IndexedWriter w i i a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ireturn</span></span></span><span> </span><span id="local-6989586621679494744"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494744"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494744"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496938"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679496938"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxApplicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496938"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-805"></span><span>  </span><span id="local-6989586621679494733"><span class="annot"><span class="annottext">iap :: forall (i :: k) (j :: k) a b (k1 :: k).
IndexedWriter w i j (a -&gt; b)
-&gt; IndexedWriter w j k1 a -&gt; IndexedWriter w i k1 b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">iap</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679494731"><span class="annot"><span class="annottext">Writer w (a -&gt; b)
</span><a href="#local-6989586621679494731"><span class="hs-identifier hs-var">wf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679494730"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494730"><span class="hs-identifier hs-var">wa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Writer w (a -&gt; b)
</span><a href="#local-6989586621679494731"><span class="hs-identifier hs-var">wf</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494730"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679496917"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679496917"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxMonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496917"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-808"></span><span>  </span><span id="local-6989586621679494721"><span class="annot"><span class="annottext">ibind :: forall a (j :: k) (k1 :: k) b (i :: k).
(a -&gt; IndexedWriter w j k1 b)
-&gt; IndexedWriter w i j a -&gt; IndexedWriter w i k1 b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ibind</span></span></span><span> </span><span id="local-6989586621679494719"><span class="annot"><span class="annottext">a -&gt; IndexedWriter w j k1 b
</span><a href="#local-6989586621679494719"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679494718"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494718"><span class="hs-identifier hs-var">wa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IndexedWriter w j k1 b
</span><a href="#local-6989586621679494719"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679494718"><span class="hs-identifier hs-var">wa</span></a></span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="hs-comment">-- | 'MW.tell' for 'IndexedWriter'.</span><span>
</span><span id="line-811"></span><span id="local-6989586621679496903"><span id="local-6989586621679496904"><span id="local-6989586621679496905"><span class="annot"><a href="Common.html#itell"><span class="hs-identifier hs-type">itell</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679496905"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496905"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496905"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496904"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496903"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-812"></span><span id="itell"><span class="annot"><span class="annottext">itell :: forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var hs-var">itell</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">MW.tell</span></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="hs-comment">{- | A type-level wrapper for partial derivation info.
 Encodes the number of open transitions
 and whether the last operation was a right split.
-}</span><span>
</span><span id="line-818"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-819"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationInfo"><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-var">DerivationInfo</span></a></span></span><span> </span><span id="local-6989586621679494711"><span class="annot"><a href="#local-6989586621679494711"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679494710"><span class="annot"><a href="#local-6989586621679494710"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">{- | The type of a monadic derivation action that modifies the derivation state
 (number of open transitions, after right split).
-}</span><span>
</span><span id="line-824"></span><span class="hs-keyword">type</span><span> </span><span id="DerivationAction"><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-var">DerivationAction</span></a></span></span><span> </span><span id="local-6989586621679494709"><span class="annot"><a href="#local-6989586621679494709"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679494708"><span class="annot"><a href="#local-6989586621679494708"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679494707"><span class="annot"><a href="#local-6989586621679494707"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679494706"><span class="annot"><a href="#local-6989586621679494706"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679494705"><span class="annot"><a href="#local-6989586621679494705"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span id="local-6989586621679494704"><span class="annot"><a href="#local-6989586621679494704"><span class="hs-identifier hs-type">afterRight</span></a></span></span><span> </span><span id="local-6989586621679494703"><span class="annot"><a href="#local-6989586621679494703"><span class="hs-identifier hs-type">afterRight'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-825"></span><span>  </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494709"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494708"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494707"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494706"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494704"><span class="hs-identifier hs-type">afterRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494705"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494703"><span class="hs-identifier hs-type">afterRight'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="hs-comment">{- | Turn a monadically constructed derivation into a proper left-most derivation.
 This function assumes the derivation to start with a single transition.
-}</span><span>
</span><span id="line-834"></span><span id="local-6989586621679496888"><span id="local-6989586621679496889"><span id="local-6989586621679496890"><span id="local-6989586621679496891"><span id="local-6989586621679496892"><span class="annot"><a href="Common.html#buildDerivation"><span class="hs-identifier hs-type">buildDerivation</span></a></span><span>
</span><span id="line-835"></span><span>  </span><span class="hs-comment">-- :: (PartialDeriv s f h 1 False -&gt; PartialDeriv s f h n snd)</span><span>
</span><span id="line-836"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496890"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679496889"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679496888"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496891"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496890"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-837"></span><span id="buildDerivation"><span class="annot"><span class="annottext">buildDerivation :: forall s f h (n :: Nat) (snd :: Bool).
DerivationAction s f h 1 n 'False snd -&gt; [Leftmost s f h]
</span><a href="Common.html#buildDerivation"><span class="hs-identifier hs-var hs-var">buildDerivation</span></a></span></span><span> </span><span id="local-6989586621679494702"><span class="annot"><span class="annottext">DerivationAction s f h 1 n 'False snd
</span><a href="#local-6989586621679494702"><span class="hs-identifier hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">MW.execWriter</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h 1 n 'False snd
</span><a href="#local-6989586621679494702"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">{- | Turn a monadically constructed partial derivation into a left-most derivation.
 This function does not restrict the number of transitions in the starting configuration.
-}</span><span>
</span><span id="line-842"></span><span class="annot"><a href="Common.html#buildPartialDerivation"><span class="hs-identifier hs-type">buildPartialDerivation</span></a></span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679496876"><span class="annot"><a href="#local-6989586621679496876"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679496875"><span class="annot"><a href="#local-6989586621679496875"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span id="local-6989586621679496874"><span class="annot"><a href="#local-6989586621679496874"><span class="hs-identifier hs-type">snd</span></a></span></span><span> </span><span id="local-6989586621679496879"><span class="annot"><a href="#local-6989586621679496879"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679496878"><span class="annot"><a href="#local-6989586621679496878"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679496877"><span class="annot"><a href="#local-6989586621679496877"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-844"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496879"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496877"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496876"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496875"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679496874"><span class="hs-identifier hs-type">snd</span></a></span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496879"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496877"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-846"></span><span id="buildPartialDerivation"><span class="annot"><span class="annottext">buildPartialDerivation :: forall (n :: Nat) (n' :: Nat) (snd :: Bool) s f h.
DerivationAction s f h n n' 'False snd -&gt; [Leftmost s f h]
</span><a href="Common.html#buildPartialDerivation"><span class="hs-identifier hs-var hs-var">buildPartialDerivation</span></a></span></span><span> </span><span id="local-6989586621679494700"><span class="annot"><span class="annottext">DerivationAction s f h n n' 'False snd
</span><a href="#local-6989586621679494700"><span class="hs-identifier hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">MW.execWriter</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h n n' 'False snd
</span><a href="#local-6989586621679494700"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- | Turn a split operation into a monadic (left or single) split action.</span><span>
</span><span id="line-849"></span><span class="annot"><a href="Common.html#split"><span class="hs-identifier hs-type">split</span></a></span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679496867"><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679496865"><span class="annot"><a href="#local-6989586621679496865"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679496864"><span class="annot"><a href="#local-6989586621679496864"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679496863"><span class="annot"><a href="#local-6989586621679496863"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-851"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496865"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496865"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496864"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496863"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-854"></span><span id="split"><span class="annot"><span class="annottext">split :: forall (n :: Nat) s f h.
(KnownNat n, 1 &lt;= n) =&gt;
s -&gt; DerivationAction s f h n (n + 1) 'False 'False
</span><a href="Common.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679494689"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494689"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679496867"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494689"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494689"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="hs-comment">-- | Turn a freeze operation into a monadic (left or single) freeze action.</span><span>
</span><span id="line-859"></span><span class="annot"><a href="Common.html#freeze"><span class="hs-identifier hs-type">freeze</span></a></span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679496852"><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679496850"><span class="annot"><a href="#local-6989586621679496850"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679496849"><span class="annot"><a href="#local-6989586621679496849"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679496851"><span class="annot"><a href="#local-6989586621679496851"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-861"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496851"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496850"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496851"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496849"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-864"></span><span id="freeze"><span class="annot"><span class="annottext">freeze :: forall (n :: Nat) s h f.
(KnownNat n, 1 &lt;= n) =&gt;
f -&gt; DerivationAction s f h n (n - 1) 'False 'False
</span><a href="Common.html#freeze"><span class="hs-identifier hs-var hs-var">freeze</span></a></span></span><span> </span><span id="local-6989586621679494681"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494681"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679496852"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494681"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679494681"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-comment">-- | Turn a split operation into a monadic right-split action.</span><span>
</span><span id="line-869"></span><span id="local-6989586621679496840"><span id="local-6989586621679496841"><span id="local-6989586621679496842"><span id="local-6989586621679496843"><span id="local-6989586621679496844"><span class="annot"><a href="Common.html#splitRight"><span class="hs-identifier hs-type">splitRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679496844"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496843"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496843"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496841"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496844"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496844"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679496840"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span></span></span></span></span></span><span>
</span><span id="line-870"></span><span id="splitRight"><span class="annot"><span class="annottext">splitRight :: forall (n :: Nat) s f h (snd :: Bool).
(2 &lt;= n) =&gt;
s -&gt; DerivationAction s f h n (n + 1) snd 'True
</span><a href="Common.html#splitRight"><span class="hs-identifier hs-var hs-var">splitRight</span></a></span></span><span> </span><span id="local-6989586621679494678"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494678"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679494678"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span class="hs-comment">-- | Turn a spread operation into a monadic spread action.</span><span>
</span><span id="line-873"></span><span id="local-6989586621679496831"><span id="local-6989586621679496832"><span id="local-6989586621679496833"><span id="local-6989586621679496834"><span id="local-6989586621679496835"><span class="annot"><a href="Common.html#spread"><span class="hs-identifier hs-type">spread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679496835"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496834"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496833"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496832"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496834"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496835"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496835"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679496831"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span></span></span></span></span></span><span>
</span><span id="line-874"></span><span id="spread"><span class="annot"><span class="annottext">spread :: forall (n :: Nat) h s f (snd :: Bool).
(2 &lt;= n) =&gt;
h -&gt; DerivationAction s f h n (n + 1) snd 'False
</span><a href="Common.html#spread"><span class="hs-identifier hs-var hs-var">spread</span></a></span></span><span> </span><span id="local-6989586621679494675"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679494675"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679494675"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-comment">-- useful semirings</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- ================</span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">{- | The derivations semiring.
 Similar to a free semiring, encodes sequences, alternatives, and neutral values directly.
 However, semiring equivalences are not idendified by default.
-}</span><span>
</span><span id="line-883"></span><span id="local-6989586621679494673"><span id="local-6989586621679494674"></span></span><span class="hs-keyword">data</span><span> </span><span id="Derivations"><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-var">Derivations</span></a></span></span><span> </span><span id="local-6989586621679496825"><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-884"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | a single operation</span><span>
</span><span id="line-885"></span><span>    </span><span id="Do"><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-var">Do</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | combines alternative derivations</span><span>
</span><span id="line-887"></span><span>    </span><span id="Or"><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-var">Or</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | combines sequential derivations</span><span>
</span><span id="line-889"></span><span>    </span><span id="Then"><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-var">Then</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496825"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | the neutral element to 'Then'</span><span>
</span><span id="line-891"></span><span>    </span><span id="NoOp"><span class="annot"><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span></span><span>
</span><span id="line-892"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | the neutral element to 'Or'</span><span>
</span><span id="line-893"></span><span>    </span><span id="Cannot"><span class="annot"><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span></span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494659"><span id="local-6989586621679494666"><span class="annot"><span class="annottext">Derivations a -&gt; Derivations a -&gt; Bool
forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Derivations a -&gt; Derivations a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
== :: Derivations a -&gt; Derivations a -&gt; Bool
$c== :: forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679494638"><span id="local-6989586621679494640"><span id="local-6989586621679494642"><span id="local-6989586621679494644"><span id="local-6989586621679494646"><span id="local-6989586621679494648"><span id="local-6989586621679494655"><span class="annot"><span class="annottext">Derivations a -&gt; Derivations a -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a}. Ord a =&gt; Eq (Derivations a)
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Ordering
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
min :: Derivations a -&gt; Derivations a -&gt; Derivations a
$cmin :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
max :: Derivations a -&gt; Derivations a -&gt; Derivations a
$cmax :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
&gt;= :: Derivations a -&gt; Derivations a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&gt; :: Derivations a -&gt; Derivations a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&lt;= :: Derivations a -&gt; Derivations a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&lt; :: Derivations a -&gt; Derivations a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
compare :: Derivations a -&gt; Derivations a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Derivations a) x -&gt; Derivations a
forall a x. Derivations a -&gt; Rep (Derivations a) x
$cto :: forall a x. Rep (Derivations a) x -&gt; Derivations a
$cfrom :: forall a x. Derivations a -&gt; Rep (Derivations a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679494634"><span id="local-6989586621679496824"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679496824"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496824"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span class="hs-comment">-- | A helper tag for pretty-printing derivations.</span><span>
</span><span id="line-899"></span><span class="hs-keyword">data</span><span> </span><span id="DerivOp"><span class="annot"><a href="Common.html#DerivOp"><span class="hs-identifier hs-var">DerivOp</span></a></span></span><span>
</span><span id="line-900"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="OpNone"><span class="annot"><a href="Common.html#OpNone"><span class="hs-identifier hs-var">OpNone</span></a></span></span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpOr"><span class="annot"><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span></span><span>
</span><span id="line-902"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpThen"><span class="annot"><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span></span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494627"><span id="local-6989586621679494629"><span class="annot"><span class="annottext">DerivOp -&gt; DerivOp -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DerivOp -&gt; DerivOp -&gt; Bool
$c/= :: DerivOp -&gt; DerivOp -&gt; Bool
== :: DerivOp -&gt; DerivOp -&gt; Bool
$c== :: DerivOp -&gt; DerivOp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679494622"><span id="local-6989586621679494625"><span id="local-6989586621679496823"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679496823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496823"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-906"></span><span>  </span><span id="local-6989586621679494618"><span class="annot"><span class="annottext">show :: Derivations a -&gt; String
</span><a href="#local-6989586621679494618"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b} {a}.
(Integral b, Show a) =&gt;
b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpNone"><span class="hs-identifier hs-var">OpNone</span></a></span><span>
</span><span id="line-907"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-908"></span><span>    </span><span id="local-6989586621679494610"><span class="annot"><span class="annottext">indent :: b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679494609"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494609"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. (Integral b, Monoid a) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimesMonoid</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494609"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;  &quot;</span></span><span>
</span><span id="line-909"></span><span>    </span><span id="local-6989586621679494617"><span class="annot"><span class="annottext">go :: b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679494554"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494554"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679494553"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494553"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494554"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494553"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-910"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494552"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494552"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494552"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NoOp&quot;</span></span><span>
</span><span id="line-911"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494551"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494551"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494551"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot&quot;</span></span><span>
</span><span id="line-912"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494550"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494550"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679494549"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494549"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494548"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494548"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494550"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494549"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494550"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494548"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-913"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494547"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494547"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679494546"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494546"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494545"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494545"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-914"></span><span>      </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Or\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494546"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494547"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494545"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-915"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494544"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494544"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679494543"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494543"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494542"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494542"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494544"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494543"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494544"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494542"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-916"></span><span>    </span><span class="annot"><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679494541"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494541"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679494540"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494540"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494539"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494539"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-917"></span><span>      </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679494610"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494541"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Then\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494541"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494540"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679494617"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679494541"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494539"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679494533"><span id="local-6989586621679496813"><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-920"></span><span>  </span><span id="local-6989586621679494531"><span class="annot"><span class="annottext">zero :: Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-921"></span><span>  </span><span id="local-6989586621679494529"><span class="annot"><span class="annottext">one :: Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">one</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span>
</span><span id="line-922"></span><span>  </span><span id="local-6989586621679494527"><span class="annot"><span class="annottext">plus :: Derivations a -&gt; Derivations a -&gt; Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">plus</span></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span id="local-6989586621679494525"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494525"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494525"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">plus</span></span><span> </span><span id="local-6989586621679494524"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494524"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494524"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">plus</span></span><span> </span><span id="local-6989586621679494523"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494523"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494522"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494522"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="Common.html#Or"><span class="hs-identifier hs-var">Or</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494523"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494522"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-925"></span><span>  </span><span id="local-6989586621679494521"><span class="annot"><span class="annottext">times :: Derivations a -&gt; Derivations a -&gt; Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">times</span></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-926"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span id="local-6989586621679494519"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494519"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494519"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span id="local-6989586621679494518"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494518"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494518"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span id="local-6989586621679494517"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494517"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494516"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494516"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="Common.html#Then"><span class="hs-identifier hs-var">Then</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494517"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494516"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span class="hs-comment">-- | Map the 'Derivations' semiring to another semiring.</span><span>
</span><span id="line-932"></span><span id="local-6989586621679496811"><span id="local-6989586621679496812"><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-type">mapDerivations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679496812"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679496811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496812"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496812"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-933"></span><span id="mapDerivations"><span class="annot"><span class="annottext">mapDerivations :: forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var hs-var">mapDerivations</span></a></span></span><span> </span><span id="local-6989586621679494506"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494506"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679494505"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494505"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494506"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494505"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-934"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.one</span></span><span>
</span><span id="line-935"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.zero</span></span><span>
</span><span id="line-936"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span id="local-6989586621679494504"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494504"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679494503"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494503"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494502"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494502"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494504"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494503"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.+</span></span><span> </span><span class="annot"><span class="annottext">forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494504"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494502"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-937"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span id="local-6989586621679494500"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494500"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679494499"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494499"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494498"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494498"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494500"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494499"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679494500"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494498"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="hs-comment">-- | Flatten the prefix-tree structure of 'Derivations' into a simple set of derivations.</span><span>
</span><span id="line-940"></span><span id="local-6989586621679496807"><span class="annot"><a href="Common.html#flattenDerivations"><span class="hs-identifier hs-type">flattenDerivations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679496807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679496807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-941"></span><span id="flattenDerivations"><span class="annot"><span class="annottext">flattenDerivations :: forall a. Ord a =&gt; Derivations a -&gt; Set [a]
</span><a href="Common.html#flattenDerivations"><span class="hs-identifier hs-var hs-var">flattenDerivations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494491"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494491"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="hs-comment">{- | Flatten the prefix-tree structure of 'Derivations'
 into a simple list of (potentially redundant) derivations.
-}</span><span>
</span><span id="line-946"></span><span id="local-6989586621679496802"><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-type">flattenDerivationsRed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679496802"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496802"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679496802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-947"></span><span id="flattenDerivationsRed"><span class="annot"><span class="annottext">flattenDerivationsRed :: forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var hs-var">flattenDerivationsRed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679494477"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494477"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494477"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-948"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-950"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679494476"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494476"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494475"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494475"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-951"></span><span>  </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494476"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494475"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-952"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679494474"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494474"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494473"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494473"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-953"></span><span>  </span><span id="local-6989586621679494472"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494472"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494474"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-954"></span><span>  </span><span id="local-6989586621679494471"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494471"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494473"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-955"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494472"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494471"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span class="hs-comment">-- | Obtain the first derivation from a 'Derivations' tree.</span><span>
</span><span id="line-958"></span><span id="local-6989586621679496800"><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-type">firstDerivation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679496800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679496800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679496800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-959"></span><span id="firstDerivation"><span class="annot"><span class="annottext">firstDerivation :: forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var hs-var">firstDerivation</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-960"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-961"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679494462"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494462"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494462"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-962"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679494461"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494461"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494461"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-963"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679494460"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494460"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679494459"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494459"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-964"></span><span>  </span><span id="local-6989586621679494458"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494458"><span class="hs-identifier hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494460"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-965"></span><span>  </span><span id="local-6989586621679494457"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494457"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679494459"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-966"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494458"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494457"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span class="hs-comment">-- utilities</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- =========</span><span>
</span><span id="line-970"></span><span>
</span><span id="line-971"></span><span class="hs-comment">-- | The global trace level. Only trace messages &gt;= this level are shown.</span><span>
</span><span id="line-972"></span><span class="annot"><a href="Common.html#traceLevel"><span class="hs-identifier hs-type">traceLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-973"></span><span id="traceLevel"><span class="annot"><span class="annottext">traceLevel :: Int
</span><a href="Common.html#traceLevel"><span class="hs-identifier hs-var hs-var">traceLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-974"></span><span>
</span><span id="line-975"></span><span class="hs-comment">-- | A helper for conditionally tracing a message.</span><span>
</span><span id="line-976"></span><span class="annot"><a href="Common.html#traceIf"><span class="hs-identifier hs-type">traceIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-977"></span><span id="traceIf"><span class="annot"><span class="annottext">traceIf :: Int -&gt; String -&gt; Bool -&gt; Bool
</span><a href="Common.html#traceIf"><span class="hs-identifier hs-var hs-var">traceIf</span></a></span></span><span> </span><span id="local-6989586621679494456"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679494456"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679494455"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679494455"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679494454"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.html#traceLevel"><span class="hs-identifier hs-var">traceLevel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679494456"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679494455"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-979"></span><span>
</span><span id="line-980"></span><span class="hs-comment">-- toVariant :: ToJSON a =&gt; T.Text -&gt; a -&gt; Aeson.Value</span><span>
</span><span id="line-981"></span><span class="hs-comment">-- toVariant typ val = Aeson.object [&quot;type&quot; .= typ, &quot;value&quot; .= val]</span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="hs-comment">-- toVariantEnc :: (ToJSON a) =&gt; T.Text -&gt; a -&gt; Aeson.Encoding</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- toVariantEnc typ val = Aeson.pairs (&quot;type&quot; .= typ &lt;&gt; &quot;value&quot; .= val)</span><span>
</span><span id="line-985"></span><span>
</span><span id="line-986"></span><span class="hs-comment">-- | Lowercase the first character in a string.</span><span>
</span><span id="line-987"></span><span class="annot"><a href="Common.html#firstToLower"><span class="hs-identifier hs-type">firstToLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-988"></span><span id="firstToLower"><span class="annot"><span class="annottext">firstToLower :: ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var hs-var">firstToLower</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-989"></span><span class="annot"><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494452"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679494452"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679494451"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679494452"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-990"></span><span>
</span><span id="line-991"></span><span class="hs-comment">-- | Aeson options for parsing &quot;variant&quot; types (generated in PureScript)</span><span>
</span><span id="line-992"></span><span class="annot"><a href="Common.html#variantDefaults"><span class="hs-identifier hs-type">variantDefaults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Options</span></span><span>
</span><span id="line-993"></span><span id="variantDefaults"><span class="annot"><span class="annottext">variantDefaults :: ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var hs-var">variantDefaults</span></a></span></span><span> </span><span id="local-6989586621679494450"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679494450"><span class="hs-identifier hs-var">rename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-994"></span><span>  </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">Aeson.defaultOptions</span></span><span>
</span><span id="line-995"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorTagModifier :: ShowS
</span><span class="hs-identifier hs-var">Aeson.constructorTagModifier</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679494450"><span class="hs-identifier hs-var">rename</span></a></span><span>
</span><span id="line-996"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sumEncoding :: SumEncoding
</span><span class="hs-identifier hs-var">Aeson.sumEncoding</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; SumEncoding
</span><span class="hs-identifier hs-var">Aeson.TaggedObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-997"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span class="hs-comment">-- | Convert special characters to TeX commands.</span><span>
</span><span id="line-1000"></span><span id="local-6989586621679494445"><span class="annot"><a href="Common.html#showTex"><span class="hs-identifier hs-type">showTex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679494445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-1001"></span><span id="showTex"><span class="annot"><span class="annottext">showTex :: forall a. Show a =&gt; a -&gt; String
</span><a href="Common.html#showTex"><span class="hs-identifier hs-var hs-var">showTex</span></a></span></span><span> </span><span id="local-6989586621679494440"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494440"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
</span><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494440"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1002"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1003"></span><span>  </span><span id="local-6989586621679494438"><span class="annot"><span class="annottext">escapeTex :: Char -&gt; String
</span><a href="#local-6989586621679494438"><span class="hs-identifier hs-var hs-var">escapeTex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#9837;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\flat$&quot;</span></span><span>
</span><span id="line-1004"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#9839;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\sharp$&quot;</span></span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\{&quot;</span></span><span>
</span><span id="line-1006"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\}&quot;</span></span><span>
</span><span id="line-1007"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8905;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\ltimes$&quot;</span></span><span>
</span><span id="line-1008"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8906;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\rtimes$&quot;</span></span><span>
</span><span id="line-1009"></span><span>  </span><span class="annot"><a href="#local-6989586621679494438"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span id="local-6989586621679494430"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679494430"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679494430"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- | Convert special characters to TeX commands (using 'T.Text')</span><span>
</span><span id="line-1012"></span><span id="local-6989586621679496792"><span class="annot"><a href="Common.html#showTexT"><span class="hs-identifier hs-type">showTexT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679496792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679496792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span><span>
</span><span id="line-1013"></span><span id="showTexT"><span class="annot"><span class="annottext">showTexT :: forall a. Show a =&gt; a -&gt; Text
</span><a href="Common.html#showTexT"><span class="hs-identifier hs-var hs-var">showTexT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="Common.html#showTex"><span class="hs-identifier hs-var">showTex</span></a></span><span>
</span><span id="line-1014"></span></pre></body></html>