<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-patterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK ignore-exports #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{- | This module contains a simple greedy parser for path grammars.
 The grammar is provided by an evaluator ('Eval').
 In addition, the parser takes a policy function
 that picks a reduction option in each step.
-}</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GreedyParser</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- TODO: add back export list once haddock's ignore-exports works again.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- ( parseGreedy</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- , pickRandom</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- , parseRandom</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- , parseRandom'</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- ) where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">initStdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StatefulGen</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newIOGenM</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uniformRM</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- * Parsing State</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">{- | A transition during greedy parsing.
 Augments transition data with a flag
 that indicates whether the transition is a transitive right (2nd) parent of a spread.
-}</span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="Trans"><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span></span><span> </span><span id="local-6989586621679513777"><span class="annot"><a href="#local-6989586621679513777"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Trans"><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_tContent"><span class="annot"><span class="annottext">forall tr. Trans tr -&gt; tr
</span><a href="GreedyParser.html#_tContent"><span class="hs-identifier hs-var hs-var">_tContent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679513777"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-comment">-- ^ content of the transition</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_t2nd"><span class="annot"><span class="annottext">forall tr. Trans tr -&gt; Bool
</span><a href="GreedyParser.html#_t2nd"><span class="hs-identifier hs-var hs-var">_t2nd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">-- ^ flag that indicates (transitive) right parents of spreads</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513477"><span id="local-6989586621679513479"><span id="local-6989586621679513486"><span class="annot"><span class="annottext">Int -&gt; Trans tr -&gt; ShowS
forall tr. Show tr =&gt; Int -&gt; Trans tr -&gt; ShowS
forall tr. Show tr =&gt; [Trans tr] -&gt; ShowS
forall tr. Show tr =&gt; Trans tr -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Trans tr] -&gt; ShowS
$cshowList :: forall tr. Show tr =&gt; [Trans tr] -&gt; ShowS
show :: Trans tr -&gt; String
$cshow :: forall tr. Show tr =&gt; Trans tr -&gt; String
showsPrec :: Int -&gt; Trans tr -&gt; ShowS
$cshowsPrec :: forall tr. Show tr =&gt; Int -&gt; Trans tr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">{- | The state of the greedy parse between steps.
 Generally, the current reduction consists of frozen transitions
 between the &#8906; and the current location
 and open transitions between the current location and &#8905;.

 &gt; &#8906;==[1]==[2]==[3]&#8212;&#8212;[4]&#8212;&#8212;[5]&#8212;&#8212;&#8905;
 &gt;   &#9492; frozen  &#9496;  | &#9492;   open  &#9496;
 &gt;             midSlice (current position)
 &gt;
 &gt; frozen:   ==[2]==[1]==
 &gt; midSlice: [3]
 &gt; open:     &#8212;&#8212;[4]&#8212;&#8212;[5]&#8212;&#8212;

 This is the 'GSSemiOpen' case:
 The slice at the current pointer (@[3]@)
 is represented as an individual slice (@midSlice@).
 The frozen part is represented by a 'Path' of frozen transitions (@tr'@) and slices (@slc@).
 __in reverse direction__, i.e. from @midslice@ back to &#8906; (excluding &#8906;).
 The open part is a 'Path' of open transitions (@tr@) and slices (@slc@)
 in forward direction from @midSlice@ up to &#8905;.

 There are two special cases.
 All transitions can be frozen ('GSFrozen'),
 in which case state only contains the backward 'Path' of frozen transitions
 (excluding &#8906; and &#8905;):

 &gt; &#8906;==[1]==[2]==[3]==&#8905;
 &gt;                    &#9492; current position
 &gt; represented as: ==[3]==[2]==[1]==

 Or all transitions can be open ('GSOpen'),
 in which case the state is just the forward path of open transitions:

 &gt; &#8906;&#8212;&#8212;[1]&#8212;&#8212;[2]&#8212;&#8212;[3]&#8212;&#8212;&#8905;
 &gt; &#9492; current position
 &gt; represented as: &#8212;&#8212;[1]&#8212;&#8212;[2]&#8212;&#8212;[3]&#8212;&#8212;

 The open and semiopen case additionally have a list of operations in generative order.
-}</span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="GreedyState"><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-var">GreedyState</span></a></span></span><span> </span><span id="local-6989586621679513772"><span class="annot"><a href="#local-6989586621679513772"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679513771"><span class="annot"><a href="#local-6989586621679513771"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679513770"><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679513769"><span class="annot"><a href="#local-6989586621679513769"><span class="hs-identifier hs-type">op</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GSFrozen"><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-var">GSFrozen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513771"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GSSemiOpen"><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span></span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="_gsFrozen"><span class="annot"><span class="annottext">forall tr tr' slc op.
GreedyState tr tr' slc op -&gt; Path (Maybe tr') slc
</span><a href="GreedyParser.html#_gsFrozen"><span class="hs-identifier hs-var hs-var">_gsFrozen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513771"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-comment">-- ^ frozen transitions and slices from current point leftward</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsMidSlice"><span class="annot"><span class="annottext">forall tr tr' slc op. GreedyState tr tr' slc op -&gt; slc
</span><a href="GreedyParser.html#_gsMidSlice"><span class="hs-identifier hs-var hs-var">_gsMidSlice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-comment">-- ^ the slice at the current posision between gsFrozen and gsOpen</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsOpen"><span class="annot"><span class="annottext">forall tr tr' slc op.
GreedyState tr tr' slc op -&gt; Path (Trans tr) slc
</span><a href="GreedyParser.html#_gsOpen"><span class="hs-identifier hs-var hs-var">_gsOpen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513772"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-comment">-- ^ non-frozen transitions and slices from current point rightward</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsDeriv"><span class="annot"><span class="annottext">forall tr tr' slc op. GreedyState tr tr' slc op -&gt; [op]
</span><a href="GreedyParser.html#_gsDeriv"><span class="hs-identifier hs-var hs-var">_gsDeriv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679513769"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-comment">-- ^ derivation from current reduction to original surface</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GSOpen"><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513772"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679513770"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679513769"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679513464"><span id="local-6989586621679513467"><span id="local-6989586621679513746"><span id="local-6989586621679513747"><span id="local-6989586621679513748"><span id="local-6989586621679513749"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513749"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513748"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513747"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513746"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513749"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513748"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679513453"><span class="annot"><span class="annottext">show :: GreedyState tr tr' slc o -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679513451"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513451"><span class="hs-identifier hs-var">frozen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var">showFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513451"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679513449"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513449"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679513448"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679513448"><span class="hs-identifier hs-var">_ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var">showOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513449"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-comment">-- &lt;&gt; &quot; &quot; &lt;&gt; show ops</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679513446"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513446"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679513445"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513445"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679513444"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513444"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679513443"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679513443"><span class="hs-identifier hs-var">_ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var">showFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513446"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513445"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var">showOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513444"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-comment">-- &lt;&gt; &quot; &quot; &lt;&gt; show ops</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Helper function for showing the frozen part of a piece.</span><span>
</span><span id="line-114"></span><span id="local-6989586621679513743"><span id="local-6989586621679513744"><span class="annot"><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-type">showFrozen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513744"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513743"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513744"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-115"></span><span id="showFrozen"><span class="annot"><span class="annottext">showFrozen :: forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var hs-var">showFrozen</span></a></span></span><span> </span><span id="local-6989586621679513434"><span class="annot"><span class="annottext">Path tr' slc
</span><a href="#local-6989586621679513434"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {t} {a} {around}.
(Eq t, Num t, Show a) =&gt;
t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513433"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Path tr' slc
</span><a href="#local-6989586621679513434"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-116"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679513433"><span class="annot"><span class="annottext">go :: t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513433"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="#local-6989586621679513433"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679513417"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513417"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679513416"><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513416"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;...&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513417"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="#local-6989586621679513433"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679513415"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679513415"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679513414"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513414"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679513413"><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513413"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513433"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679513415"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513413"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513414"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Helper function for showing the open part of a piece.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679513411"><span id="local-6989586621679513412"><span class="annot"><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-type">showOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513412"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513411"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513412"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-123"></span><span id="showOpen"><span class="annot"><span class="annottext">showOpen :: forall slc tr'. Show slc =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var hs-var">showOpen</span></a></span></span><span> </span><span id="local-6989586621679513404"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679513404"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t} {a} {around}.
(Eq t, Num t, Show a) =&gt;
t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513403"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679513404"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-124"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679513403"><span class="annot"><span class="annottext">go :: t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513403"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="#local-6989586621679513403"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679513389"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513389"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679513388"><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513388"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513389"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;...&quot;</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="#local-6989586621679513403"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679513387"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679513387"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679513386"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513386"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679513385"><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513385"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Path around a -&gt; String
</span><a href="#local-6989586621679513403"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679513387"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path around a
</span><a href="#local-6989586621679513385"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- * Parsing Actions</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">{- | A parsing action (reduction step) with a single parent transition.
 Combines the parent elements with a single-transition derivation operation.
-}</span><span>
</span><span id="line-134"></span><span class="hs-keyword">data</span><span> </span><span id="ActionSingle"><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span></span><span> </span><span id="local-6989586621679513722"><span class="annot"><a href="#local-6989586621679513722"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679513721"><span class="annot"><a href="#local-6989586621679513721"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679513720"><span class="annot"><a href="#local-6989586621679513720"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679513719"><span class="annot"><a href="#local-6989586621679513719"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ActionSingle"><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513722"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513721"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513722"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-comment">-- ^ parent transition (and adjacent slices)</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513720"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513719"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">-- ^ single-transition operation</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513370"><span id="local-6989586621679513372"><span id="local-6989586621679513382"><span class="annot"><span class="annottext">Int -&gt; ActionSingle slc tr s f -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
Int -&gt; ActionSingle slc tr s f -&gt; ShowS
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
[ActionSingle slc tr s f] -&gt; ShowS
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
ActionSingle slc tr s f -&gt; String
showList :: [ActionSingle slc tr s f] -&gt; ShowS
$cshowList :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
[ActionSingle slc tr s f] -&gt; ShowS
show :: ActionSingle slc tr s f -&gt; String
$cshow :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
ActionSingle slc tr s f -&gt; String
showsPrec :: Int -&gt; ActionSingle slc tr s f -&gt; ShowS
$cshowsPrec :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
Int -&gt; ActionSingle slc tr s f -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">{- | A parsing action (reduction step) with two parent transitions.
 Combines the parent elements with a double-transition derivation operation.
-}</span><span>
</span><span id="line-145"></span><span class="hs-keyword">data</span><span> </span><span id="ActionDouble"><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span></span><span> </span><span id="local-6989586621679513709"><span class="annot"><a href="#local-6989586621679513709"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679513708"><span class="annot"><a href="#local-6989586621679513708"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679513707"><span class="annot"><a href="#local-6989586621679513707"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679513706"><span class="annot"><a href="#local-6989586621679513706"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679513705"><span class="annot"><a href="#local-6989586621679513705"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ActionDouble"><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513709"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513708"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679513709"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513708"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513709"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-comment">-- ^ parent transitions and slice</span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513707"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513706"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513705"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>      </span><span class="hs-comment">-- ^ double-transition operation</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513353"><span id="local-6989586621679513355"><span id="local-6989586621679513366"><span class="annot"><span class="annottext">Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
[ActionDouble slc tr s f h] -&gt; ShowS
forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
ActionDouble slc tr s f h -&gt; String
showList :: [ActionDouble slc tr s f h] -&gt; ShowS
$cshowList :: forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
[ActionDouble slc tr s f h] -&gt; ShowS
show :: ActionDouble slc tr s f h -&gt; String
$cshow :: forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
ActionDouble slc tr s f h -&gt; String
showsPrec :: Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
$cshowsPrec :: forall slc tr s f h.
(Show slc, Show tr, Show s, Show f, Show h) =&gt;
Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | An alias that combines 'ActionSingle' and 'ActionDouble', representing all possible reduction steps.</span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span id="Action"><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621679513352"><span class="annot"><a href="#local-6989586621679513352"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679513351"><span class="annot"><a href="#local-6989586621679513351"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679513350"><span class="annot"><a href="#local-6989586621679513350"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679513349"><span class="annot"><a href="#local-6989586621679513349"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679513348"><span class="annot"><a href="#local-6989586621679513348"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513352"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513351"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513350"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513349"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513352"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513351"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513350"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513349"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513348"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- * Parsing Algorithm</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">{- | Parse a piece in a greedy fashion.
 At each step, a policy chooses from the possible reduction actions,
 the reduction is applied, and parsing continues
 until the piece is fully reduced or no more reduction operations are available.
 Returns the full derivation from the top (@&#8906;&#8212;&#8212;&#8905;@) or an error message.
-}</span><span>
</span><span id="line-169"></span><span class="annot"><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-type">parseGreedy</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679513704"><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679513700"><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679513702"><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679513701"><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679513696"><span class="annot"><a href="#local-6989586621679513696"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679513699"><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679513698"><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679513697"><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-171"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513696"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-comment">-- ^ the evaluator of the grammar to be used</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- ^ the policy: picks a parsing action from a list of options</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">-- (determines the 'Monad' @m@, e.g., for randomness).</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513696"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- ^ the input piece</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- ^ the full parse or an error message</span><span>
</span><span id="line-181"></span><span id="parseGreedy"><span class="annot"><span class="annottext">parseGreedy :: forall (m :: * -&gt; *) tr tr' slc slc' s f h.
(Monad m, MonadIO m, Show tr', Show slc, Show tr, Show s, Show f,
 Show h) =&gt;
Eval tr tr' slc slc' (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String m (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-var hs-var">parseGreedy</span></a></span></span><span> </span><span id="local-6989586621679513297"><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679513296"><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679513296"><span class="hs-identifier hs-var">pick</span></a></span></span><span> </span><span id="local-6989586621679513295"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513295"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679513294"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513294"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513293"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513293"><span class="hs-identifier hs-var">deriv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall {tr} {op}. GreedyState tr tr' slc op
</span><a href="#local-6989586621679513291"><span class="hs-identifier hs-var">initState</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s f h tr slc.
[Leftmost s f h] -&gt; Path tr slc -&gt; Analysis s f h tr slc
</span><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513293"><span class="hs-identifier hs-var">deriv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513294"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-184"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679513291"><span class="annot"><span class="annottext">initState :: GreedyState tr tr' slc op
</span><a href="#local-6989586621679513291"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-var">GSFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679513289"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; Path a b
</span><a href="Common.html#reversePath"><span class="hs-identifier hs-var">reversePath</span></a></span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513295"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- prepare the input: eval slices, wrap in Inner, add Start/Stop</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="#local-6989586621679513289"><span class="hs-identifier hs-type">wrapPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513696"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679513289"><span class="annot"><span class="annottext">wrapPath :: Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679513289"><span class="hs-identifier hs-var hs-var">wrapPath</span></a></span></span><span> </span><span id="local-6989586621679513287"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513287"><span class="hs-identifier hs-var">eleft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513286"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679513286"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513287"><span class="hs-identifier hs-var">eleft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tr tr' slc slc' v. Eval tr tr' slc slc' v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var">evalSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679513286"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="#local-6989586621679513289"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span id="local-6989586621679513284"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513284"><span class="hs-identifier hs-var">eleft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513283"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679513283"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679513282"><span class="annot"><span class="annottext">tr'
</span><a href="#local-6989586621679513282"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679513281"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513281"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513284"><span class="hs-identifier hs-var">eleft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tr tr' slc slc' v. Eval tr tr' slc slc' v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var">evalSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679513283"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679513289"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">tr'
</span><a href="#local-6989586621679513282"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513281"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- parsing loop</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="#local-6989586621679513292"><span class="hs-identifier hs-type">parse</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- case 1: everything frozen</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679513292"><span class="annot"><span class="annottext">parse :: GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679513280"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679513280"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- liftIO $ putStrLn &quot;&quot; &gt;&gt; print state</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679513280"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679513279"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513279"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513279"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-comment">-- only one transition: unfreeze and terminate</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513278"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513278"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513277"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513277"><span class="hs-identifier hs-var">thawed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513276"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513276"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-205"></span><span>            </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (Trans tr, LeftmostSingle s f)
</span><a href="#local-6989586621679513275"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-206"></span><span>              </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513274"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513278"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-207"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513277"><span class="hs-identifier hs-var">thawed</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513276"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-comment">-- several transition: unfreeze last and continue</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513270"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513270"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679513269"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513269"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679513268"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513268"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679513267"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513267"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513266"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513266"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (Trans tr, LeftmostSingle s f)
</span><a href="#local-6989586621679513275"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513274"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513269"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513270"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-211"></span><span>          </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513268"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513269"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513267"><span class="hs-identifier hs-var">thawed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513266"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- case 2: everything open</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679513264"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513264"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679513263"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513263"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513264"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-comment">-- only one transition: terminate</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513262"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513262"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513262"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513263"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-comment">-- two transitions: unsplit single and terminate</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513261"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513261"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679513260"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513260"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513259"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513259"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513258"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513258"><span class="hs-identifier hs-var">ttop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513257"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513257"><span class="hs-identifier hs-var">optop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (Trans tr, LeftmostSingle s f)
</span><a href="#local-6989586621679513275"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-221"></span><span>              </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513256"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513261"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513260"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513259"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513258"><span class="hs-identifier hs-var">ttop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513257"><span class="hs-identifier hs-var">optop</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513263"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-comment">-- more than two transitions: pick double operation and continue</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513255"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513255"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679513254"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513254"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513253"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513253"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679513252"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513252"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679513251"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513251"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679513250"><span class="annot"><span class="annottext">doubles :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513250"><span class="hs-identifier hs-var hs-var">doubles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Path (Trans tr) slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513249"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513255"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513254"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513253"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513252"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513251"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513248"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513248"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513247"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513247"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513246"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513246"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513245"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513245"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513250"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span>
</span><span id="line-229"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513248"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513247"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513251"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513246"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513245"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513263"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-comment">-- case 3: some parts frozen, some open</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679513241"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679513240"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679513239"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679513238"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-comment">-- only one open transition: thaw</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513237"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513237"><span class="hs-identifier hs-var">topen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-236"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513236"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513236"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513235"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513235"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513234"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513234"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-238"></span><span>              </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-239"></span><span>                </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513236"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513237"><span class="hs-identifier hs-var">topen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-240"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513235"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513234"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513232"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513232"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679513231"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513231"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679513230"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513230"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513229"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513229"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513228"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513228"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-243"></span><span>              </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-244"></span><span>                </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513231"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513232"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513237"><span class="hs-identifier hs-var">topen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-246"></span><span>              </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-247"></span><span>                </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513230"><span class="hs-identifier hs-var">rstFrozen</span></a></span><span>
</span><span id="line-248"></span><span>                </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513231"><span class="hs-identifier hs-var">sfrozen</span></a></span><span>
</span><span id="line-249"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513229"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513228"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-comment">-- two open transitions: thaw or unsplit single</span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513227"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513227"><span class="hs-identifier hs-var">topenl</span></a></span></span><span> </span><span id="local-6989586621679513226"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513226"><span class="hs-identifier hs-var">sopen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513225"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513225"><span class="hs-identifier hs-var">topenr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-254"></span><span>            </span><span id="local-6989586621679513223"><span class="annot"><span class="annottext">unsplits :: [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679513223"><span class="hs-identifier hs-var hs-var">unsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>              </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513256"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513227"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513226"><span class="hs-identifier hs-var">sopen</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513225"><span class="hs-identifier hs-var">topenr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513221"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513221"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>              </span><span class="hs-keyword">let</span><span>
</span><span id="line-259"></span><span>                </span><span id="local-6989586621679513219"><span class="annot"><span class="annottext">thaws :: [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679513219"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-261"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513221"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513227"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513226"><span class="hs-identifier hs-var">sopen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>              </span><span id="local-6989586621679513218"><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513218"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679513296"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679513219"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {b}. [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679513223"><span class="hs-identifier hs-var">unsplits</span></a></span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513218"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-264"></span><span>                </span><span class="hs-comment">-- picked unsplit</span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513217"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513217"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513216"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513216"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-267"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-268"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-269"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-270"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513217"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513216"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>                </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-273"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513215"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513215"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513214"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513214"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513215"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513214"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513213"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513213"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679513212"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513212"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679513211"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513211"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679513209"><span class="annot"><span class="annottext">thaws :: [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679513209"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-278"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span>
</span><span id="line-279"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513212"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>                        </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513213"><span class="hs-identifier hs-var">tfrozen</span></a></span><span>
</span><span id="line-281"></span><span>                        </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-282"></span><span>                        </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513227"><span class="hs-identifier hs-var">topenl</span></a></span><span>
</span><span id="line-283"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513226"><span class="hs-identifier hs-var">sopen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>              </span><span id="local-6989586621679513208"><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513208"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679513296"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679513209"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {b}. [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679513223"><span class="hs-identifier hs-var">unsplits</span></a></span><span>
</span><span id="line-285"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513208"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-286"></span><span>                </span><span class="hs-comment">-- picked unsplit</span><span>
</span><span id="line-287"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513207"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513207"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513206"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513206"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-289"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-290"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-291"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-292"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513207"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513206"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>                </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-295"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513205"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513205"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513204"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513204"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-297"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-298"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513211"><span class="hs-identifier hs-var">rstFrozen</span></a></span><span>
</span><span id="line-299"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513212"><span class="hs-identifier hs-var">sfrozen</span></a></span><span>
</span><span id="line-300"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513205"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513204"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-comment">-- more than two open transitions: thaw or any double operation</span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513203"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513203"><span class="hs-identifier hs-var">topenl</span></a></span></span><span> </span><span id="local-6989586621679513202"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513202"><span class="hs-identifier hs-var">sopenl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513201"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513201"><span class="hs-identifier hs-var">topenm</span></a></span></span><span> </span><span id="local-6989586621679513200"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513200"><span class="hs-identifier hs-var">sopenr</span></a></span></span><span> </span><span id="local-6989586621679513199"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513199"><span class="hs-identifier hs-var">rstOpen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679513198"><span class="annot"><span class="annottext">doubles :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513198"><span class="hs-identifier hs-var hs-var">doubles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>                </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Path (Trans tr) slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513249"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513203"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513202"><span class="hs-identifier hs-var">sopenl</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513201"><span class="hs-identifier hs-var">topenm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513200"><span class="hs-identifier hs-var">sopenr</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513199"><span class="hs-identifier hs-var">rstOpen</span></a></span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513197"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513197"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679513196"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513196"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>                    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513197"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513203"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513202"><span class="hs-identifier hs-var">sopenl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>              </span><span id="local-6989586621679513195"><span class="annot"><span class="annottext">((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513195"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513196"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513198"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-311"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513195"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513194"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513194"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513193"><span class="annot"><span class="annottext">op :: LeftmostDouble s f h
</span><a href="#local-6989586621679513193"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513194"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513193"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                </span><span class="hs-comment">-- picked non-thaw</span><span>
</span><span id="line-316"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513191"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513191"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513190"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513190"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513189"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513189"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513188"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513188"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-317"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-318"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-319"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-320"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-321"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513191"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513190"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513199"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513189"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513188"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>            </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513187"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513187"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679513186"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513186"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679513185"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513185"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>              </span><span class="hs-keyword">let</span><span>
</span><span id="line-325"></span><span>                </span><span id="local-6989586621679513184"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513184"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>                  </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span>
</span><span id="line-327"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513186"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                    </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513187"><span class="hs-identifier hs-var">tfrozen</span></a></span><span>
</span><span id="line-329"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-330"></span><span>                    </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513203"><span class="hs-identifier hs-var">topenl</span></a></span><span>
</span><span id="line-331"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513202"><span class="hs-identifier hs-var">sopenl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>              </span><span id="local-6989586621679513183"><span class="annot"><span class="annottext">((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513183"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513184"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513198"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-333"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513183"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>                </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-335"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513182"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513182"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513181"><span class="annot"><span class="annottext">op :: LeftmostDouble s f h
</span><a href="#local-6989586621679513181"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-337"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-338"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513185"><span class="hs-identifier hs-var">rstFrozen</span></a></span><span>
</span><span id="line-339"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513186"><span class="hs-identifier hs-var">sfrozen</span></a></span><span>
</span><span id="line-340"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513182"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513239"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513181"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>                </span><span class="hs-comment">-- picked non-thaw</span><span>
</span><span id="line-343"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679513180"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513180"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513179"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513179"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513178"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513178"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513177"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513177"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-344"></span><span>                  </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679513292"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-345"></span><span>                    </span><span class="annot"><span class="annottext">forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path (Trans tr) slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-346"></span><span>                      </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679513241"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-347"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513240"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-348"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513180"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513179"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513199"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513178"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513177"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679513238"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><a href="#local-6989586621679513275"><span class="hs-identifier hs-type">pickSingle</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679513275"><span class="annot"><span class="annottext">pickSingle :: [ActionSingle slc tr s f]
-&gt; ExceptT String m (Trans tr, LeftmostSingle s f)
</span><a href="#local-6989586621679513275"><span class="hs-identifier hs-var hs-var">pickSingle</span></a></span></span><span> </span><span id="local-6989586621679513176"><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
</span><a href="#local-6989586621679513176"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;pickSingle &quot; &lt;&gt; show actions</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679513175"><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513175"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679513296"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
</span><a href="#local-6989586621679513176"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513175"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513174"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513174"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513173"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513173"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513174"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513173"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pickSingle returned a double action&quot;</span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="#local-6989586621679513244"><span class="hs-identifier hs-type">pickDouble</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679513244"><span class="annot"><span class="annottext">pickDouble :: [ActionDouble slc tr s f h]
-&gt; ExceptT
     String m ((Trans tr, slc, Trans tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679513244"><span class="hs-identifier hs-var hs-var">pickDouble</span></a></span></span><span> </span><span id="local-6989586621679513172"><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513172"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;pickDouble &quot; &lt;&gt; show actions</span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621679513171"><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513171"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679513296"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513172"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679513171"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pickDouble returned a single action&quot;</span></span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513170"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513170"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513169"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513169"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513168"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513168"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513167"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513167"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513170"><span class="hs-identifier hs-var">topl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513169"><span class="hs-identifier hs-var">tops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513168"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513167"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="#local-6989586621679513274"><span class="hs-identifier hs-type">collectThawSingle</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679513274"><span class="annot"><span class="annottext">collectThawSingle :: StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513274"><span class="hs-identifier hs-var hs-var">collectThawSingle</span></a></span></span><span> </span><span id="local-6989586621679513166"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513166"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679513165"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513165"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679513164"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513164"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><span class="annottext">forall {tr} {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679513163"><span class="hs-identifier hs-var">getAction</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513166"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513165"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513164"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679513163"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679513163"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513161"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513161"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513160"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513160"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513160"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679513159"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513159"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr s f.
(StartStop slc, Trans tr, StartStop slc)
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
</span><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513166"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513161"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513164"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513159"><span class="hs-identifier hs-var">sop</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="#local-6989586621679513233"><span class="hs-identifier hs-type">collectThawLeft</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-384"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679513702"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-385"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-386"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-387"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-388"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-389"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621679513233"><span class="annot"><span class="annottext">collectThawLeft :: StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513233"><span class="hs-identifier hs-var hs-var">collectThawLeft</span></a></span></span><span> </span><span id="local-6989586621679513158"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513158"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679513157"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513157"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679513156"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513156"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513155"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513155"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513154"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513154"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><span class="annottext">forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513153"><span class="hs-identifier hs-var">getAction</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513158"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679513157"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513156"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679513153"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513153"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513152"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513152"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513151"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513151"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513151"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679513150"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513150"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr s f h.
(StartStop slc, Trans tr, slc, Trans tr, StartStop slc)
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513158"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513152"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513156"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513155"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513154"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513150"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="#local-6989586621679513256"><span class="hs-identifier hs-type">collectUnsplitSingle</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-402"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-403"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-404"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-405"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-406"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679513256"><span class="annot"><span class="annottext">collectUnsplitSingle :: StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="#local-6989586621679513256"><span class="hs-identifier hs-var hs-var">collectUnsplitSingle</span></a></span></span><span> </span><span id="local-6989586621679513149"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513149"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513148"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513148"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513147"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513147"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513146"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513146"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513145"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513145"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall {tr} {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679513144"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513149"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513148"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513147"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513146"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513145"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span>
</span><span id="line-410"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679513144"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679513144"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513141"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513141"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513140"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513140"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513140"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679513139"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513139"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr s f.
(StartStop slc, Trans tr, StartStop slc)
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
</span><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513149"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513141"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513145"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679513139"><span class="hs-identifier hs-var">sop</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="#local-6989586621679513138"><span class="hs-identifier hs-type">collectUnsplitLeft</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-417"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-418"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-419"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-420"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-421"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-422"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-423"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679513138"><span class="annot"><span class="annottext">collectUnsplitLeft :: StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513138"><span class="hs-identifier hs-var hs-var">collectUnsplitLeft</span></a></span></span><span> </span><span id="local-6989586621679513137"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513137"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513136"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513136"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513135"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513135"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513134"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513134"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513133"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513133"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513132"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513132"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513131"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513131"><span class="hs-identifier hs-var">send</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513130"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513137"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513136"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513135"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513134"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513133"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-427"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679513130"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513130"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513128"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513128"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513127"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513127"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513127"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-430"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679513126"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513126"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-432"></span><span>          </span><span class="annot"><span class="annottext">forall slc tr s f h.
(StartStop slc, Trans tr, slc, Trans tr, StartStop slc)
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513137"><span class="hs-identifier hs-var">sstart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513128"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513133"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513132"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513131"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513126"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="#local-6989586621679513125"><span class="hs-identifier hs-type">collectUnsplitRight</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-438"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-439"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-440"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-441"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-442"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-443"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-444"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-445"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621679513125"><span class="annot"><span class="annottext">collectUnsplitRight :: StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513125"><span class="hs-identifier hs-var hs-var">collectUnsplitRight</span></a></span></span><span> </span><span id="local-6989586621679513124"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513124"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679513123"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513123"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679513122"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513122"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513121"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513121"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679513120"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679513120"><span class="hs-identifier hs-var">m2nd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513119"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513119"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513118"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513118"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513117"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513117"><span class="hs-identifier hs-var">send</span></a></span></span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679513120"><span class="hs-identifier hs-var">m2nd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513115"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-450"></span><span>          </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513122"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513121"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513119"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513118"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513117"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-451"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679513115"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513115"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513113"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513113"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513112"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513112"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513112"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679513111"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513111"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall slc tr s f h.
(StartStop slc, Trans tr, slc, Trans tr, StartStop slc)
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513124"><span class="hs-identifier hs-var">sstart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513123"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513122"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513113"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513117"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513111"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><a href="#local-6989586621679513110"><span class="hs-identifier hs-type">collectUnspreads</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-459"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-460"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-461"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-462"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-463"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-464"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-465"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513701"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513700"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513698"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513697"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-466"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621679513110"><span class="annot"><span class="annottext">collectUnspreads :: StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513110"><span class="hs-identifier hs-var hs-var">collectUnspreads</span></a></span></span><span> </span><span id="local-6989586621679513109"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513109"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513108"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513108"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513107"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513107"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513106"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513106"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513105"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513105"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679513104"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513104"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513103"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513103"><span class="hs-identifier hs-var">send</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-comment">-- List</span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679513102"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513102"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513101"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513101"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513107"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513106"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513105"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>      </span><span id="local-6989586621679513099"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513099"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513108"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513107"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513102"><span class="hs-identifier hs-var">sTop</span></a></span><span>
</span><span id="line-472"></span><span>      </span><span id="local-6989586621679513097"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513097"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513297"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513105"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513104"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513102"><span class="hs-identifier hs-var">sTop</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {tr} {s} {f} {h}.
tr
-&gt; slc -&gt; tr -&gt; Leftmost s f h -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513095"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513099"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513102"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513097"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513101"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-474"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-comment">-- pure $ getAction $ evalUnsplit eval (Inner sl) tm sr tr send RightOfTwo</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621679513095"><span class="annot"><span class="annottext">getAction :: tr
-&gt; slc -&gt; tr -&gt; Leftmost s f h -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679513095"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span id="local-6989586621679513094"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513094"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679513093"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513093"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679513092"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513092"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679513091"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513091"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679513091"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-479"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679513090"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513090"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-481"></span><span>          </span><span class="annot"><span class="annottext">forall slc tr s f h.
(StartStop slc, Trans tr, slc, Trans tr, StartStop slc)
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span>
</span><span id="line-482"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513109"><span class="hs-identifier hs-var">sstart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513094"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513093"><span class="hs-identifier hs-var">sTop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall tr. tr -&gt; Bool -&gt; Trans tr
</span><a href="GreedyParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679513092"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513103"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>            </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679513090"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>  </span><span id="local-6989586621679513249"><span class="annot"><span class="annottext">collectDoubles :: StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Path (Trans tr) slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513249"><span class="hs-identifier hs-var hs-var">collectDoubles</span></a></span></span><span> </span><span id="local-6989586621679513087"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513087"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679513086"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513086"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679513085"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513085"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679513084"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513084"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679513083"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513083"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679513082"><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513082"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513081"><span class="hs-identifier hs-var">leftUnsplits</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513080"><span class="hs-identifier hs-var">rightUnsplits</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513079"><span class="hs-identifier hs-var">unspreads</span></a></span><span>
</span><span id="line-486"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679513078"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513078"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679513077"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513077"><span class="hs-identifier hs-var">send</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><a href="#local-6989586621679513082"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679513076"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513076"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513076"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679513075"><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513075"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679513074"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513074"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Path (Trans tr) slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513075"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513074"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679513081"><span class="annot"><span class="annottext">leftUnsplits :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513081"><span class="hs-identifier hs-var hs-var">leftUnsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513138"><span class="hs-identifier hs-var">collectUnsplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513087"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513086"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513085"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513084"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513083"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513078"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513077"><span class="hs-identifier hs-var">send</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679513080"><span class="annot"><span class="annottext">rightUnsplits :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513080"><span class="hs-identifier hs-var hs-var">rightUnsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513125"><span class="hs-identifier hs-var">collectUnsplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513087"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513086"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513085"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513084"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513083"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513078"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513077"><span class="hs-identifier hs-var">send</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span id="local-6989586621679513079"><span class="annot"><span class="annottext">unspreads :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513079"><span class="hs-identifier hs-var hs-var">unspreads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; slc
-&gt; Trans tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679513110"><span class="hs-identifier hs-var">collectUnspreads</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513087"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513086"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513085"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513084"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679513083"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Trans tr
</span><a href="#local-6989586621679513078"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679513077"><span class="hs-identifier hs-var">send</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">{- | A policy that picks the next action at random.
 Must be partially applied with a random generator before passing to 'parseGreedy'.
-}</span><span>
</span><span id="line-497"></span><span id="local-6989586621679513578"><span id="local-6989586621679513580"><span id="local-6989586621679513581"><span class="annot"><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-type">pickRandom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679513581"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513581"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679513578"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679513580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513578"><span class="hs-identifier hs-type">slc</span></a></span></span></span></span><span>
</span><span id="line-498"></span><span id="pickRandom"><span class="annot"><span class="annottext">pickRandom :: forall g (m :: * -&gt; *) slc.
StatefulGen g m =&gt;
g -&gt; [slc] -&gt; ExceptT String m slc
</span><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var hs-var">pickRandom</span></a></span></span><span> </span><span class="annot"><span class="annottext">g
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No candidates for pickRandom!&quot;</span></span><span>
</span><span id="line-499"></span><span class="annot"><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a></span><span> </span><span id="local-6989586621679513052"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513052"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679513051"><span class="annot"><span class="annottext">[slc]
</span><a href="#local-6989586621679513051"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679513050"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679513050"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
</span><span class="hs-identifier hs-var">uniformRM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[slc]
</span><a href="#local-6989586621679513051"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513052"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[slc]
</span><a href="#local-6989586621679513051"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679513050"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- * Entry Points</span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-comment">-- | Parse a piece randomly using a fresh random number generator.</span><span>
</span><span id="line-506"></span><span id="local-6989586621679513554"><span id="local-6989586621679513555"><span id="local-6989586621679513556"><span id="local-6989586621679513557"><span id="local-6989586621679513558"><span id="local-6989586621679513559"><span id="local-6989586621679513560"><span class="annot"><a href="GreedyParser.html#parseRandom"><span class="hs-identifier hs-type">parseRandom</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513560"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513559"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513558"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513557"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513556"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513555"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513558"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513560"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513559"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513554"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513557"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513556"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513555"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-comment">-- ^ the grammar's evaluator</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513554"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513560"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-comment">-- ^ the input piece</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513557"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513556"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513555"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513558"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513559"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-comment">-- ^ a random reduction of the piece (or an error message)</span><span>
</span><span id="line-514"></span><span id="parseRandom"><span class="annot"><span class="annottext">parseRandom :: forall tr' slc tr s f h slc'.
(Show tr', Show slc, Show tr, Show s, Show f, Show h) =&gt;
Eval tr tr' slc slc' (Leftmost s f h)
-&gt; Path slc' tr' -&gt; ExceptT String IO (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseRandom"><span class="hs-identifier hs-var hs-var">parseRandom</span></a></span></span><span> </span><span id="local-6989586621679513017"><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513017"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679513016"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513016"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621679513015"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679513015"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">initStdGen</span></span><span>
</span><span id="line-516"></span><span>  </span><span id="local-6989586621679513014"><span class="annot"><span class="annottext">IOGenM StdGen
</span><a href="#local-6989586621679513014"><span class="hs-identifier hs-var">mgen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) g. MonadIO m =&gt; g -&gt; m (IOGenM g)
</span><span class="hs-identifier hs-var">newIOGenM</span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679513015"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tr tr' slc slc' s f h.
(Monad m, MonadIO m, Show tr', Show slc, Show tr, Show s, Show f,
 Show h) =&gt;
Eval tr tr' slc slc' (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String m (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-var">parseGreedy</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679513017"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *) slc.
StatefulGen g m =&gt;
g -&gt; [slc] -&gt; ExceptT String m slc
</span><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a></span><span> </span><span class="annot"><span class="annottext">IOGenM StdGen
</span><a href="#local-6989586621679513014"><span class="hs-identifier hs-var">mgen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679513016"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- | Parse a piece randomly using an existing random number generator.</span><span>
</span><span id="line-520"></span><span id="local-6989586621679513531"><span id="local-6989586621679513532"><span id="local-6989586621679513533"><span id="local-6989586621679513534"><span id="local-6989586621679513535"><span id="local-6989586621679513536"><span id="local-6989586621679513537"><span id="local-6989586621679513538"><span class="annot"><a href="GreedyParser.html#parseRandom%27"><span class="hs-identifier hs-type">parseRandom'</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513538"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513537"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513536"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513535"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513534"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679513533"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679513532"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513532"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-comment">-- ^ a random number generator</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513536"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513538"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513537"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513531"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513535"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513533"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-comment">-- ^ the grammar's evaluator</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513531"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513538"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-comment">-- ^ the input piece</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513535"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513533"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513536"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513537"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-comment">-- ^ a random reduction of the piece (or an error message)</span><span>
</span><span id="line-530"></span><span id="parseRandom%27"><span class="annot"><span class="annottext">parseRandom' :: forall tr' slc tr s f h g slc'.
(Show tr', Show slc, Show tr, Show s, Show f, Show h,
 StatefulGen g IO) =&gt;
g
-&gt; Eval tr tr' slc slc' (Leftmost s f h)
-&gt; Path slc' tr'
-&gt; ExceptT String IO (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseRandom%27"><span class="hs-identifier hs-var hs-var">parseRandom'</span></a></span></span><span> </span><span id="local-6989586621679512995"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679512995"><span class="hs-identifier hs-var">mgen</span></a></span></span><span> </span><span id="local-6989586621679512994"><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679512994"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679512993"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679512993"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tr tr' slc slc' s f h.
(Monad m, MonadIO m, Show tr', Show slc, Show tr, Show s, Show f,
 Show h) =&gt;
Eval tr tr' slc slc' (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String m (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-var">parseGreedy</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' (Leftmost s f h)
</span><a href="#local-6989586621679512994"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *) slc.
StatefulGen g m =&gt;
g -&gt; [slc] -&gt; ExceptT String m slc
</span><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679512995"><span class="hs-identifier hs-var">mgen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679512993"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-532"></span></pre></body></html>