<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ApplicativeDo #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{- | This module contains common datatypes and functions specific to the protovoice grammar.
 In a protovoice derivations, slices are multisets of notes
 while transitions contain connections between these notes.

 Code that is specific to parsing can be found in &quot;PVGrammar.Parse&quot;,
 while generative code is located in &quot;PVGrammar.Generate&quot;.
-}</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PVGrammar</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Inner Structure Types</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Slices: Notes</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier">Notes</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#innerNotes"><span class="hs-identifier">innerNotes</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Transitions: Sets of Obligatory Edges</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Transitions contain two kinds of edges, regular edges and passing edges.</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier">Edges</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#topEdges"><span class="hs-identifier">topEdges</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier">Edge</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier">InnerEdge</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generative Operations</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Freeze</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier">Freeze</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Split</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier">Split</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#DoubleOrnament"><span class="hs-identifier">DoubleOrnament</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#isRepetitionOnLeft"><span class="hs-identifier">isRepetitionOnLeft</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#isRepetitionOnRight"><span class="hs-identifier">isRepetitionOnRight</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#PassingOrnament"><span class="hs-identifier">PassingOrnament</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#LeftOrnament"><span class="hs-identifier">LeftOrnament</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#RightOrnament"><span class="hs-identifier">RightOrnament</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Spread</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier">Spread</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier">SpreadDirection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Derivations</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#PVLeftmost"><span class="hs-identifier">PVLeftmost</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier">PVAnalysis</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#analysisTraversePitch"><span class="hs-identifier">analysisTraversePitch</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#analysisMapPitch"><span class="hs-identifier">analysisMapPitch</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Loading Files</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#loadAnalysis"><span class="hs-identifier">loadAnalysis</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#loadAnalysis%27"><span class="hs-identifier">loadAnalysis'</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier">slicesFromFile</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#slicesToPath"><span class="hs-identifier">slicesToPath</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#loadSurface"><span class="hs-identifier">loadSurface</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#loadSurface%27"><span class="hs-identifier">loadSurface'</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Pitch</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Interval</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Notation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pitch</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SInterval</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SPC</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SPitch</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pc</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.:)</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.IO</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">for</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Internal.MultiSet.html"><span class="hs-identifier">Internal.MultiSet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MS</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Core</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Music</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Core.Slicing</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Music</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.MusicXML</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MusicXML</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- * Inner Structure Types</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- ** Slice Type: Sets of Notes</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Slices contain a multiset of notes.</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">{- | The content type of slices in the protovoice model.
 Contains a multiset of pitches, representing the notes in a slice.
-}</span><span>
</span><span id="line-105"></span><span id="local-6989586621679457254"><span id="local-6989586621679457255"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Notes"><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-var">Notes</span></a></span></span><span> </span><span id="local-6989586621679458636"><span class="annot"><a href="#local-6989586621679458636"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Notes"><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-var">Notes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Internal.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MS.MultiSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458636"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679457245"><span id="local-6989586621679457250"><span class="annot"><span class="annottext">Notes n -&gt; Notes n -&gt; Bool
forall n. Eq n =&gt; Notes n -&gt; Notes n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Notes n -&gt; Notes n -&gt; Bool
$c/= :: forall n. Eq n =&gt; Notes n -&gt; Notes n -&gt; Bool
== :: Notes n -&gt; Notes n -&gt; Bool
$c== :: forall n. Eq n =&gt; Notes n -&gt; Notes n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457210"><span id="local-6989586621679457214"><span id="local-6989586621679457218"><span id="local-6989586621679457222"><span id="local-6989586621679457226"><span id="local-6989586621679457230"><span id="local-6989586621679457235"><span class="annot"><span class="annottext">Notes n -&gt; Notes n -&gt; Bool
Notes n -&gt; Notes n -&gt; Ordering
Notes n -&gt; Notes n -&gt; Notes n
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {n}. Ord n =&gt; Eq (Notes n)
forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Bool
forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Ordering
forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Notes n
min :: Notes n -&gt; Notes n -&gt; Notes n
$cmin :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Notes n
max :: Notes n -&gt; Notes n -&gt; Notes n
$cmax :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Notes n
&gt;= :: Notes n -&gt; Notes n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Bool
&gt; :: Notes n -&gt; Notes n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Bool
&lt;= :: Notes n -&gt; Notes n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Bool
&lt; :: Notes n -&gt; Notes n -&gt; Bool
$c&lt; :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Bool
compare :: Notes n -&gt; Notes n -&gt; Ordering
$ccompare :: forall n. Ord n =&gt; Notes n -&gt; Notes n -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall n x. Rep (Notes n) x -&gt; Notes n
forall n x. Notes n -&gt; Rep (Notes n) x
$cto :: forall n x. Rep (Notes n) x -&gt; Notes n
$cfrom :: forall n x. Notes n -&gt; Rep (Notes n) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679457201"><span class="annot"><span class="annottext">forall n. NFData n =&gt; Notes n -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Notes n -&gt; ()
$crnf :: forall n. NFData n =&gt; Notes n -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457194"><span id="local-6989586621679457196"><span class="annot"><span class="annottext">forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall {n}. Hashable n =&gt; Eq (Notes n)
forall n. Hashable n =&gt; Int -&gt; Notes n -&gt; Int
forall n. Hashable n =&gt; Notes n -&gt; Int
hash :: Notes n -&gt; Int
$chash :: forall n. Hashable n =&gt; Notes n -&gt; Int
hashWithSalt :: Int -&gt; Notes n -&gt; Int
$chashWithSalt :: forall n. Hashable n =&gt; Int -&gt; Notes n -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679457188"><span id="local-6989586621679457191"><span id="local-6989586621679458627"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458627"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458627"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679457171"><span class="annot"><span class="annottext">show :: Notes n -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span id="local-6989586621679457169"><span class="annot"><span class="annottext">MultiSet n
</span><a href="#local-6989586621679457169"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {i} {b}.
(Notation i, Eq b, Num b, Show b) =&gt;
(i, b) -&gt; String
</span><a href="#local-6989586621679457167"><span class="hs-identifier hs-var">showNote</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k. MultiSet k -&gt; [(k, Int)]
</span><a href="Internal.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">MS.toOccurList</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet n
</span><a href="#local-6989586621679457169"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-112"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679457167"><span class="annot"><span class="annottext">showNote :: (i, b) -&gt; String
</span><a href="#local-6989586621679457167"><span class="hs-identifier hs-var hs-var">showNote</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679457158"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679457158"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457157"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679457157"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679457158"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457155"><span class="hs-identifier hs-var">mult</span></a></span><span>
</span><span id="line-114"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679457155"><span class="annot"><span class="annottext">mult :: String
</span><a href="#local-6989586621679457155"><span class="hs-identifier hs-var hs-var">mult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679457157"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#215;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679457157"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679457144"><span id="local-6989586621679458646"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458646"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458646"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458646"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458646"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679457131"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Notes n)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Array -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withArray</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List of Notes&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679457128"><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679457128"><span class="hs-identifier hs-var">notes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679457127"><span class="annot"><span class="annottext">Vector n
</span><a href="#local-6989586621679457127"><span class="hs-identifier hs-var">pitches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679457128"><span class="hs-identifier hs-var">notes</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall n. MultiSet n -&gt; Notes n
</span><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-var">Notes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a.
(Foldable t, Eq a, Hashable a) =&gt;
t a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#fromList"><span class="hs-identifier hs-var">MS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Vector n
</span><a href="#local-6989586621679457127"><span class="hs-identifier hs-var">pitches</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">{- | Return the notes or start/stop symbols inside a slice.
 This is useful to get all objects that an 'Edge' can connect to.
-}</span><span>
</span><span id="line-125"></span><span id="local-6989586621679458600"><span class="annot"><a href="PVGrammar.html#innerNotes"><span class="hs-identifier hs-type">innerNotes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458600"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-126"></span><span id="innerNotes"><span class="annot"><span class="annottext">innerNotes :: forall n. StartStop (Notes n) -&gt; [StartStop n]
</span><a href="PVGrammar.html#innerNotes"><span class="hs-identifier hs-var hs-var">innerNotes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span id="local-6989586621679457121"><span class="annot"><span class="annottext">MultiSet n
</span><a href="#local-6989586621679457121"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k. MultiSet k -&gt; [k]
</span><a href="Internal.MultiSet.html#distinctElems"><span class="hs-identifier hs-var">MS.distinctElems</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet n
</span><a href="#local-6989586621679457121"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-127"></span><span class="annot"><a href="PVGrammar.html#innerNotes"><span class="hs-identifier hs-var">innerNotes</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (Notes n)
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span class="annot"><a href="PVGrammar.html#innerNotes"><span class="hs-identifier hs-var">innerNotes</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (Notes n)
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- TODO: could this be improved to forbid start/stop symbols on the wrong side?</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | A proto-voice edge between two nodes (i.e. notes or start/stop symbols).</span><span>
</span><span id="line-133"></span><span class="hs-keyword">type</span><span> </span><span id="Edge"><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span></span><span> </span><span id="local-6989586621679457117"><span class="annot"><a href="#local-6989586621679457117"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679457117"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679457117"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | A proto-voice edge between two notes (excluding start/stop symbols).</span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span id="InnerEdge"><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-var">InnerEdge</span></a></span></span><span> </span><span id="local-6989586621679457116"><span class="annot"><a href="#local-6989586621679457116"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679457116"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679457116"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">{- | The content type of transitions in the protovoice model.
 Contains a multiset of regular edges and a multiset of passing edges.
 The represented edges are those that are definitely used later on.
 Edges that are not used are dropped before creating a child transition.
 A transition that contains passing edges cannot be frozen.
-}</span><span>
</span><span id="line-144"></span><span id="local-6989586621679457114"><span id="local-6989586621679457115"></span></span><span class="hs-keyword">data</span><span> </span><span id="Edges"><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span></span><span> </span><span id="local-6989586621679458595"><span class="annot"><a href="#local-6989586621679458595"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Edges"><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="edgesReg"><span class="annot"><span class="annottext">forall n. Edges n -&gt; HashSet (Edge n)
</span><a href="PVGrammar.html#edgesReg"><span class="hs-identifier hs-var hs-var">edgesReg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458595"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- ^ regular edges</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="edgesPass"><span class="annot"><span class="annottext">forall n. Edges n -&gt; MultiSet (InnerEdge n)
</span><a href="PVGrammar.html#edgesPass"><span class="hs-identifier hs-var hs-var">edgesPass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Internal.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MS.MultiSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458595"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- ^ passing edges</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679457102"><span id="local-6989586621679457109"><span class="annot"><span class="annottext">Edges n -&gt; Edges n -&gt; Bool
forall n. Eq n =&gt; Edges n -&gt; Edges n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Edges n -&gt; Edges n -&gt; Bool
$c/= :: forall n. Eq n =&gt; Edges n -&gt; Edges n -&gt; Bool
== :: Edges n -&gt; Edges n -&gt; Bool
$c== :: forall n. Eq n =&gt; Edges n -&gt; Edges n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457070"><span id="local-6989586621679457072"><span id="local-6989586621679457075"><span id="local-6989586621679457078"><span id="local-6989586621679457081"><span id="local-6989586621679457087"><span id="local-6989586621679457094"><span class="annot"><span class="annottext">Edges n -&gt; Edges n -&gt; Bool
Edges n -&gt; Edges n -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {n}. Ord n =&gt; Eq (Edges n)
forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Bool
forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Ordering
forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Edges n
min :: Edges n -&gt; Edges n -&gt; Edges n
$cmin :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Edges n
max :: Edges n -&gt; Edges n -&gt; Edges n
$cmax :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Edges n
&gt;= :: Edges n -&gt; Edges n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Bool
&gt; :: Edges n -&gt; Edges n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Bool
&lt;= :: Edges n -&gt; Edges n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Bool
&lt; :: Edges n -&gt; Edges n -&gt; Bool
$c&lt; :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Bool
compare :: Edges n -&gt; Edges n -&gt; Ordering
$ccompare :: forall n. Ord n =&gt; Edges n -&gt; Edges n -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall n x. Rep (Edges n) x -&gt; Edges n
forall n x. Edges n -&gt; Rep (Edges n) x
$cto :: forall n x. Rep (Edges n) x -&gt; Edges n
$cfrom :: forall n x. Edges n -&gt; Rep (Edges n) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457060"><span class="annot"><span class="annottext">forall n. NFData n =&gt; Edges n -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Edges n -&gt; ()
$crnf :: forall n. NFData n =&gt; Edges n -&gt; ()
</span><a href="#local-6989586621679457060"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457054"><span id="local-6989586621679457056"><span class="annot"><span class="annottext">forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall {n}. Hashable n =&gt; Eq (Edges n)
forall n. Hashable n =&gt; Int -&gt; Edges n -&gt; Int
forall n. Hashable n =&gt; Edges n -&gt; Int
hash :: Edges n -&gt; Int
$chash :: forall n. Hashable n =&gt; Edges n -&gt; Int
hashWithSalt :: Int -&gt; Edges n -&gt; Int
$chashWithSalt :: forall n. Hashable n =&gt; Int -&gt; Edges n -&gt; Int
</span><a href="#local-6989586621679457054"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679457049"><span id="local-6989586621679457051"><span id="local-6989586621679458583"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458583"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span id="local-6989586621679457035"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679457035"><span class="hs-identifier hs-var">aT</span></a></span></span><span> </span><span id="local-6989586621679457034"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679457034"><span class="hs-identifier hs-var">aPass</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679457033"><span class="annot"><span class="annottext">&lt;&gt; :: Edges n -&gt; Edges n -&gt; Edges n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span id="local-6989586621679457032"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679457032"><span class="hs-identifier hs-var">bT</span></a></span></span><span> </span><span id="local-6989586621679457031"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679457031"><span class="hs-identifier hs-var">bPass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. HashSet (Edge n) -&gt; MultiSet (InnerEdge n) -&gt; Edges n
</span><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679457035"><span class="hs-identifier hs-var">aT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679457032"><span class="hs-identifier hs-var">bT</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679457034"><span class="hs-identifier hs-var">aPass</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679457031"><span class="hs-identifier hs-var">bPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679457024"><span id="local-6989586621679457026"><span id="local-6989586621679458576"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458576"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458576"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458576"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679457014"><span class="annot"><span class="annottext">mempty :: Edges n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. HashSet (Edge n) -&gt; MultiSet (InnerEdge n) -&gt; Edges n
</span><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">forall a. MultiSet a
</span><a href="Internal.MultiSet.html#empty"><span class="hs-identifier hs-var">MS.empty</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679457008"><span id="local-6989586621679457011"><span id="local-6989586621679458573"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458573"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458573"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679457000"><span class="annot"><span class="annottext">show :: Edges n -&gt; String
</span><a href="#local-6989586621679457000"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span id="local-6989586621679456999"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456999"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679456998"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456998"><span class="hs-identifier hs-var">pass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456997"><span class="hs-identifier hs-var">tReg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456996"><span class="hs-identifier hs-var">tPass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-160"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679456997"><span class="annot"><span class="annottext">tReg :: [String]
</span><a href="#local-6989586621679456997"><span class="hs-identifier hs-var hs-var">tReg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456990"><span class="hs-identifier hs-var">showReg</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456999"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679456996"><span class="annot"><span class="annottext">tPass :: [String]
</span><a href="#local-6989586621679456996"><span class="hs-identifier hs-var hs-var">tPass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i} {a}.
(Notation i, Notation i, Show a) =&gt;
((i, i), a) -&gt; String
</span><a href="#local-6989586621679456984"><span class="hs-identifier hs-var">showPass</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k. MultiSet k -&gt; [(k, Int)]
</span><a href="Internal.MultiSet.html#toOccurList"><span class="hs-identifier hs-var">MS.toOccurList</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456998"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679456990"><span class="annot"><span class="annottext">showReg :: (i, i) -&gt; String
</span><a href="#local-6989586621679456990"><span class="hs-identifier hs-var hs-var">showReg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456975"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456975"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456974"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456974"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456975"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456974"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679456984"><span class="annot"><span class="annottext">showPass :: ((i, i), a) -&gt; String
</span><a href="#local-6989586621679456984"><span class="hs-identifier hs-var hs-var">showPass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679456960"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456960"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456959"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456959"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456958"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456958"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456960"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456959"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#215;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456958"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456955"><span id="local-6989586621679458645"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679456925"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Edges n)
</span><a href="#local-6989586621679456925"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Edges&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456923"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456923"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679456922"><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456922"><span class="hs-identifier hs-var">regular</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456923"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;regular&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (StartStop n, StartStop n)
</span><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-var">parseEdge</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679456920"><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456920"><span class="hs-identifier hs-var">passing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456923"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;passing&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (n, n)
</span><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-var">parseInnerEdge</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">forall n. HashSet (Edge n) -&gt; MultiSet (InnerEdge n) -&gt; Edges n
</span><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456922"><span class="hs-identifier hs-var">regular</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a.
(Foldable t, Eq a, Hashable a) =&gt;
t a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#fromList"><span class="hs-identifier hs-var">MS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456920"><span class="hs-identifier hs-var">passing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458645"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | The starting transition of a derivation (@&#8906;&#8212;&#8212;&#8905;@).</span><span>
</span><span id="line-177"></span><span id="local-6989586621679458554"><span class="annot"><a href="PVGrammar.html#topEdges"><span class="hs-identifier hs-type">topEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458554"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458554"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-178"></span><span id="topEdges"><span class="annot"><span class="annottext">topEdges :: forall n. Hashable n =&gt; Edges n
</span><a href="PVGrammar.html#topEdges"><span class="hs-identifier hs-var hs-var">topEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. HashSet (Edge n) -&gt; MultiSet (InnerEdge n) -&gt; Edges n
</span><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Hashable a =&gt; a -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. MultiSet a
</span><a href="Internal.MultiSet.html#empty"><span class="hs-identifier hs-var">MS.empty</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- * Derivation Operations</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Two-sided ornament types (two parents).</span><span>
</span><span id="line-183"></span><span id="local-6989586621679456911"><span id="local-6989586621679456912"></span></span><span class="hs-keyword">data</span><span> </span><span id="DoubleOrnament"><span class="annot"><a href="PVGrammar.html#DoubleOrnament"><span class="hs-identifier hs-var">DoubleOrnament</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | a full neighbor note</span><span>
</span><span id="line-185"></span><span>    </span><span id="FullNeighbor"><span class="annot"><a href="PVGrammar.html#FullNeighbor"><span class="hs-identifier hs-var">FullNeighbor</span></a></span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a repetition of both parents (which have the same pitch)</span><span>
</span><span id="line-187"></span><span>    </span><span id="FullRepeat"><span class="annot"><a href="PVGrammar.html#FullRepeat"><span class="hs-identifier hs-var">FullRepeat</span></a></span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a repetition of the right parent</span><span>
</span><span id="line-189"></span><span>    </span><span id="LeftRepeatOfRight"><span class="annot"><a href="PVGrammar.html#LeftRepeatOfRight"><span class="hs-identifier hs-var">LeftRepeatOfRight</span></a></span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a repetitions of the left parent</span><span>
</span><span id="line-191"></span><span>    </span><span id="RightRepeatOfLeft"><span class="annot"><a href="PVGrammar.html#RightRepeatOfLeft"><span class="hs-identifier hs-var">RightRepeatOfLeft</span></a></span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a note inserted at the top of the piece (between &#8906; and &#8905;)</span><span>
</span><span id="line-193"></span><span>    </span><span id="RootNote"><span class="annot"><a href="PVGrammar.html#RootNote"><span class="hs-identifier hs-var">RootNote</span></a></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456902"><span id="local-6989586621679456904"><span class="annot"><span class="annottext">DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c/= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
== :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c== :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456883"><span id="local-6989586621679456885"><span id="local-6989586621679456888"><span id="local-6989586621679456891"><span id="local-6989586621679456894"><span id="local-6989586621679456896"><span id="local-6989586621679456898"><span class="annot"><span class="annottext">Eq DoubleOrnament
DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
DoubleOrnament -&gt; DoubleOrnament -&gt; Ordering
DoubleOrnament -&gt; DoubleOrnament -&gt; DoubleOrnament
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: DoubleOrnament -&gt; DoubleOrnament -&gt; DoubleOrnament
$cmin :: DoubleOrnament -&gt; DoubleOrnament -&gt; DoubleOrnament
max :: DoubleOrnament -&gt; DoubleOrnament -&gt; DoubleOrnament
$cmax :: DoubleOrnament -&gt; DoubleOrnament -&gt; DoubleOrnament
&gt;= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c&gt;= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
&gt; :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c&gt; :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
&lt;= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c&lt;= :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
&lt; :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
$c&lt; :: DoubleOrnament -&gt; DoubleOrnament -&gt; Bool
compare :: DoubleOrnament -&gt; DoubleOrnament -&gt; Ordering
$ccompare :: DoubleOrnament -&gt; DoubleOrnament -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456877"><span id="local-6989586621679456879"><span id="local-6989586621679456881"><span class="annot"><span class="annottext">Int -&gt; DoubleOrnament -&gt; ShowS
[DoubleOrnament] -&gt; ShowS
DoubleOrnament -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DoubleOrnament] -&gt; ShowS
$cshowList :: [DoubleOrnament] -&gt; ShowS
show :: DoubleOrnament -&gt; String
$cshow :: DoubleOrnament -&gt; String
showsPrec :: Int -&gt; DoubleOrnament -&gt; ShowS
$cshowsPrec :: Int -&gt; DoubleOrnament -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep DoubleOrnament x -&gt; DoubleOrnament
forall x. DoubleOrnament -&gt; Rep DoubleOrnament x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DoubleOrnament x -&gt; DoubleOrnament
$cfrom :: forall x. DoubleOrnament -&gt; Rep DoubleOrnament x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456867"><span id="local-6989586621679456869"><span id="local-6989586621679456871"><span id="local-6989586621679456873"><span class="annot"><span class="annottext">[DoubleOrnament] -&gt; Encoding
[DoubleOrnament] -&gt; Value
DoubleOrnament -&gt; Encoding
DoubleOrnament -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [DoubleOrnament] -&gt; Encoding
$ctoEncodingList :: [DoubleOrnament] -&gt; Encoding
toJSONList :: [DoubleOrnament] -&gt; Value
$ctoJSONList :: [DoubleOrnament] -&gt; Value
toEncoding :: DoubleOrnament -&gt; Encoding
$ctoEncoding :: DoubleOrnament -&gt; Encoding
toJSON :: DoubleOrnament -&gt; Value
$ctoJSON :: DoubleOrnament -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456862"><span id="local-6989586621679456864"><span class="annot"><span class="annottext">Value -&gt; Parser [DoubleOrnament]
Value -&gt; Parser DoubleOrnament
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [DoubleOrnament]
$cparseJSONList :: Value -&gt; Parser [DoubleOrnament]
parseJSON :: Value -&gt; Parser DoubleOrnament
$cparseJSON :: Value -&gt; Parser DoubleOrnament
</span><a href="#local-6989586621679456862"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456860"><span class="annot"><span class="annottext">DoubleOrnament -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: DoubleOrnament -&gt; ()
$crnf :: DoubleOrnament -&gt; ()
</span><a href="#local-6989586621679456860"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Types of passing notes (two parents).</span><span>
</span><span id="line-197"></span><span id="local-6989586621679456858"><span id="local-6989586621679456859"></span></span><span class="hs-keyword">data</span><span> </span><span id="PassingOrnament"><span class="annot"><a href="PVGrammar.html#PassingOrnament"><span class="hs-identifier hs-var">PassingOrnament</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | a connecting passing note (step to both parents)</span><span>
</span><span id="line-199"></span><span>    </span><span id="PassingMid"><span class="annot"><a href="PVGrammar.html#PassingMid"><span class="hs-identifier hs-var">PassingMid</span></a></span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a step from the left parent</span><span>
</span><span id="line-201"></span><span>    </span><span id="PassingLeft"><span class="annot"><a href="PVGrammar.html#PassingLeft"><span class="hs-identifier hs-var">PassingLeft</span></a></span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | a step from the right parent</span><span>
</span><span id="line-203"></span><span>    </span><span id="PassingRight"><span class="annot"><a href="PVGrammar.html#PassingRight"><span class="hs-identifier hs-var">PassingRight</span></a></span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456851"><span id="local-6989586621679456853"><span class="annot"><span class="annottext">PassingOrnament -&gt; PassingOrnament -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c/= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
== :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c== :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456832"><span id="local-6989586621679456834"><span id="local-6989586621679456837"><span id="local-6989586621679456840"><span id="local-6989586621679456843"><span id="local-6989586621679456845"><span id="local-6989586621679456847"><span class="annot"><span class="annottext">Eq PassingOrnament
PassingOrnament -&gt; PassingOrnament -&gt; Bool
PassingOrnament -&gt; PassingOrnament -&gt; Ordering
PassingOrnament -&gt; PassingOrnament -&gt; PassingOrnament
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PassingOrnament -&gt; PassingOrnament -&gt; PassingOrnament
$cmin :: PassingOrnament -&gt; PassingOrnament -&gt; PassingOrnament
max :: PassingOrnament -&gt; PassingOrnament -&gt; PassingOrnament
$cmax :: PassingOrnament -&gt; PassingOrnament -&gt; PassingOrnament
&gt;= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c&gt;= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
&gt; :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c&gt; :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
&lt;= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c&lt;= :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
&lt; :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
$c&lt; :: PassingOrnament -&gt; PassingOrnament -&gt; Bool
compare :: PassingOrnament -&gt; PassingOrnament -&gt; Ordering
$ccompare :: PassingOrnament -&gt; PassingOrnament -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456826"><span id="local-6989586621679456828"><span id="local-6989586621679456830"><span class="annot"><span class="annottext">Int -&gt; PassingOrnament -&gt; ShowS
[PassingOrnament] -&gt; ShowS
PassingOrnament -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PassingOrnament] -&gt; ShowS
$cshowList :: [PassingOrnament] -&gt; ShowS
show :: PassingOrnament -&gt; String
$cshow :: PassingOrnament -&gt; String
showsPrec :: Int -&gt; PassingOrnament -&gt; ShowS
$cshowsPrec :: Int -&gt; PassingOrnament -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep PassingOrnament x -&gt; PassingOrnament
forall x. PassingOrnament -&gt; Rep PassingOrnament x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PassingOrnament x -&gt; PassingOrnament
$cfrom :: forall x. PassingOrnament -&gt; Rep PassingOrnament x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456816"><span id="local-6989586621679456818"><span id="local-6989586621679456820"><span id="local-6989586621679456822"><span class="annot"><span class="annottext">[PassingOrnament] -&gt; Encoding
[PassingOrnament] -&gt; Value
PassingOrnament -&gt; Encoding
PassingOrnament -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [PassingOrnament] -&gt; Encoding
$ctoEncodingList :: [PassingOrnament] -&gt; Encoding
toJSONList :: [PassingOrnament] -&gt; Value
$ctoJSONList :: [PassingOrnament] -&gt; Value
toEncoding :: PassingOrnament -&gt; Encoding
$ctoEncoding :: PassingOrnament -&gt; Encoding
toJSON :: PassingOrnament -&gt; Value
$ctoJSON :: PassingOrnament -&gt; Value
</span><a href="#local-6989586621679456816"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456812"><span id="local-6989586621679456814"><span class="annot"><span class="annottext">Value -&gt; Parser [PassingOrnament]
Value -&gt; Parser PassingOrnament
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [PassingOrnament]
$cparseJSONList :: Value -&gt; Parser [PassingOrnament]
parseJSON :: Value -&gt; Parser PassingOrnament
$cparseJSON :: Value -&gt; Parser PassingOrnament
</span><a href="#local-6989586621679456812"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456810"><span class="annot"><span class="annottext">PassingOrnament -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: PassingOrnament -&gt; ()
$crnf :: PassingOrnament -&gt; ()
</span><a href="#local-6989586621679456810"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">{- | Types of single-sided ornaments left of the parent (@child-parent@)

 &gt; [ ] [p]
 &gt;     /
 &gt;   [c]
-}</span><span>
</span><span id="line-212"></span><span id="local-6989586621679456808"><span id="local-6989586621679456809"></span></span><span class="hs-keyword">data</span><span> </span><span id="LeftOrnament"><span class="annot"><a href="PVGrammar.html#LeftOrnament"><span class="hs-identifier hs-var">LeftOrnament</span></a></span></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | an incomplete left neighbor</span><span>
</span><span id="line-214"></span><span>    </span><span id="LeftNeighbor"><span class="annot"><a href="PVGrammar.html#LeftNeighbor"><span class="hs-identifier hs-var">LeftNeighbor</span></a></span></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | an incomplete left repetition</span><span>
</span><span id="line-216"></span><span>    </span><span id="LeftRepeat"><span class="annot"><a href="PVGrammar.html#LeftRepeat"><span class="hs-identifier hs-var">LeftRepeat</span></a></span></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456802"><span id="local-6989586621679456804"><span class="annot"><span class="annottext">LeftOrnament -&gt; LeftOrnament -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c/= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
== :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c== :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456783"><span id="local-6989586621679456785"><span id="local-6989586621679456788"><span id="local-6989586621679456791"><span id="local-6989586621679456794"><span id="local-6989586621679456796"><span id="local-6989586621679456798"><span class="annot"><span class="annottext">Eq LeftOrnament
LeftOrnament -&gt; LeftOrnament -&gt; Bool
LeftOrnament -&gt; LeftOrnament -&gt; Ordering
LeftOrnament -&gt; LeftOrnament -&gt; LeftOrnament
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LeftOrnament -&gt; LeftOrnament -&gt; LeftOrnament
$cmin :: LeftOrnament -&gt; LeftOrnament -&gt; LeftOrnament
max :: LeftOrnament -&gt; LeftOrnament -&gt; LeftOrnament
$cmax :: LeftOrnament -&gt; LeftOrnament -&gt; LeftOrnament
&gt;= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c&gt;= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
&gt; :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c&gt; :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
&lt;= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c&lt;= :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
&lt; :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
$c&lt; :: LeftOrnament -&gt; LeftOrnament -&gt; Bool
compare :: LeftOrnament -&gt; LeftOrnament -&gt; Ordering
$ccompare :: LeftOrnament -&gt; LeftOrnament -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456777"><span id="local-6989586621679456779"><span id="local-6989586621679456781"><span class="annot"><span class="annottext">Int -&gt; LeftOrnament -&gt; ShowS
[LeftOrnament] -&gt; ShowS
LeftOrnament -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LeftOrnament] -&gt; ShowS
$cshowList :: [LeftOrnament] -&gt; ShowS
show :: LeftOrnament -&gt; String
$cshow :: LeftOrnament -&gt; String
showsPrec :: Int -&gt; LeftOrnament -&gt; ShowS
$cshowsPrec :: Int -&gt; LeftOrnament -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep LeftOrnament x -&gt; LeftOrnament
forall x. LeftOrnament -&gt; Rep LeftOrnament x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep LeftOrnament x -&gt; LeftOrnament
$cfrom :: forall x. LeftOrnament -&gt; Rep LeftOrnament x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456767"><span id="local-6989586621679456769"><span id="local-6989586621679456771"><span id="local-6989586621679456773"><span class="annot"><span class="annottext">[LeftOrnament] -&gt; Encoding
[LeftOrnament] -&gt; Value
LeftOrnament -&gt; Encoding
LeftOrnament -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [LeftOrnament] -&gt; Encoding
$ctoEncodingList :: [LeftOrnament] -&gt; Encoding
toJSONList :: [LeftOrnament] -&gt; Value
$ctoJSONList :: [LeftOrnament] -&gt; Value
toEncoding :: LeftOrnament -&gt; Encoding
$ctoEncoding :: LeftOrnament -&gt; Encoding
toJSON :: LeftOrnament -&gt; Value
$ctoJSON :: LeftOrnament -&gt; Value
</span><a href="#local-6989586621679456767"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456763"><span id="local-6989586621679456765"><span class="annot"><span class="annottext">Value -&gt; Parser [LeftOrnament]
Value -&gt; Parser LeftOrnament
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [LeftOrnament]
$cparseJSONList :: Value -&gt; Parser [LeftOrnament]
parseJSON :: Value -&gt; Parser LeftOrnament
$cparseJSON :: Value -&gt; Parser LeftOrnament
</span><a href="#local-6989586621679456763"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456761"><span class="annot"><span class="annottext">LeftOrnament -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: LeftOrnament -&gt; ()
$crnf :: LeftOrnament -&gt; ()
</span><a href="#local-6989586621679456761"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">{- | Types of single-sided ornaments right of the parent (@parent--child@).

 &gt; [p] [ ]
 &gt;   \
 &gt;   [c]
-}</span><span>
</span><span id="line-225"></span><span id="local-6989586621679456759"><span id="local-6989586621679456760"></span></span><span class="hs-keyword">data</span><span> </span><span id="RightOrnament"><span class="annot"><a href="PVGrammar.html#RightOrnament"><span class="hs-identifier hs-var">RightOrnament</span></a></span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | an incomplete right neighbor</span><span>
</span><span id="line-227"></span><span>    </span><span id="RightNeighbor"><span class="annot"><a href="PVGrammar.html#RightNeighbor"><span class="hs-identifier hs-var">RightNeighbor</span></a></span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | an incomplete right repetition</span><span>
</span><span id="line-229"></span><span>    </span><span id="RightRepeat"><span class="annot"><a href="PVGrammar.html#RightRepeat"><span class="hs-identifier hs-var">RightRepeat</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456753"><span id="local-6989586621679456755"><span class="annot"><span class="annottext">RightOrnament -&gt; RightOrnament -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c/= :: RightOrnament -&gt; RightOrnament -&gt; Bool
== :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c== :: RightOrnament -&gt; RightOrnament -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456734"><span id="local-6989586621679456736"><span id="local-6989586621679456739"><span id="local-6989586621679456742"><span id="local-6989586621679456745"><span id="local-6989586621679456747"><span id="local-6989586621679456749"><span class="annot"><span class="annottext">Eq RightOrnament
RightOrnament -&gt; RightOrnament -&gt; Bool
RightOrnament -&gt; RightOrnament -&gt; Ordering
RightOrnament -&gt; RightOrnament -&gt; RightOrnament
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: RightOrnament -&gt; RightOrnament -&gt; RightOrnament
$cmin :: RightOrnament -&gt; RightOrnament -&gt; RightOrnament
max :: RightOrnament -&gt; RightOrnament -&gt; RightOrnament
$cmax :: RightOrnament -&gt; RightOrnament -&gt; RightOrnament
&gt;= :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c&gt;= :: RightOrnament -&gt; RightOrnament -&gt; Bool
&gt; :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c&gt; :: RightOrnament -&gt; RightOrnament -&gt; Bool
&lt;= :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c&lt;= :: RightOrnament -&gt; RightOrnament -&gt; Bool
&lt; :: RightOrnament -&gt; RightOrnament -&gt; Bool
$c&lt; :: RightOrnament -&gt; RightOrnament -&gt; Bool
compare :: RightOrnament -&gt; RightOrnament -&gt; Ordering
$ccompare :: RightOrnament -&gt; RightOrnament -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456728"><span id="local-6989586621679456730"><span id="local-6989586621679456732"><span class="annot"><span class="annottext">Int -&gt; RightOrnament -&gt; ShowS
[RightOrnament] -&gt; ShowS
RightOrnament -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RightOrnament] -&gt; ShowS
$cshowList :: [RightOrnament] -&gt; ShowS
show :: RightOrnament -&gt; String
$cshow :: RightOrnament -&gt; String
showsPrec :: Int -&gt; RightOrnament -&gt; ShowS
$cshowsPrec :: Int -&gt; RightOrnament -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep RightOrnament x -&gt; RightOrnament
forall x. RightOrnament -&gt; Rep RightOrnament x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep RightOrnament x -&gt; RightOrnament
$cfrom :: forall x. RightOrnament -&gt; Rep RightOrnament x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456718"><span id="local-6989586621679456720"><span id="local-6989586621679456722"><span id="local-6989586621679456724"><span class="annot"><span class="annottext">[RightOrnament] -&gt; Encoding
[RightOrnament] -&gt; Value
RightOrnament -&gt; Encoding
RightOrnament -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [RightOrnament] -&gt; Encoding
$ctoEncodingList :: [RightOrnament] -&gt; Encoding
toJSONList :: [RightOrnament] -&gt; Value
$ctoJSONList :: [RightOrnament] -&gt; Value
toEncoding :: RightOrnament -&gt; Encoding
$ctoEncoding :: RightOrnament -&gt; Encoding
toJSON :: RightOrnament -&gt; Value
$ctoJSON :: RightOrnament -&gt; Value
</span><a href="#local-6989586621679456718"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456714"><span id="local-6989586621679456716"><span class="annot"><span class="annottext">Value -&gt; Parser [RightOrnament]
Value -&gt; Parser RightOrnament
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [RightOrnament]
$cparseJSONList :: Value -&gt; Parser [RightOrnament]
parseJSON :: Value -&gt; Parser RightOrnament
$cparseJSON :: Value -&gt; Parser RightOrnament
</span><a href="#local-6989586621679456714"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456712"><span class="annot"><span class="annottext">RightOrnament -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: RightOrnament -&gt; ()
$crnf :: RightOrnament -&gt; ()
</span><a href="#local-6989586621679456712"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Returns 'True' if the child repeats the left parent</span><span>
</span><span id="line-233"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnLeft"><span class="hs-identifier hs-type">isRepetitionOnLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PVGrammar.html#DoubleOrnament"><span class="hs-identifier hs-type">DoubleOrnament</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-234"></span><span id="isRepetitionOnLeft"><span class="annot"><span class="annottext">isRepetitionOnLeft :: DoubleOrnament -&gt; Bool
</span><a href="PVGrammar.html#isRepetitionOnLeft"><span class="hs-identifier hs-var hs-var">isRepetitionOnLeft</span></a></span></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><a href="PVGrammar.html#FullRepeat"><span class="hs-identifier hs-var">FullRepeat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-235"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnLeft"><span class="hs-identifier hs-var">isRepetitionOnLeft</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><a href="PVGrammar.html#RightRepeatOfLeft"><span class="hs-identifier hs-var">RightRepeatOfLeft</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-236"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnLeft"><span class="hs-identifier hs-var">isRepetitionOnLeft</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Returns 'True' if the child repeats the right parent</span><span>
</span><span id="line-239"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnRight"><span class="hs-identifier hs-type">isRepetitionOnRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PVGrammar.html#DoubleOrnament"><span class="hs-identifier hs-type">DoubleOrnament</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-240"></span><span id="isRepetitionOnRight"><span class="annot"><span class="annottext">isRepetitionOnRight :: DoubleOrnament -&gt; Bool
</span><a href="PVGrammar.html#isRepetitionOnRight"><span class="hs-identifier hs-var hs-var">isRepetitionOnRight</span></a></span></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><a href="PVGrammar.html#FullRepeat"><span class="hs-identifier hs-var">FullRepeat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-241"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnRight"><span class="hs-identifier hs-var">isRepetitionOnRight</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><a href="PVGrammar.html#LeftRepeatOfRight"><span class="hs-identifier hs-var">LeftRepeatOfRight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-242"></span><span class="annot"><a href="PVGrammar.html#isRepetitionOnRight"><span class="hs-identifier hs-var">isRepetitionOnRight</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleOrnament
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">{- | Encodes the decisions made in a split operation.
 Contains a list of elaborations for every parent edge and note.
 Each elaboration contains the child pitch, and the corresponding ornament.
 For every produced edge, a decisions is made whether to keep it or not.
-}</span><span>
</span><span id="line-249"></span><span id="local-6989586621679456710"><span id="local-6989586621679456711"></span></span><span class="hs-keyword">data</span><span> </span><span id="Split"><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-var">Split</span></a></span></span><span> </span><span id="local-6989586621679458548"><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SplitOp"><span class="annot"><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-var">SplitOp</span></a></span></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="splitReg"><span class="annot"><span class="annottext">forall n. Split n -&gt; Map (Edge n) [(n, DoubleOrnament)]
</span><a href="PVGrammar.html#splitReg"><span class="hs-identifier hs-var hs-var">splitReg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#DoubleOrnament"><span class="hs-identifier hs-type">DoubleOrnament</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- ^ Maps every regular edge to a list of ornamentations.</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="splitPass"><span class="annot"><span class="annottext">forall n. Split n -&gt; Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="PVGrammar.html#splitPass"><span class="hs-identifier hs-var hs-var">splitPass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#PassingOrnament"><span class="hs-identifier hs-type">PassingOrnament</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-comment">-- ^ Maps every passing edge to a passing tone.</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- Since every passing edge is elaborated exactly once</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-comment">-- but there can be several instances of the same edge in a transition,</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- the &quot;same&quot; edge can be elaborated with several passing notes,</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- one for each instance of the edge.</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fromLeft"><span class="annot"><span class="annottext">forall n. Split n -&gt; Map n [(n, RightOrnament)]
</span><a href="PVGrammar.html#fromLeft"><span class="hs-identifier hs-var hs-var">fromLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#RightOrnament"><span class="hs-identifier hs-type">RightOrnament</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-comment">-- ^ Maps notes from the left parent slice to lists of ornamentations.</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fromRight"><span class="annot"><span class="annottext">forall n. Split n -&gt; Map n [(n, LeftOrnament)]
</span><a href="PVGrammar.html#fromRight"><span class="hs-identifier hs-var hs-var">fromRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PVGrammar.html#LeftOrnament"><span class="hs-identifier hs-type">LeftOrnament</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- ^ Maps notes from the right parent slice to lists of ornamentations.</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="keepLeft"><span class="annot"><span class="annottext">forall n. Split n -&gt; HashSet (Edge n)
</span><a href="PVGrammar.html#keepLeft"><span class="hs-identifier hs-var hs-var">keepLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-comment">-- ^ The set of regular edges to keep in the left child transition.</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="keepRight"><span class="annot"><span class="annottext">forall n. Split n -&gt; HashSet (Edge n)
</span><a href="PVGrammar.html#keepRight"><span class="hs-identifier hs-var hs-var">keepRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- ^ The set of regular edges to keep in the right child transition.</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="passLeft"><span class="annot"><span class="annottext">forall n. Split n -&gt; MultiSet (InnerEdge n)
</span><a href="PVGrammar.html#passLeft"><span class="hs-identifier hs-var hs-var">passLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Internal.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MS.MultiSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-comment">-- ^ Contains the new passing edges introduced in the left child transition</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- (excluding those passed down from the parent transition).</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="passRight"><span class="annot"><span class="annottext">forall n. Split n -&gt; MultiSet (InnerEdge n)
</span><a href="PVGrammar.html#passRight"><span class="hs-identifier hs-var hs-var">passRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Internal.MultiSet.html#MultiSet"><span class="hs-identifier hs-type">MS.MultiSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- ^ Contains the new passing edges introduced in the right child transition</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- (excluding those passed down from the parent transition).</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456682"><span id="local-6989586621679456699"><span class="annot"><span class="annottext">Split n -&gt; Split n -&gt; Bool
forall n. Eq n =&gt; Split n -&gt; Split n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Split n -&gt; Split n -&gt; Bool
$c/= :: forall n. Eq n =&gt; Split n -&gt; Split n -&gt; Bool
== :: Split n -&gt; Split n -&gt; Bool
$c== :: forall n. Eq n =&gt; Split n -&gt; Split n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456623"><span id="local-6989586621679456625"><span id="local-6989586621679456628"><span id="local-6989586621679456631"><span id="local-6989586621679456634"><span id="local-6989586621679456650"><span id="local-6989586621679456667"><span class="annot"><span class="annottext">Split n -&gt; Split n -&gt; Bool
Split n -&gt; Split n -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {n}. Ord n =&gt; Eq (Split n)
forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Bool
forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Ordering
forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Split n
min :: Split n -&gt; Split n -&gt; Split n
$cmin :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Split n
max :: Split n -&gt; Split n -&gt; Split n
$cmax :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Split n
&gt;= :: Split n -&gt; Split n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Bool
&gt; :: Split n -&gt; Split n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Bool
&lt;= :: Split n -&gt; Split n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Bool
&lt; :: Split n -&gt; Split n -&gt; Bool
$c&lt; :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Bool
compare :: Split n -&gt; Split n -&gt; Ordering
$ccompare :: forall n. Ord n =&gt; Split n -&gt; Split n -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall n x. Rep (Split n) x -&gt; Split n
forall n x. Split n -&gt; Rep (Split n) x
$cto :: forall n x. Rep (Split n) x -&gt; Split n
$cfrom :: forall n x. Split n -&gt; Rep (Split n) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456598"><span class="annot"><span class="annottext">forall n. NFData n =&gt; Split n -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Split n -&gt; ()
$crnf :: forall n. NFData n =&gt; Split n -&gt; ()
</span><a href="#local-6989586621679456598"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456593"><span id="local-6989586621679456596"><span id="local-6989586621679458533"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458533"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458533"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679456568"><span class="annot"><span class="annottext">show :: Split n -&gt; String
</span><a href="#local-6989586621679456568"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-type">SplitOp</span></a></span><span> </span><span id="local-6989586621679456567"><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456567"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679456566"><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456566"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679456565"><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456565"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679456564"><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456564"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679456563"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456563"><span class="hs-identifier hs-var">kl</span></a></span></span><span> </span><span id="local-6989586621679456562"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456562"><span class="hs-identifier hs-var">kr</span></a></span></span><span> </span><span id="local-6989586621679456561"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456561"><span class="hs-identifier hs-var">pl</span></a></span></span><span> </span><span id="local-6989586621679456560"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456560"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;regular:&quot;</span></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456558"><span class="hs-identifier hs-var">opReg</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, passing:&quot;</span></span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456557"><span class="hs-identifier hs-var">opPass</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, ls:&quot;</span></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456556"><span class="hs-identifier hs-var">opLs</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, rs:&quot;</span></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456555"><span class="hs-identifier hs-var">opRs</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, kl:&quot;</span></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456554"><span class="hs-identifier hs-var">keepLs</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, kr:&quot;</span></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456553"><span class="hs-identifier hs-var">keepRs</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, pl:&quot;</span></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456552"><span class="hs-identifier hs-var">passLs</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, pr:&quot;</span></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var">showOps</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456551"><span class="hs-identifier hs-var">passRs</span></a></span><span>
</span><span id="line-293"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679456559"><span class="annot"><span class="annottext">showOps :: [String] -&gt; String
</span><a href="#local-6989586621679456559"><span class="hs-identifier hs-var hs-var">showOps</span></a></span></span><span> </span><span id="local-6989586621679456543"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456543"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456543"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679456534"><span class="annot"><span class="annottext">showEdge :: (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var hs-var">showEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456533"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456533"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456532"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456532"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456533"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456532"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679456523"><span class="annot"><span class="annottext">showChild :: (i, a) -&gt; String
</span><a href="#local-6989586621679456523"><span class="hs-identifier hs-var hs-var">showChild</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456522"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456522"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456521"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456521"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456522"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456521"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679456509"><span class="annot"><span class="annottext">showChildren :: [(i, a)] -&gt; String
</span><a href="#local-6989586621679456509"><span class="hs-identifier hs-var hs-var">showChildren</span></a></span></span><span> </span><span id="local-6989586621679456508"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456508"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {i} {a}. (Notation i, Show a) =&gt; (i, a) -&gt; String
</span><a href="#local-6989586621679456523"><span class="hs-identifier hs-var">showChild</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456508"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679456495"><span class="annot"><span class="annottext">showSplit :: ((i, i), [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456495"><span class="hs-identifier hs-var hs-var">showSplit</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456494"><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679456494"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456493"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456493"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var">showEdge</span></a></span><span> </span><span class="annot"><span class="annottext">(i, i)
</span><a href="#local-6989586621679456494"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {i} {a}. (Notation i, Show a) =&gt; [(i, a)] -&gt; String
</span><a href="#local-6989586621679456509"><span class="hs-identifier hs-var">showChildren</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456493"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679456482"><span class="annot"><span class="annottext">showL :: (i, [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456482"><span class="hs-identifier hs-var hs-var">showL</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456481"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456481"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456480"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456480"><span class="hs-identifier hs-var">lchilds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456481"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {i} {a}. (Notation i, Show a) =&gt; [(i, a)] -&gt; String
</span><a href="#local-6989586621679456509"><span class="hs-identifier hs-var">showChildren</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456480"><span class="hs-identifier hs-var">lchilds</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679456469"><span class="annot"><span class="annottext">showR :: (i, [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456469"><span class="hs-identifier hs-var hs-var">showR</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456468"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456468"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456467"><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456467"><span class="hs-identifier hs-var">rchilds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {a}. (Notation i, Show a) =&gt; [(i, a)] -&gt; String
</span><a href="#local-6989586621679456509"><span class="hs-identifier hs-var">showChildren</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, a)]
</span><a href="#local-6989586621679456467"><span class="hs-identifier hs-var">rchilds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456468"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679456558"><span class="annot"><span class="annottext">opReg :: [String]
</span><a href="#local-6989586621679456558"><span class="hs-identifier hs-var hs-var">opReg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i} {i} {a}.
(Notation i, Notation i, Notation i, Show a) =&gt;
((i, i), [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456495"><span class="hs-identifier hs-var">showSplit</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456567"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679456557"><span class="annot"><span class="annottext">opPass :: [String]
</span><a href="#local-6989586621679456557"><span class="hs-identifier hs-var hs-var">opPass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i} {i} {a}.
(Notation i, Notation i, Notation i, Show a) =&gt;
((i, i), [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456495"><span class="hs-identifier hs-var">showSplit</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456566"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679456556"><span class="annot"><span class="annottext">opLs :: [String]
</span><a href="#local-6989586621679456556"><span class="hs-identifier hs-var hs-var">opLs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i} {a}.
(Notation i, Notation i, Show a) =&gt;
(i, [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456482"><span class="hs-identifier hs-var">showL</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456565"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679456555"><span class="annot"><span class="annottext">opRs :: [String]
</span><a href="#local-6989586621679456555"><span class="hs-identifier hs-var hs-var">opRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {i} {i}.
(Show a, Notation i, Notation i) =&gt;
(i, [(i, a)]) -&gt; String
</span><a href="#local-6989586621679456469"><span class="hs-identifier hs-var">showR</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456564"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679456554"><span class="annot"><span class="annottext">keepLs :: [String]
</span><a href="#local-6989586621679456554"><span class="hs-identifier hs-var hs-var">keepLs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var">showEdge</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456563"><span class="hs-identifier hs-var">kl</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679456553"><span class="annot"><span class="annottext">keepRs :: [String]
</span><a href="#local-6989586621679456553"><span class="hs-identifier hs-var hs-var">keepRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var">showEdge</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456562"><span class="hs-identifier hs-var">kr</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679456552"><span class="annot"><span class="annottext">passLs :: [String]
</span><a href="#local-6989586621679456552"><span class="hs-identifier hs-var hs-var">passLs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var">showEdge</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k. MultiSet k -&gt; [k]
</span><a href="Internal.MultiSet.html#toList"><span class="hs-identifier hs-var">MS.toList</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456561"><span class="hs-identifier hs-var">pl</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679456551"><span class="annot"><span class="annottext">passRs :: [String]
</span><a href="#local-6989586621679456551"><span class="hs-identifier hs-var hs-var">passRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {i}. (Notation i, Notation i) =&gt; (i, i) -&gt; String
</span><a href="#local-6989586621679456534"><span class="hs-identifier hs-var">showEdge</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k. MultiSet k -&gt; [k]
</span><a href="Internal.MultiSet.html#toList"><span class="hs-identifier hs-var">MS.toList</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456560"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456427"><span id="local-6989586621679456429"><span id="local-6989586621679458514"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458514"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458514"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458514"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-type">SplitOp</span></a></span><span> </span><span id="local-6989586621679456404"><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456404"><span class="hs-identifier hs-var">rega</span></a></span></span><span> </span><span id="local-6989586621679456403"><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456403"><span class="hs-identifier hs-var">passa</span></a></span></span><span> </span><span id="local-6989586621679456402"><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456402"><span class="hs-identifier hs-var">la</span></a></span></span><span> </span><span id="local-6989586621679456401"><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456401"><span class="hs-identifier hs-var">ra</span></a></span></span><span> </span><span id="local-6989586621679456400"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456400"><span class="hs-identifier hs-var">kla</span></a></span></span><span> </span><span id="local-6989586621679456399"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456399"><span class="hs-identifier hs-var">kra</span></a></span></span><span> </span><span id="local-6989586621679456398"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456398"><span class="hs-identifier hs-var">pla</span></a></span></span><span> </span><span id="local-6989586621679456397"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456397"><span class="hs-identifier hs-var">pra</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679456396"><span class="annot"><span class="annottext">&lt;&gt; :: Split n -&gt; Split n -&gt; Split n
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-type">SplitOp</span></a></span><span> </span><span id="local-6989586621679456395"><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456395"><span class="hs-identifier hs-var">regb</span></a></span></span><span> </span><span id="local-6989586621679456394"><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456394"><span class="hs-identifier hs-var">passb</span></a></span></span><span> </span><span id="local-6989586621679456393"><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456393"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679456392"><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456392"><span class="hs-identifier hs-var">rb</span></a></span></span><span> </span><span id="local-6989586621679456391"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456391"><span class="hs-identifier hs-var">klb</span></a></span></span><span> </span><span id="local-6989586621679456390"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456390"><span class="hs-identifier hs-var">krb</span></a></span></span><span> </span><span id="local-6989586621679456389"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456389"><span class="hs-identifier hs-var">plb</span></a></span></span><span> </span><span id="local-6989586621679456388"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456388"><span class="hs-identifier hs-var">prb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">forall n.
Map (Edge n) [(n, DoubleOrnament)]
-&gt; Map (InnerEdge n) [(n, PassingOrnament)]
-&gt; Map n [(n, RightOrnament)]
-&gt; Map n [(n, LeftOrnament)]
-&gt; HashSet (Edge n)
-&gt; HashSet (Edge n)
-&gt; MultiSet (InnerEdge n)
-&gt; MultiSet (InnerEdge n)
-&gt; Split n
</span><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-var">SplitOp</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456404"><span class="hs-identifier hs-var">rega</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (Ord k, Semigroup a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679456387"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679456395"><span class="hs-identifier hs-var">regb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456403"><span class="hs-identifier hs-var">passa</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (Ord k, Semigroup a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679456387"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679456394"><span class="hs-identifier hs-var">passb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456402"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (Ord k, Semigroup a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679456387"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679456393"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456401"><span class="hs-identifier hs-var">ra</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (Ord k, Semigroup a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679456387"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679456392"><span class="hs-identifier hs-var">rb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456400"><span class="hs-identifier hs-var">kla</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456391"><span class="hs-identifier hs-var">klb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456399"><span class="hs-identifier hs-var">kra</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679456390"><span class="hs-identifier hs-var">krb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(Eq a, Hashable a) =&gt;
MultiSet a -&gt; MultiSet a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#union"><span class="hs-identifier hs-var">MS.union</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456398"><span class="hs-identifier hs-var">pla</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456389"><span class="hs-identifier hs-var">plb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(Eq a, Hashable a) =&gt;
MultiSet a -&gt; MultiSet a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#union"><span class="hs-identifier hs-var">MS.union</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456397"><span class="hs-identifier hs-var">pra</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679456388"><span class="hs-identifier hs-var">prb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679458512"><span id="local-6989586621679458513"><span class="annot"><a href="#local-6989586621679456387"><span class="hs-operator hs-type">(&lt;+&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458513"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679458512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458513"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458513"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458513"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458512"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679456387"><span class="annot"><span class="annottext">&lt;+&gt; :: forall k a. (Ord k, Semigroup a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679456387"><span class="hs-operator hs-var hs-var">(&lt;+&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456373"><span id="local-6989586621679456375"><span id="local-6989586621679458505"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458505"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458505"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458505"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679456372"><span class="annot"><span class="annottext">mempty :: Split n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">forall n.
Map (Edge n) [(n, DoubleOrnament)]
-&gt; Map (InnerEdge n) [(n, PassingOrnament)]
-&gt; Map n [(n, RightOrnament)]
-&gt; Map n [(n, LeftOrnament)]
-&gt; HashSet (Edge n)
-&gt; HashSet (Edge n)
-&gt; MultiSet (InnerEdge n)
-&gt; MultiSet (InnerEdge n)
-&gt; Split n
</span><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-var">SplitOp</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="annot"><span class="annottext">forall a. HashSet a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="annot"><span class="annottext">forall a. HashSet a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="annot"><span class="annottext">forall a. MultiSet a
</span><a href="Internal.MultiSet.html#empty"><span class="hs-identifier hs-var">MS.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. MultiSet a
</span><a href="Internal.MultiSet.html#empty"><span class="hs-identifier hs-var">MS.empty</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456367"><span id="local-6989586621679458644"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679456281"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Split n)
</span><a href="#local-6989586621679456281"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Split&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456280"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679456279"><span class="annot"><span class="annottext">[(Edge n, [(n, DoubleOrnament)])]
</span><a href="#local-6989586621679456279"><span class="hs-identifier hs-var">regular</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;regular&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall o p.
(Notation n, FromJSON o) =&gt;
(Value -&gt; Parser p) -&gt; Value -&gt; Parser (p, [(n, o)])
</span><a href="#local-6989586621679456278"><span class="hs-identifier hs-var">parseElaboration</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (StartStop n, StartStop n)
</span><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-var">parseEdge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679456277"><span class="annot"><span class="annottext">[(InnerEdge n, [(n, PassingOrnament)])]
</span><a href="#local-6989586621679456277"><span class="hs-identifier hs-var">passing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;passing&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall o p.
(Notation n, FromJSON o) =&gt;
(Value -&gt; Parser p) -&gt; Value -&gt; Parser (p, [(n, o)])
</span><a href="#local-6989586621679456278"><span class="hs-identifier hs-var">parseElaboration</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (n, n)
</span><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-var">parseInnerEdge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679456276"><span class="annot"><span class="annottext">[(n, [(n, RightOrnament)])]
</span><a href="#local-6989586621679456276"><span class="hs-identifier hs-var">fromL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;fromLeft&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall o p.
(Notation n, FromJSON o) =&gt;
(Value -&gt; Parser p) -&gt; Value -&gt; Parser (p, [(n, o)])
</span><a href="#local-6989586621679456278"><span class="hs-identifier hs-var">parseElaboration</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679456275"><span class="annot"><span class="annottext">[(n, [(n, LeftOrnament)])]
</span><a href="#local-6989586621679456275"><span class="hs-identifier hs-var">fromR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;fromRight&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall o p.
(Notation n, FromJSON o) =&gt;
(Value -&gt; Parser p) -&gt; Value -&gt; Parser (p, [(n, o)])
</span><a href="#local-6989586621679456278"><span class="hs-identifier hs-var">parseElaboration</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679456274"><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456274"><span class="hs-identifier hs-var">keepL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;keepLeft&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (StartStop n, StartStop n)
</span><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-var">parseEdge</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679456273"><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456273"><span class="hs-identifier hs-var">keepR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;keepRight&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (StartStop n, StartStop n)
</span><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-var">parseEdge</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679456272"><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456272"><span class="hs-identifier hs-var">passL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;passLeft&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (n, n)
</span><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-var">parseInnerEdge</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679456271"><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456271"><span class="hs-identifier hs-var">passR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456280"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;passRight&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser (n, n)
</span><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-var">parseInnerEdge</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">forall n.
Map (Edge n) [(n, DoubleOrnament)]
-&gt; Map (InnerEdge n) [(n, PassingOrnament)]
-&gt; Map n [(n, RightOrnament)]
-&gt; Map n [(n, LeftOrnament)]
-&gt; HashSet (Edge n)
-&gt; HashSet (Edge n)
-&gt; MultiSet (InnerEdge n)
-&gt; MultiSet (InnerEdge n)
-&gt; Split n
</span><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-var">SplitOp</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Edge n, [(n, DoubleOrnament)])]
</span><a href="#local-6989586621679456279"><span class="hs-identifier hs-var">regular</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(InnerEdge n, [(n, PassingOrnament)])]
</span><a href="#local-6989586621679456277"><span class="hs-identifier hs-var">passing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(n, [(n, RightOrnament)])]
</span><a href="#local-6989586621679456276"><span class="hs-identifier hs-var">fromL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(n, [(n, LeftOrnament)])]
</span><a href="#local-6989586621679456275"><span class="hs-identifier hs-var">fromR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456274"><span class="hs-identifier hs-var">keepL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Edge n]
</span><a href="#local-6989586621679456273"><span class="hs-identifier hs-var">keepR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a.
(Foldable t, Eq a, Hashable a) =&gt;
t a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#fromList"><span class="hs-identifier hs-var">MS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456272"><span class="hs-identifier hs-var">passL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a.
(Foldable t, Eq a, Hashable a) =&gt;
t a -&gt; MultiSet a
</span><a href="Internal.MultiSet.html#fromList"><span class="hs-identifier hs-var">MS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InnerEdge n]
</span><a href="#local-6989586621679456271"><span class="hs-identifier hs-var">passR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#InnerEdge"><span class="hs-identifier hs-type">InnerEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679458500"><span id="local-6989586621679458501"><span class="annot"><a href="#local-6989586621679456278"><span class="hs-identifier hs-type">parseElaboration</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458501"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679458500"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458500"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458501"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679456278"><span class="annot"><span class="annottext">parseElaboration :: forall o p.
(Notation n, FromJSON o) =&gt;
(Value -&gt; Parser p) -&gt; Value -&gt; Parser (p, [(n, o)])
</span><a href="#local-6989586621679456278"><span class="hs-identifier hs-var hs-var">parseElaboration</span></a></span></span><span> </span><span id="local-6989586621679456255"><span class="annot"><span class="annottext">Value -&gt; Parser p
</span><a href="#local-6989586621679456255"><span class="hs-identifier hs-var">parseParent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Elaboration&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456254"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456254"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>      </span><span id="local-6989586621679456253"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679456253"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456254"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;parent&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser p
</span><a href="#local-6989586621679456255"><span class="hs-identifier hs-var">parseParent</span></a></span><span>
</span><span id="line-359"></span><span>      </span><span id="local-6989586621679456252"><span class="annot"><span class="annottext">[(n, o)]
</span><a href="#local-6989586621679456252"><span class="hs-identifier hs-var">children</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456254"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;children&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall o. (Notation n, FromJSON o) =&gt; Value -&gt; Parser (n, o)
</span><a href="#local-6989586621679456251"><span class="hs-identifier hs-var">parseChild</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679456253"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(n, o)]
</span><a href="#local-6989586621679456252"><span class="hs-identifier hs-var">children</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621679458495"><span class="annot"><a href="#local-6989586621679456251"><span class="hs-identifier hs-type">parseChild</span></a></span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458495"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458644"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458495"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679456251"><span class="annot"><span class="annottext">parseChild :: forall o. (Notation n, FromJSON o) =&gt; Value -&gt; Parser (n, o)
</span><a href="#local-6989586621679456251"><span class="hs-identifier hs-var hs-var">parseChild</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Child&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456240"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456240"><span class="hs-identifier hs-var">cld</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621679456239"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679456239"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456240"><span class="hs-identifier hs-var">cld</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;child&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621679456238"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679456238"><span class="hs-identifier hs-var">orn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456240"><span class="hs-identifier hs-var">cld</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;orn&quot;</span></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679456239"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679456238"><span class="hs-identifier hs-var">orn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">{- | Represents a freeze operation.
 Since this just ties all remaining edges
 (which must all be repetitions)
 no decisions have to be encoded.
-}</span><span>
</span><span id="line-373"></span><span id="local-6989586621679456236"><span id="local-6989586621679456237"></span></span><span class="hs-keyword">data</span><span> </span><span id="Freeze"><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-var">Freeze</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreezeOp"><span class="annot"><a href="PVGrammar.html#FreezeOp"><span class="hs-identifier hs-var">FreezeOp</span></a></span></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456231"><span id="local-6989586621679456233"><span class="annot"><span class="annottext">Freeze -&gt; Freeze -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Freeze -&gt; Freeze -&gt; Bool
$c/= :: Freeze -&gt; Freeze -&gt; Bool
== :: Freeze -&gt; Freeze -&gt; Bool
$c== :: Freeze -&gt; Freeze -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456212"><span id="local-6989586621679456214"><span id="local-6989586621679456217"><span id="local-6989586621679456220"><span id="local-6989586621679456223"><span id="local-6989586621679456225"><span id="local-6989586621679456227"><span class="annot"><span class="annottext">Eq Freeze
Freeze -&gt; Freeze -&gt; Bool
Freeze -&gt; Freeze -&gt; Ordering
Freeze -&gt; Freeze -&gt; Freeze
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Freeze -&gt; Freeze -&gt; Freeze
$cmin :: Freeze -&gt; Freeze -&gt; Freeze
max :: Freeze -&gt; Freeze -&gt; Freeze
$cmax :: Freeze -&gt; Freeze -&gt; Freeze
&gt;= :: Freeze -&gt; Freeze -&gt; Bool
$c&gt;= :: Freeze -&gt; Freeze -&gt; Bool
&gt; :: Freeze -&gt; Freeze -&gt; Bool
$c&gt; :: Freeze -&gt; Freeze -&gt; Bool
&lt;= :: Freeze -&gt; Freeze -&gt; Bool
$c&lt;= :: Freeze -&gt; Freeze -&gt; Bool
&lt; :: Freeze -&gt; Freeze -&gt; Bool
$c&lt; :: Freeze -&gt; Freeze -&gt; Bool
compare :: Freeze -&gt; Freeze -&gt; Ordering
$ccompare :: Freeze -&gt; Freeze -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep Freeze x -&gt; Freeze
forall x. Freeze -&gt; Rep Freeze x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Freeze x -&gt; Freeze
$cfrom :: forall x. Freeze -&gt; Rep Freeze x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456208"><span class="annot"><span class="annottext">Freeze -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Freeze -&gt; ()
$crnf :: Freeze -&gt; ()
</span><a href="#local-6989586621679456208"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456203"><span id="local-6989586621679456206"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679456202"><span class="annot"><span class="annottext">show :: Freeze -&gt; String
</span><a href="#local-6989586621679456202"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456199"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679456197"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Freeze
</span><a href="#local-6989586621679456197"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><a href="PVGrammar.html#FreezeOp"><span class="hs-identifier hs-var">FreezeOp</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">{- | Encodes the distribution of a pitch in a spread.

 All instances of a pitch must be either moved completely to the left or the right (or both).
 In addition, some instances may be repeated on the other side.
 The difference is indicated by the field of the 'ToLeft' and 'ToRight' constructors.
 For example, @ToLeft 3@ indicates that out of @n@ instances,
 all @n@ are moved to the left and @n-3@ are replicated on the right.
-}</span><span>
</span><span id="line-390"></span><span id="local-6989586621679456195"><span id="local-6989586621679456196"></span></span><span class="hs-keyword">data</span><span> </span><span id="SpreadDirection"><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier hs-var">SpreadDirection</span></a></span></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | all to the left, n fewer to the right</span><span>
</span><span id="line-392"></span><span>    </span><span id="ToLeft"><span class="annot"><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-var">ToLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | all to the right, n fewer to the left</span><span>
</span><span id="line-394"></span><span>    </span><span id="ToRight"><span class="annot"><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-var">ToRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | all to both</span><span>
</span><span id="line-396"></span><span>    </span><span id="ToBoth"><span class="annot"><a href="PVGrammar.html#ToBoth"><span class="hs-identifier hs-var">ToBoth</span></a></span></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456186"><span id="local-6989586621679456190"><span class="annot"><span class="annottext">SpreadDirection -&gt; SpreadDirection -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c/= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
== :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c== :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456162"><span id="local-6989586621679456164"><span id="local-6989586621679456167"><span id="local-6989586621679456170"><span id="local-6989586621679456173"><span id="local-6989586621679456177"><span id="local-6989586621679456182"><span class="annot"><span class="annottext">Eq SpreadDirection
SpreadDirection -&gt; SpreadDirection -&gt; Bool
SpreadDirection -&gt; SpreadDirection -&gt; Ordering
SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
$cmin :: SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
max :: SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
$cmax :: SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
&gt;= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c&gt;= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
&gt; :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c&gt; :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
&lt;= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c&lt;= :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
&lt; :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
$c&lt; :: SpreadDirection -&gt; SpreadDirection -&gt; Bool
compare :: SpreadDirection -&gt; SpreadDirection -&gt; Ordering
$ccompare :: SpreadDirection -&gt; SpreadDirection -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456152"><span id="local-6989586621679456154"><span id="local-6989586621679456160"><span class="annot"><span class="annottext">Int -&gt; SpreadDirection -&gt; ShowS
[SpreadDirection] -&gt; ShowS
SpreadDirection -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SpreadDirection] -&gt; ShowS
$cshowList :: [SpreadDirection] -&gt; ShowS
show :: SpreadDirection -&gt; String
$cshow :: SpreadDirection -&gt; String
showsPrec :: Int -&gt; SpreadDirection -&gt; ShowS
$cshowsPrec :: Int -&gt; SpreadDirection -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SpreadDirection x -&gt; SpreadDirection
forall x. SpreadDirection -&gt; Rep SpreadDirection x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SpreadDirection x -&gt; SpreadDirection
$cfrom :: forall x. SpreadDirection -&gt; Rep SpreadDirection x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456148"><span class="annot"><span class="annottext">SpreadDirection -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: SpreadDirection -&gt; ()
$crnf :: SpreadDirection -&gt; ()
</span><a href="#local-6989586621679456148"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456143"><span id="local-6989586621679456145"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier hs-type">SpreadDirection</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-type">ToLeft</span></a></span><span> </span><span id="local-6989586621679456135"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456135"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679456134"><span class="annot"><span class="annottext">&lt;&gt; :: SpreadDirection -&gt; SpreadDirection -&gt; SpreadDirection
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-type">ToLeft</span></a></span><span> </span><span id="local-6989586621679456133"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456133"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-var">ToLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456135"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456133"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-type">ToRight</span></a></span><span> </span><span id="local-6989586621679456131"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456131"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-type">ToRight</span></a></span><span> </span><span id="local-6989586621679456130"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456130"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-var">ToLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456131"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456130"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-type">ToLeft</span></a></span><span> </span><span id="local-6989586621679456129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456129"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-type">ToRight</span></a></span><span> </span><span id="local-6989586621679456128"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456128"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456129"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456128"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="PVGrammar.html#ToBoth"><span class="hs-identifier hs-var">ToBoth</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456129"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456128"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-var">ToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456128"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456129"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-var">ToLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456129"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679456128"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="PVGrammar.html#ToBoth"><span class="hs-identifier hs-var">ToBoth</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679456126"><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456126"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456126"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679456125"><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456125"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679456124"><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456124"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456124"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456125"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456117"><span id="local-6989586621679456119"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier hs-type">SpreadDirection</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679456116"><span class="annot"><span class="annottext">mempty :: SpreadDirection
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="PVGrammar.html#ToBoth"><span class="hs-identifier hs-var">ToBoth</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">{- | Represents a spread operation.
 Records for every pitch how it is distributed (see 'SpreadDirection').
 The resulting edges (repetitions and passing edges) are represented in a child transition.
-}</span><span>
</span><span id="line-416"></span><span id="local-6989586621679456114"><span id="local-6989586621679456115"></span></span><span class="hs-keyword">data</span><span> </span><span id="Spread"><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-var">Spread</span></a></span></span><span> </span><span id="local-6989586621679458487"><span class="annot"><a href="#local-6989586621679458487"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SpreadOp"><span class="annot"><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-var">SpreadOp</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679458487"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier hs-type">SpreadDirection</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458487"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456105"><span id="local-6989586621679456111"><span class="annot"><span class="annottext">Spread n -&gt; Spread n -&gt; Bool
forall n. Eq n =&gt; Spread n -&gt; Spread n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Spread n -&gt; Spread n -&gt; Bool
$c/= :: forall n. Eq n =&gt; Spread n -&gt; Spread n -&gt; Bool
== :: Spread n -&gt; Spread n -&gt; Bool
$c== :: forall n. Eq n =&gt; Spread n -&gt; Spread n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456079"><span id="local-6989586621679456081"><span id="local-6989586621679456084"><span id="local-6989586621679456087"><span id="local-6989586621679456090"><span id="local-6989586621679456095"><span id="local-6989586621679456101"><span class="annot"><span class="annottext">Spread n -&gt; Spread n -&gt; Bool
Spread n -&gt; Spread n -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {n}. Ord n =&gt; Eq (Spread n)
forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Bool
forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Ordering
forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Spread n
min :: Spread n -&gt; Spread n -&gt; Spread n
$cmin :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Spread n
max :: Spread n -&gt; Spread n -&gt; Spread n
$cmax :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Spread n
&gt;= :: Spread n -&gt; Spread n -&gt; Bool
$c&gt;= :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Bool
&gt; :: Spread n -&gt; Spread n -&gt; Bool
$c&gt; :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Bool
&lt;= :: Spread n -&gt; Spread n -&gt; Bool
$c&lt;= :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Bool
&lt; :: Spread n -&gt; Spread n -&gt; Bool
$c&lt; :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Bool
compare :: Spread n -&gt; Spread n -&gt; Ordering
$ccompare :: forall n. Ord n =&gt; Spread n -&gt; Spread n -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall n x. Rep (Spread n) x -&gt; Spread n
forall n x. Spread n -&gt; Rep (Spread n) x
$cto :: forall n x. Rep (Spread n) x -&gt; Spread n
$cfrom :: forall n x. Spread n -&gt; Rep (Spread n) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456075"><span class="annot"><span class="annottext">forall n. NFData n =&gt; Spread n -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Spread n -&gt; ()
$crnf :: forall n. NFData n =&gt; Spread n -&gt; ()
</span><a href="#local-6989586621679456075"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456070"><span id="local-6989586621679456073"><span id="local-6989586621679458484"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458484"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458484"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621679456061"><span class="annot"><span class="annottext">show :: Spread n -&gt; String
</span><a href="#local-6989586621679456061"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-type">SpreadOp</span></a></span><span> </span><span id="local-6989586621679456060"><span class="annot"><span class="annottext">HashMap n SpreadDirection
</span><a href="#local-6989586621679456060"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679456059"><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679456059"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679456058"><span class="hs-identifier hs-var">dists</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;} =&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679456059"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-421"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679456058"><span class="annot"><span class="annottext">dists :: [String]
</span><a href="#local-6989586621679456058"><span class="hs-identifier hs-var hs-var">dists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} {a}. (Notation i, Show a) =&gt; (i, a) -&gt; String
</span><a href="#local-6989586621679456054"><span class="hs-identifier hs-var">showDist</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">HM.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap n SpreadDirection
</span><a href="#local-6989586621679456060"><span class="hs-identifier hs-var">dist</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679456054"><span class="annot"><span class="annottext">showDist :: (i, a) -&gt; String
</span><a href="#local-6989586621679456054"><span class="hs-identifier hs-var hs-var">showDist</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679456044"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456044"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679456043"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456043"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679456044"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679456043"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679456040"><span id="local-6989586621679458643"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458643"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458643"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458643"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458643"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679456026"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Spread n)
</span><a href="#local-6989586621679456026"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Spread&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456025"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456025"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621679456024"><span class="annot"><span class="annottext">[(n, SpreadDirection)]
</span><a href="#local-6989586621679456024"><span class="hs-identifier hs-var">dists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456025"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;children&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (n, SpreadDirection)
</span><a href="#local-6989586621679456023"><span class="hs-identifier hs-var">parseDist</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679456022"><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679456022"><span class="hs-identifier hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456025"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;midEdges&quot;</span></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall n. HashMap n SpreadDirection -&gt; Edges n -&gt; Spread n
</span><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-var">SpreadOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">[(n, SpreadDirection)]
</span><a href="#local-6989586621679456024"><span class="hs-identifier hs-var">dists</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679456022"><span class="hs-identifier hs-var">edges</span></a></span><span>
</span><span id="line-430"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679456023"><span class="annot"><span class="annottext">parseDist :: Value -&gt; Parser (n, SpreadDirection)
</span><a href="#local-6989586621679456023"><span class="hs-identifier hs-var hs-var">parseDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SpreadDist&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679456011"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456011"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621679456010"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679456010"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456011"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;parent&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span id="local-6989586621679456009"><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456009"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679456011"><span class="hs-identifier hs-var">dst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;child&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser SpreadDirection
</span><a href="#local-6989586621679456008"><span class="hs-identifier hs-var">parseChild</span></a></span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679456010"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679456009"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>    </span><span id="local-6989586621679456008"><span class="annot"><span class="annottext">parseChild :: Value -&gt; Parser SpreadDirection
</span><a href="#local-6989586621679456008"><span class="hs-identifier hs-var hs-var">parseChild</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SpreadChild&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679455993"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455993"><span class="hs-identifier hs-var">cld</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621679455992"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455992"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455993"><span class="hs-identifier hs-var">cld</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455992"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;leftChild&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToLeft"><span class="hs-identifier hs-var">ToLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;rightChild&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpreadDirection
</span><a href="PVGrammar.html#ToRight"><span class="hs-identifier hs-var">ToRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;bothChildren&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="PVGrammar.html#ToBoth"><span class="hs-identifier hs-var">ToBoth</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.unexpected</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455992"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | 'Leftmost' specialized to the split, freeze, and spread operations of the grammar.</span><span>
</span><span id="line-444"></span><span class="hs-keyword">type</span><span> </span><span id="PVLeftmost"><span class="annot"><a href="PVGrammar.html#PVLeftmost"><span class="hs-identifier hs-var">PVLeftmost</span></a></span></span><span> </span><span id="local-6989586621679455990"><span class="annot"><a href="#local-6989586621679455990"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455990"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455990"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- helpers</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- =======</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">-- | Helper: parses a note's pitch from JSON.</span><span>
</span><span id="line-450"></span><span id="local-6989586621679458603"><span class="annot"><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-type">parseJSONNote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458603"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679458603"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-451"></span><span id="parseJSONNote"><span class="annot"><span class="annottext">parseJSONNote :: forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var hs-var">parseJSONNote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Note&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679455976"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455976"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621679455975"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455975"><span class="hs-identifier hs-var">pitch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455976"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;pitch&quot;</span></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall i. Notation i =&gt; String -&gt; Maybe i
</span><span class="hs-identifier hs-var">readNotation</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455975"><span class="hs-identifier hs-var">pitch</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679455973"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455973"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455973"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not parse pitch &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455975"><span class="hs-identifier hs-var">pitch</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | Helper: parses an edge from JSON.</span><span>
</span><span id="line-458"></span><span id="local-6989586621679458557"><span class="annot"><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-type">parseEdge</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458557"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458557"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458557"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-460"></span><span id="parseEdge"><span class="annot"><span class="annottext">parseEdge :: forall n. Notation n =&gt; Value -&gt; Parser (StartStop n, StartStop n)
</span><a href="PVGrammar.html#parseEdge"><span class="hs-identifier hs-var hs-var">parseEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Edge&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679455954"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455954"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621679455953"><span class="annot"><span class="annottext">StartStop n
</span><a href="#local-6989586621679455953"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455954"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;left&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span> </span><span class="hs-comment">-- TODO: this might be broken wrt. StartStop</span><span>
</span><span id="line-462"></span><span>  </span><span id="local-6989586621679455952"><span class="annot"><span class="annottext">StartStop n
</span><a href="#local-6989586621679455952"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455954"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;right&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop n
</span><a href="#local-6989586621679455953"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop n
</span><a href="#local-6989586621679455952"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Helper: parses an inner edge from JSON</span><span>
</span><span id="line-466"></span><span id="local-6989586621679458556"><span class="annot"><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-type">parseInnerEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458556"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458556"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458556"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-467"></span><span id="parseInnerEdge"><span class="annot"><span class="annottext">parseInnerEdge :: forall n. Notation n =&gt; Value -&gt; Parser (n, n)
</span><a href="PVGrammar.html#parseInnerEdge"><span class="hs-identifier hs-var hs-var">parseInnerEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InnerEdge&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679455937"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455937"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621679455936"><span class="annot"><span class="annottext">StartStop Value
</span><a href="#local-6989586621679455936"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455937"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;left&quot;</span></span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679455935"><span class="annot"><span class="annottext">StartStop Value
</span><a href="#local-6989586621679455935"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679455937"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;right&quot;</span></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop Value
</span><a href="#local-6989586621679455936"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop Value
</span><a href="#local-6989586621679455935"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679455934"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455934"><span class="hs-identifier hs-var">il</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679455933"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455933"><span class="hs-identifier hs-var">ir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>      </span><span id="local-6989586621679455932"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455932"><span class="hs-identifier hs-var">pl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455934"><span class="hs-identifier hs-var">il</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span id="local-6989586621679455931"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455931"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall n. Notation n =&gt; Value -&gt; Parser n
</span><a href="PVGrammar.html#parseJSONNote"><span class="hs-identifier hs-var">parseJSONNote</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679455933"><span class="hs-identifier hs-var">ir</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455932"><span class="hs-identifier hs-var">pl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455931"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">(StartStop Value, StartStop Value)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Edge is not an inner edge&quot;</span></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">-- | An 'Analysis' specialized to PV types.</span><span>
</span><span id="line-478"></span><span class="hs-keyword">type</span><span> </span><span id="PVAnalysis"><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-var">PVAnalysis</span></a></span></span><span> </span><span id="local-6989586621679455930"><span class="annot"><a href="#local-6989586621679455930"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455930"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455930"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455930"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455930"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">{- | Loads an analysis from a JSON file
 (as exported by the annotation tool).
-}</span><span>
</span><span id="line-483"></span><span class="annot"><a href="PVGrammar.html#loadAnalysis"><span class="hs-identifier hs-type">loadAnalysis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span id="loadAnalysis"><span class="annot"><span class="annottext">loadAnalysis :: String -&gt; IO (Either String (PVAnalysis SPitch))
</span><a href="PVGrammar.html#loadAnalysis"><span class="hs-identifier hs-var hs-var">loadAnalysis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; String -&gt; IO (Either String a)
</span><span class="hs-identifier hs-var">Aeson.eitherDecodeFileStrict</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">{- | Loads an analysis from a JSON file
 (as exported by the annotation tool).
 Converts all pitches to pitch classes.
-}</span><span>
</span><span id="line-490"></span><span class="annot"><a href="PVGrammar.html#loadAnalysis%27"><span class="hs-identifier hs-type">loadAnalysis'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPC</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span id="loadAnalysis%27"><span class="annot"><span class="annottext">loadAnalysis' :: String -&gt; IO (Either String (PVAnalysis SPC))
</span><a href="PVGrammar.html#loadAnalysis%27"><span class="hs-identifier hs-var hs-var">loadAnalysis'</span></a></span></span><span> </span><span id="local-6989586621679455927"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455927"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n' n.
(Eq n', Hashable n', Ord n') =&gt;
(n -&gt; n') -&gt; PVAnalysis n -&gt; PVAnalysis n'
</span><a href="PVGrammar.html#analysisMapPitch"><span class="hs-identifier hs-var">analysisMapPitch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. Interval p =&gt; Pitch p -&gt; Pitch (ICOf p)
</span><span class="hs-identifier hs-var">pc</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">SInterval</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String (PVAnalysis SPitch))
</span><a href="PVGrammar.html#loadAnalysis"><span class="hs-identifier hs-var">loadAnalysis</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455927"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">{- | Loads a MusicXML file and returns a list of salami slices.
 Each note is expressed as a pitch and a flag that indicates
 whether the note continues in the next slice.
-}</span><span>
</span><span id="line-497"></span><span class="annot"><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier hs-type">slicesFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Music.RightTied</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span id="slicesFromFile"><span class="annot"><span class="annottext">slicesFromFile :: String -&gt; IO [[(SPitch, RightTied)]]
</span><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier hs-var hs-var">slicesFromFile</span></a></span></span><span> </span><span id="local-6989586621679455926"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455926"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679455925"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679455925"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Text
</span><span class="hs-identifier hs-var">TL.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455926"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Document
</span><span class="hs-identifier hs-var">MusicXML.parseWithoutIds</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679455925"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><span class="annottext">Maybe Document
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679455922"><span class="annot"><span class="annottext">Document
</span><a href="#local-6989586621679455922"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679455921"><span class="annot"><span class="annottext">[XmlNote]
</span><a href="#local-6989586621679455921"><span class="hs-identifier hs-var">xmlNotes</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[(Ratio Int, TimeSignature)]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Document -&gt; ([XmlNote], [[(Ratio Int, TimeSignature)]])
</span><span class="hs-identifier hs-var">MusicXML.parseScore</span></span><span> </span><span class="annot"><span class="annottext">Document
</span><a href="#local-6989586621679455922"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-504"></span><span>          </span><span id="local-6989586621679455918"><span class="annot"><span class="annottext">notes :: [Note SInterval (Ratio Int)]
</span><a href="#local-6989586621679455918"><span class="hs-identifier hs-var hs-var">notes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XmlNote -&gt; Note SInterval (Ratio Int)
</span><span class="hs-identifier hs-var">MusicXML.asNoteHeard</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[XmlNote]
</span><a href="#local-6989586621679455921"><span class="hs-identifier hs-var">xmlNotes</span></a></span><span>
</span><span id="line-505"></span><span>          </span><span id="local-6989586621679455901"><span class="annot"><span class="annottext">slices :: [[(Note SInterval (Ratio Int), Tied)]]
</span><a href="#local-6989586621679455901"><span class="hs-identifier hs-var hs-var">slices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n st s.
(Foldable f, HasTime n) =&gt;
Slicer n (TimeOf n) st s -&gt; f n -&gt; [s]
</span><span class="hs-identifier hs-var">Music.slicePiece</span></span><span> </span><span class="annot"><span class="annottext">forall a t. Eq a =&gt; Slicer a t ([a], [a]) [(a, Tied)]
</span><span class="hs-identifier hs-var">Music.tiedSlicer</span></span><span> </span><span class="annot"><span class="annottext">[Note SInterval (Ratio Int)]
</span><a href="#local-6989586621679455918"><span class="hs-identifier hs-var">notes</span></a></span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {a}.
(Functor f, HasPitch a) =&gt;
f (a, Tied) -&gt; f (Pitch (IntervalOf a), RightTied)
</span><a href="#local-6989586621679455898"><span class="hs-identifier hs-var">mkSlice</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[(Note SInterval (Ratio Int), Tied)]]
</span><a href="#local-6989586621679455901"><span class="hs-identifier hs-var">slices</span></a></span><span>
</span><span id="line-507"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621679455898"><span class="annot"><span class="annottext">mkSlice :: f (a, Tied) -&gt; f (Pitch (IntervalOf a), RightTied)
</span><a href="#local-6989586621679455898"><span class="hs-identifier hs-var hs-var">mkSlice</span></a></span></span><span> </span><span id="local-6989586621679455890"><span class="annot"><span class="annottext">f (a, Tied)
</span><a href="#local-6989586621679455890"><span class="hs-identifier hs-var">notes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}.
HasPitch a =&gt;
(a, Tied) -&gt; (Pitch (IntervalOf a), RightTied)
</span><a href="#local-6989586621679455889"><span class="hs-identifier hs-var">mkNote</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a, Tied)
</span><a href="#local-6989586621679455890"><span class="hs-identifier hs-var">notes</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621679455889"><span class="annot"><span class="annottext">mkNote :: (a, Tied) -&gt; (Pitch (IntervalOf a), RightTied)
</span><a href="#local-6989586621679455889"><span class="hs-identifier hs-var hs-var">mkNote</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679455886"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679455886"><span class="hs-identifier hs-var">note</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679455885"><span class="annot"><span class="annottext">Tied
</span><a href="#local-6989586621679455885"><span class="hs-identifier hs-var">tie</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasPitch a =&gt; a -&gt; Pitch (IntervalOf a)
</span><span class="hs-identifier hs-var">Music.pitch</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679455886"><span class="hs-identifier hs-var">note</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tied -&gt; RightTied
</span><span class="hs-identifier hs-var">Music.rightTie</span></span><span> </span><span class="annot"><span class="annottext">Tied
</span><a href="#local-6989586621679455885"><span class="hs-identifier hs-var">tie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">-- | Converts salami slices (as returned by 'slicesFromFile') to a path as expected by parsers.</span><span>
</span><span id="line-512"></span><span id="local-6989586621679458428"><span class="annot"><a href="PVGrammar.html#slicesToPath"><span class="hs-identifier hs-type">slicesToPath</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Interval</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Music.RightTied</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><a href="#local-6989586621679458428"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-516"></span><span id="slicesToPath"><span class="annot"><span class="annottext">slicesToPath :: forall i.
(Interval i, Ord i, Eq i) =&gt;
[[(Pitch i, RightTied)]] -&gt; Path [Pitch i] [Edge (Pitch i)]
</span><a href="PVGrammar.html#slicesToPath"><span class="hs-identifier hs-var hs-var">slicesToPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}.
[[(a, RightTied)]] -&gt; Path [a] [(StartStop a, StartStop a)]
</span><a href="#local-6989586621679455879"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-517"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-comment">-- normalizeTies (s : next : rest) = (fixTie &lt;$&gt; s)</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-comment">--   : normalizeTies (next : rest)</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-comment">--  where</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-comment">--   nextNotes = fst &lt;$&gt; next</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-comment">--   fixTie (p, t) = if p `L.elem` nextNotes then (p, t) else (p, Ends)</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-comment">-- normalizeTies [s] = [map (fmap $ const Ends) s]</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-comment">-- normalizeTies []  = []</span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679455877"><span class="annot"><span class="annottext">mkSlice :: [(b, b)] -&gt; [b]
</span><a href="#local-6989586621679455877"><span class="hs-identifier hs-var hs-var">mkSlice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679455876"><span class="annot"><span class="annottext">mkEdges :: [(a, RightTied)] -&gt; [(StartStop a, StartStop a)]
</span><a href="#local-6989586621679455876"><span class="hs-identifier hs-var hs-var">mkEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. (a, RightTied) -&gt; Maybe (StartStop a, StartStop a)
</span><a href="#local-6989586621679455875"><span class="hs-identifier hs-var">mkEdge</span></a></span><span>
</span><span id="line-527"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679455875"><span class="annot"><span class="annottext">mkEdge :: (a, RightTied) -&gt; Maybe (StartStop a, StartStop a)
</span><a href="#local-6989586621679455875"><span class="hs-identifier hs-var hs-var">mkEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightTied
</span><span class="hs-identifier hs-var">Music.Ends</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="#local-6989586621679455875"><span class="hs-identifier hs-var">mkEdge</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679455873"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679455873"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightTied
</span><span class="hs-identifier hs-var">Music.Holds</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679455873"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679455873"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679455879"><span class="annot"><span class="annottext">go :: [[(a, RightTied)]] -&gt; Path [a] [(StartStop a, StartStop a)]
</span><a href="#local-6989586621679455879"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot construct path from empty list&quot;</span></span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><a href="#local-6989586621679455879"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679455868"><span class="annot"><span class="annottext">[(a, RightTied)]
</span><a href="#local-6989586621679455868"><span class="hs-identifier hs-var">notes</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {b} {b}. [(b, b)] -&gt; [b]
</span><a href="#local-6989586621679455877"><span class="hs-identifier hs-var">mkSlice</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, RightTied)]
</span><a href="#local-6989586621679455868"><span class="hs-identifier hs-var">notes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><a href="#local-6989586621679455879"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679455866"><span class="annot"><span class="annottext">[(a, RightTied)]
</span><a href="#local-6989586621679455866"><span class="hs-identifier hs-var">notes</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679455865"><span class="annot"><span class="annottext">[[(a, RightTied)]]
</span><a href="#local-6989586621679455865"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {b} {b}. [(b, b)] -&gt; [b]
</span><a href="#local-6989586621679455877"><span class="hs-identifier hs-var">mkSlice</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, RightTied)]
</span><a href="#local-6989586621679455866"><span class="hs-identifier hs-var">notes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. [(a, RightTied)] -&gt; [(StartStop a, StartStop a)]
</span><a href="#local-6989586621679455876"><span class="hs-identifier hs-var">mkEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, RightTied)]
</span><a href="#local-6989586621679455866"><span class="hs-identifier hs-var">notes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(a, RightTied)]] -&gt; Path [a] [(StartStop a, StartStop a)]
</span><a href="#local-6989586621679455879"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[[(a, RightTied)]]
</span><a href="#local-6989586621679455865"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">{- | Loads a MusicXML File and returns a surface path
 as input to parsers.
-}</span><span>
</span><span id="line-537"></span><span class="annot"><a href="PVGrammar.html#loadSurface"><span class="hs-identifier hs-type">loadSurface</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SInterval</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SInterval</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span id="loadSurface"><span class="annot"><span class="annottext">loadSurface :: String -&gt; IO (Path [SPitch] [Edge SPitch])
</span><a href="PVGrammar.html#loadSurface"><span class="hs-identifier hs-var hs-var">loadSurface</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall i.
(Interval i, Ord i, Eq i) =&gt;
[[(Pitch i, RightTied)]] -&gt; Path [Pitch i] [Edge (Pitch i)]
</span><a href="PVGrammar.html#slicesToPath"><span class="hs-identifier hs-var">slicesToPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [[(SPitch, RightTied)]]
</span><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier hs-var">slicesFromFile</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">{- | Loads a MusicXML File
 and returns a surface path of the given range of slices.
-}</span><span>
</span><span id="line-543"></span><span class="annot"><a href="PVGrammar.html#loadSurface%27"><span class="hs-identifier hs-type">loadSurface'</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-comment">-- ^ path to a MusicXML file</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-comment">-- ^ the first slice to include (starting at 0)</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-comment">-- ^ the last slice to include</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SInterval</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pitch</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SInterval</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span id="loadSurface%27"><span class="annot"><span class="annottext">loadSurface' :: String -&gt; Int -&gt; Int -&gt; IO (Path [SPitch] [Edge SPitch])
</span><a href="PVGrammar.html#loadSurface%27"><span class="hs-identifier hs-var hs-var">loadSurface'</span></a></span></span><span> </span><span id="local-6989586621679455863"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455863"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679455862"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679455862"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679455861"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679455861"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><span class="annottext">forall i.
(Interval i, Ord i, Eq i) =&gt;
[[(Pitch i, RightTied)]] -&gt; Path [Pitch i] [Edge (Pitch i)]
</span><a href="PVGrammar.html#slicesToPath"><span class="hs-identifier hs-var">slicesToPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679455862"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679455861"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679455862"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [[(SPitch, RightTied)]]
</span><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier hs-var">slicesFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679455863"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-comment">-- | Apply an applicative action to all pitches in an analysis.</span><span>
</span><span id="line-555"></span><span id="local-6989586621679458408"><span id="local-6989586621679458409"><span id="local-6989586621679458410"><span class="annot"><a href="PVGrammar.html#analysisTraversePitch"><span class="hs-identifier hs-type">analysisTraversePitch</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458410"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458409"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458409"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458409"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458408"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458410"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458409"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458408"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458410"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458409"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-560"></span><span id="analysisTraversePitch"><span class="annot"><span class="annottext">analysisTraversePitch :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n', Ord n') =&gt;
(n -&gt; f n') -&gt; PVAnalysis n -&gt; f (PVAnalysis n')
</span><a href="PVGrammar.html#analysisTraversePitch"><span class="hs-identifier hs-var hs-var">analysisTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455841"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455841"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span id="local-6989586621679455839"><span class="annot"><span class="annottext">[Leftmost (Split n) Freeze (Spread n)]
</span><a href="#local-6989586621679455839"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span id="local-6989586621679455838"><span class="annot"><span class="annottext">Path (Edges n) (Notes n)
</span><a href="#local-6989586621679455838"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621679455837"><span class="annot"><span class="annottext">[Leftmost (Split n') Freeze (Spread n')]
</span><a href="#local-6989586621679455837"><span class="hs-identifier hs-var">deriv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n', Ord n') =&gt;
(n -&gt; f n')
-&gt; Leftmost (Split n) Freeze (Spread n)
-&gt; f (Leftmost (Split n') Freeze (Spread n'))
</span><a href="PVGrammar.html#leftmostTraversePitch"><span class="hs-identifier hs-var">leftmostTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455841"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Leftmost (Split n) Freeze (Spread n)]
</span><a href="#local-6989586621679455839"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-562"></span><span>  </span><span id="local-6989586621679455834"><span class="annot"><span class="annottext">Path (Edges n') (Notes n')
</span><a href="#local-6989586621679455834"><span class="hs-identifier hs-var">top'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n')
-&gt; Path (Edges n) (Notes n) -&gt; f (Path (Edges n') (Notes n'))
</span><a href="PVGrammar.html#pathTraversePitch"><span class="hs-identifier hs-var">pathTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455841"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Edges n) (Notes n)
</span><a href="#local-6989586621679455838"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall s f h tr slc.
[Leftmost s f h] -&gt; Path tr slc -&gt; Analysis s f h tr slc
</span><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost (Split n') Freeze (Spread n')]
</span><a href="#local-6989586621679455837"><span class="hs-identifier hs-var">deriv'</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Edges n') (Notes n')
</span><a href="#local-6989586621679455834"><span class="hs-identifier hs-var">top'</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-comment">-- | Map a function over all pitches in an analysis.</span><span>
</span><span id="line-566"></span><span id="local-6989586621679458465"><span id="local-6989586621679458466"><span class="annot"><a href="PVGrammar.html#analysisMapPitch"><span class="hs-identifier hs-type">analysisMapPitch</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458466"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458466"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458466"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458465"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458466"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458465"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#PVAnalysis"><span class="hs-identifier hs-type">PVAnalysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458466"><span class="hs-identifier hs-type">n'</span></a></span></span></span><span>
</span><span id="line-568"></span><span id="analysisMapPitch"><span class="annot"><span class="annottext">analysisMapPitch :: forall n' n.
(Eq n', Hashable n', Ord n') =&gt;
(n -&gt; n') -&gt; PVAnalysis n -&gt; PVAnalysis n'
</span><a href="PVGrammar.html#analysisMapPitch"><span class="hs-identifier hs-var hs-var">analysisMapPitch</span></a></span></span><span> </span><span id="local-6989586621679455823"><span class="annot"><span class="annottext">n -&gt; n'
</span><a href="#local-6989586621679455823"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n', Ord n') =&gt;
(n -&gt; f n') -&gt; PVAnalysis n -&gt; f (PVAnalysis n')
</span><a href="PVGrammar.html#analysisTraversePitch"><span class="hs-identifier hs-var">analysisTraversePitch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n'
</span><a href="#local-6989586621679455823"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span id="local-6989586621679458395"><span id="local-6989586621679458396"><span id="local-6989586621679458397"><span class="annot"><a href="PVGrammar.html#pathTraversePitch"><span class="hs-identifier hs-type">pathTraversePitch</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458397"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458396"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458396"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458395"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458397"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458396"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458395"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458395"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458397"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458396"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458396"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-575"></span><span id="pathTraversePitch"><span class="annot"><span class="annottext">pathTraversePitch :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n')
-&gt; Path (Edges n) (Notes n) -&gt; f (Path (Edges n') (Notes n'))
</span><a href="PVGrammar.html#pathTraversePitch"><span class="hs-identifier hs-var hs-var">pathTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455802"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455802"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679455801"><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455801"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679455800"><span class="annot"><span class="annottext">Notes n
</span><a href="#local-6989586621679455800"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679455799"><span class="annot"><span class="annottext">Path (Edges n) (Notes n)
</span><a href="#local-6989586621679455799"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-576"></span><span>  </span><span id="local-6989586621679455798"><span class="annot"><span class="annottext">Edges n'
</span><a href="#local-6989586621679455798"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Edges n -&gt; f (Edges n')
</span><a href="PVGrammar.html#edgesTraversePitch"><span class="hs-identifier hs-var">edgesTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455802"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455801"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span id="local-6989586621679455796"><span class="annot"><span class="annottext">Notes n'
</span><a href="#local-6989586621679455796"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall n (f :: * -&gt; *) a.
(Eq n, Hashable n, Applicative f) =&gt;
(a -&gt; f n) -&gt; Notes a -&gt; f (Notes n)
</span><a href="PVGrammar.html#notesTraversePitch"><span class="hs-identifier hs-var">notesTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455802"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Notes n
</span><a href="#local-6989586621679455800"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span id="local-6989586621679455794"><span class="annot"><span class="annottext">Path (Edges n') (Notes n')
</span><a href="#local-6989586621679455794"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n')
-&gt; Path (Edges n) (Notes n) -&gt; f (Path (Edges n') (Notes n'))
</span><a href="PVGrammar.html#pathTraversePitch"><span class="hs-identifier hs-var">pathTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455802"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Edges n) (Notes n)
</span><a href="#local-6989586621679455799"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Edges n'
</span><a href="#local-6989586621679455798"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Notes n'
</span><a href="#local-6989586621679455796"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Edges n') (Notes n')
</span><a href="#local-6989586621679455794"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-580"></span><span class="annot"><a href="PVGrammar.html#pathTraversePitch"><span class="hs-identifier hs-var">pathTraversePitch</span></a></span><span> </span><span id="local-6989586621679455793"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455793"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679455792"><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455792"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Edges n -&gt; f (Edges n')
</span><a href="PVGrammar.html#edgesTraversePitch"><span class="hs-identifier hs-var">edgesTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455793"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455792"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span id="local-6989586621679458374"><span id="local-6989586621679458375"><span id="local-6989586621679458376"><span class="annot"><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-type">traverseEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458376"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458375"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458376"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458374"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458375"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458375"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458376"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458374"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458374"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-583"></span><span id="traverseEdge"><span class="annot"><span class="annottext">traverseEdge :: forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var hs-var">traverseEdge</span></a></span></span><span> </span><span id="local-6989586621679455786"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455786"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679455785"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455785"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679455784"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455784"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455786"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455785"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455786"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455784"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span id="local-6989586621679458365"><span id="local-6989586621679458366"><span id="local-6989586621679458367"><span class="annot"><a href="PVGrammar.html#traverseSet"><span class="hs-identifier hs-type">traverseSet</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458367"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458366"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458366"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458365"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458367"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458366"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.HashSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679458365"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458367"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.HashSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679458366"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-590"></span><span id="traverseSet"><span class="annot"><span class="annottext">traverseSet :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; HashSet n -&gt; f (HashSet n')
</span><a href="PVGrammar.html#traverseSet"><span class="hs-identifier hs-var hs-var">traverseSet</span></a></span></span><span> </span><span id="local-6989586621679455773"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455773"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679455772"><span class="annot"><span class="annottext">HashSet n
</span><a href="#local-6989586621679455772"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455773"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">S.toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet n
</span><a href="#local-6989586621679455772"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span id="local-6989586621679458377"><span id="local-6989586621679458378"><span id="local-6989586621679458379"><span class="annot"><a href="PVGrammar.html#notesTraversePitch"><span class="hs-identifier hs-type">notesTraversePitch</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458379"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458379"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458378"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458377"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458378"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458379"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458377"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458378"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458379"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-594"></span><span id="notesTraversePitch"><span class="annot"><span class="annottext">notesTraversePitch :: forall n (f :: * -&gt; *) a.
(Eq n, Hashable n, Applicative f) =&gt;
(a -&gt; f n) -&gt; Notes a -&gt; f (Notes n)
</span><a href="PVGrammar.html#notesTraversePitch"><span class="hs-identifier hs-var hs-var">notesTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455763"><span class="annot"><span class="annottext">a -&gt; f n
</span><a href="#local-6989586621679455763"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span id="local-6989586621679455762"><span class="annot"><span class="annottext">MultiSet a
</span><a href="#local-6989586621679455762"><span class="hs-identifier hs-var">notes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall n. MultiSet n -&gt; Notes n
</span><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-var">Notes</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall b (f :: * -&gt; *) a.
(Eq b, Hashable b, Applicative f) =&gt;
(a -&gt; f b) -&gt; MultiSet a -&gt; f (MultiSet b)
</span><a href="Internal.MultiSet.html#traverse"><span class="hs-identifier hs-var">MS.traverse</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f n
</span><a href="#local-6989586621679455763"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet a
</span><a href="#local-6989586621679455762"><span class="hs-identifier hs-var">notes</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span id="local-6989586621679458380"><span id="local-6989586621679458381"><span id="local-6989586621679458382"><span class="annot"><a href="PVGrammar.html#edgesTraversePitch"><span class="hs-identifier hs-type">edgesTraversePitch</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458382"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458381"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458381"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458380"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458382"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458381"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458380"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458382"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458381"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-601"></span><span id="edgesTraversePitch"><span class="annot"><span class="annottext">edgesTraversePitch :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Edges n -&gt; f (Edges n')
</span><a href="PVGrammar.html#edgesTraversePitch"><span class="hs-identifier hs-var hs-var">edgesTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455740"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455740"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span id="local-6989586621679455739"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455739"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679455738"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455738"><span class="hs-identifier hs-var">pass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679455737"><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455737"><span class="hs-identifier hs-var">reg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; HashSet n -&gt; f (HashSet n')
</span><a href="PVGrammar.html#traverseSet"><span class="hs-identifier hs-var">traverseSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455740"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455739"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679455736"><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455736"><span class="hs-identifier hs-var">pass'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b (f :: * -&gt; *) a.
(Eq b, Hashable b, Applicative f) =&gt;
(a -&gt; f b) -&gt; MultiSet a -&gt; f (MultiSet b)
</span><a href="Internal.MultiSet.html#traverse"><span class="hs-identifier hs-var">MS.traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455740"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455738"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall n. HashSet (Edge n) -&gt; MultiSet (InnerEdge n) -&gt; Edges n
</span><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-var">Edges</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455737"><span class="hs-identifier hs-var">reg'</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455736"><span class="hs-identifier hs-var">pass'</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span id="local-6989586621679458398"><span id="local-6989586621679458399"><span id="local-6989586621679458400"><span class="annot"><a href="PVGrammar.html#leftmostTraversePitch"><span class="hs-identifier hs-type">leftmostTraversePitch</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458400"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458398"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458398"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458398"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="PVGrammar.html#Freeze"><span class="hs-identifier hs-type">Freeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458399"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-611"></span><span id="leftmostTraversePitch"><span class="annot"><span class="annottext">leftmostTraversePitch :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n', Ord n') =&gt;
(n -&gt; f n')
-&gt; Leftmost (Split n) Freeze (Spread n)
-&gt; f (Leftmost (Split n') Freeze (Spread n'))
</span><a href="PVGrammar.html#leftmostTraversePitch"><span class="hs-identifier hs-var hs-var">leftmostTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455712"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455712"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679455711"><span class="annot"><span class="annottext">Leftmost (Split n) Freeze (Spread n)
</span><a href="#local-6989586621679455711"><span class="hs-identifier hs-var">lm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost (Split n) Freeze (Spread n)
</span><a href="#local-6989586621679455711"><span class="hs-identifier hs-var">lm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-type">LMSplitLeft</span></a></span><span> </span><span id="local-6989586621679455709"><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455709"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
(Applicative f, Ord n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Split n -&gt; f (Split n')
</span><a href="PVGrammar.html#splitTraversePitch"><span class="hs-identifier hs-var">splitTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455712"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455709"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-type">LMSplitRight</span></a></span><span> </span><span id="local-6989586621679455706"><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455706"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
(Applicative f, Ord n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Split n -&gt; f (Split n')
</span><a href="PVGrammar.html#splitTraversePitch"><span class="hs-identifier hs-var">splitTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455712"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455706"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-type">LMSplitOnly</span></a></span><span> </span><span id="local-6989586621679455704"><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455704"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
(Applicative f, Ord n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Split n -&gt; f (Split n')
</span><a href="PVGrammar.html#splitTraversePitch"><span class="hs-identifier hs-var">splitTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455712"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Split n
</span><a href="#local-6989586621679455704"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-type">LMFreezeLeft</span></a></span><span> </span><span id="local-6989586621679455702"><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679455702"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679455702"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-type">LMFreezeOnly</span></a></span><span> </span><span id="local-6989586621679455700"><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679455700"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679455700"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-identifier hs-type">LMSpread</span></a></span><span> </span><span id="local-6989586621679455698"><span class="annot"><span class="annottext">Spread n
</span><a href="#local-6989586621679455698"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Spread n -&gt; f (Spread n')
</span><a href="PVGrammar.html#spreadTraversePitch"><span class="hs-identifier hs-var">spreadTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455712"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Spread n
</span><a href="#local-6989586621679455698"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="annot"><a href="PVGrammar.html#splitTraversePitch"><span class="hs-identifier hs-type">splitTraversePitch</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679458346"><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679458344"><span class="annot"><a href="#local-6989586621679458344"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679458345"><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span></span><span>
</span><span id="line-621"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458344"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458344"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span id="splitTraversePitch"><span class="annot"><span class="annottext">splitTraversePitch :: forall (f :: * -&gt; *) n n'.
(Applicative f, Ord n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Split n -&gt; f (Split n')
</span><a href="PVGrammar.html#splitTraversePitch"><span class="hs-identifier hs-var hs-var">splitTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455649"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-type">SplitOp</span></a></span><span> </span><span id="local-6989586621679455648"><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679455648"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621679455647"><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679455647"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679455646"><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679455646"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679455645"><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679455645"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679455644"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455644"><span class="hs-identifier hs-var">kl</span></a></span></span><span> </span><span id="local-6989586621679455643"><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455643"><span class="hs-identifier hs-var">kr</span></a></span></span><span> </span><span id="local-6989586621679455642"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455642"><span class="hs-identifier hs-var">pl</span></a></span></span><span> </span><span id="local-6989586621679455641"><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455641"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>  </span><span id="local-6989586621679455640"><span class="annot"><span class="annottext">Map (StartStop n', StartStop n') [(n', DoubleOrnament)]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">reg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall p p' o.
Ord p' =&gt;
(p -&gt; f p') -&gt; Map p [(n, o)] -&gt; f (Map p' [(n', o)])
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">traverseElabo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Edge n) [(n, DoubleOrnament)]
</span><a href="#local-6989586621679455648"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-627"></span><span>  </span><span id="local-6989586621679455638"><span class="annot"><span class="annottext">Map (n', n') [(n', PassingOrnament)]
</span><a href="#local-6989586621679455638"><span class="hs-identifier hs-var">pass'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall p p' o.
Ord p' =&gt;
(p -&gt; f p') -&gt; Map p [(n, o)] -&gt; f (Map p' [(n', o)])
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">traverseElabo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (InnerEdge n) [(n, PassingOrnament)]
</span><a href="#local-6989586621679455647"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-628"></span><span>  </span><span id="local-6989586621679455637"><span class="annot"><span class="annottext">Map n' [(n', RightOrnament)]
</span><a href="#local-6989586621679455637"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall p p' o.
Ord p' =&gt;
(p -&gt; f p') -&gt; Map p [(n, o)] -&gt; f (Map p' [(n', o)])
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">traverseElabo</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [(n, RightOrnament)]
</span><a href="#local-6989586621679455646"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621679455636"><span class="annot"><span class="annottext">Map n' [(n', LeftOrnament)]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">rs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall p p' o.
Ord p' =&gt;
(p -&gt; f p') -&gt; Map p [(n, o)] -&gt; f (Map p' [(n', o)])
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">traverseElabo</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map n [(n, LeftOrnament)]
</span><a href="#local-6989586621679455645"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-630"></span><span>  </span><span id="local-6989586621679455635"><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455635"><span class="hs-identifier hs-var">kl'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; HashSet n -&gt; f (HashSet n')
</span><a href="PVGrammar.html#traverseSet"><span class="hs-identifier hs-var">traverseSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455644"><span class="hs-identifier hs-var">kl</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span id="local-6989586621679455634"><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455634"><span class="hs-identifier hs-var">kr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; HashSet n -&gt; f (HashSet n')
</span><a href="PVGrammar.html#traverseSet"><span class="hs-identifier hs-var">traverseSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet (Edge n)
</span><a href="#local-6989586621679455643"><span class="hs-identifier hs-var">kr</span></a></span><span>
</span><span id="line-632"></span><span>  </span><span id="local-6989586621679455633"><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455633"><span class="hs-identifier hs-var">pl'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b (f :: * -&gt; *) a.
(Eq b, Hashable b, Applicative f) =&gt;
(a -&gt; f b) -&gt; MultiSet a -&gt; f (MultiSet b)
</span><a href="Internal.MultiSet.html#traverse"><span class="hs-identifier hs-var">MS.traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455642"><span class="hs-identifier hs-var">pl</span></a></span><span>
</span><span id="line-633"></span><span>  </span><span id="local-6989586621679455632"><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455632"><span class="hs-identifier hs-var">pr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b (f :: * -&gt; *) a.
(Eq b, Hashable b, Applicative f) =&gt;
(a -&gt; f b) -&gt; MultiSet a -&gt; f (MultiSet b)
</span><a href="Internal.MultiSet.html#traverse"><span class="hs-identifier hs-var">MS.traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n n'.
Applicative f =&gt;
(n -&gt; f n') -&gt; (n, n) -&gt; f (n', n')
</span><a href="PVGrammar.html#traverseEdge"><span class="hs-identifier hs-var">traverseEdge</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MultiSet (InnerEdge n)
</span><a href="#local-6989586621679455641"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall n.
Map (Edge n) [(n, DoubleOrnament)]
-&gt; Map (InnerEdge n) [(n, PassingOrnament)]
-&gt; Map n [(n, RightOrnament)]
-&gt; Map n [(n, LeftOrnament)]
-&gt; HashSet (Edge n)
-&gt; HashSet (Edge n)
-&gt; MultiSet (InnerEdge n)
-&gt; MultiSet (InnerEdge n)
-&gt; Split n
</span><a href="PVGrammar.html#SplitOp"><span class="hs-identifier hs-var">SplitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Map (StartStop n', StartStop n') [(n', DoubleOrnament)]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">reg'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (n', n') [(n', PassingOrnament)]
</span><a href="#local-6989586621679455638"><span class="hs-identifier hs-var">pass'</span></a></span><span> </span><span class="annot"><span class="annottext">Map n' [(n', RightOrnament)]
</span><a href="#local-6989586621679455637"><span class="hs-identifier hs-var">ls'</span></a></span><span> </span><span class="annot"><span class="annottext">Map n' [(n', LeftOrnament)]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">rs'</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455635"><span class="hs-identifier hs-var">kl'</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (StartStop n', StartStop n')
</span><a href="#local-6989586621679455634"><span class="hs-identifier hs-var">kr'</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455633"><span class="hs-identifier hs-var">pl'</span></a></span><span> </span><span class="annot"><span class="annottext">MultiSet (n', n')
</span><a href="#local-6989586621679455632"><span class="hs-identifier hs-var">pr'</span></a></span><span>
</span><span id="line-635"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-636"></span><span>  </span><span class="annot"><a href="#local-6989586621679455639"><span class="hs-identifier hs-type">traverseElabo</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679458330"><span class="annot"><a href="#local-6989586621679458330"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679458331"><span class="annot"><a href="#local-6989586621679458331"><span class="hs-identifier hs-type">p'</span></a></span></span><span> </span><span id="local-6989586621679458329"><span class="annot"><a href="#local-6989586621679458329"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-638"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679458331"><span class="hs-identifier hs-type">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458330"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458331"><span class="hs-identifier hs-type">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458330"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458344"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458329"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458346"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679458331"><span class="hs-identifier hs-type">p'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458345"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458329"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>  </span><span id="local-6989586621679455639"><span class="annot"><span class="annottext">traverseElabo :: forall p p' o.
Ord p' =&gt;
(p -&gt; f p') -&gt; Map p [(n, o)] -&gt; f (Map p' [(n', o)])
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var hs-var">traverseElabo</span></a></span></span><span> </span><span id="local-6989586621679455621"><span class="annot"><span class="annottext">p -&gt; f p'
</span><a href="#local-6989586621679455621"><span class="hs-identifier hs-var">fparent</span></a></span></span><span> </span><span id="local-6989586621679455620"><span class="annot"><span class="annottext">Map p [(n, o)]
</span><a href="#local-6989586621679455620"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map p [(n, o)]
</span><a href="#local-6989586621679455620"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679455619"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679455619"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679455618"><span class="annot"><span class="annottext">[(n, o)]
</span><a href="#local-6989586621679455618"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-644"></span><span>      </span><span id="local-6989586621679455617"><span class="annot"><span class="annottext">p'
</span><a href="#local-6989586621679455617"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">p -&gt; f p'
</span><a href="#local-6989586621679455621"><span class="hs-identifier hs-var">fparent</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679455619"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-645"></span><span>      </span><span id="local-6989586621679455616"><span class="annot"><span class="annottext">[(n', o)]
</span><a href="#local-6989586621679455616"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679455615"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455615"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679455614"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679455614"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679455614"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455649"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455615"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(n, o)]
</span><a href="#local-6989586621679455618"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-646"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p'
</span><a href="#local-6989586621679455617"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(n', o)]
</span><a href="#local-6989586621679455616"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span id="local-6989586621679458335"><span id="local-6989586621679458336"><span id="local-6989586621679458337"><span class="annot"><a href="PVGrammar.html#spreadTraversePitch"><span class="hs-identifier hs-type">spreadTraversePitch</span></a></span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679458337"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679458336"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679458336"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458335"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458337"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458336"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458335"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458337"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Spread"><span class="hs-identifier hs-type">Spread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458336"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-653"></span><span id="spreadTraversePitch"><span class="annot"><span class="annottext">spreadTraversePitch :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Spread n -&gt; f (Spread n')
</span><a href="PVGrammar.html#spreadTraversePitch"><span class="hs-identifier hs-var hs-var">spreadTraversePitch</span></a></span></span><span> </span><span id="local-6989586621679455598"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455598"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-type">SpreadOp</span></a></span><span> </span><span id="local-6989586621679455597"><span class="annot"><span class="annottext">HashMap n SpreadDirection
</span><a href="#local-6989586621679455597"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679455596"><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455596"><span class="hs-identifier hs-var">edges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>  </span><span id="local-6989586621679455595"><span class="annot"><span class="annottext">[(n', SpreadDirection)]
</span><a href="#local-6989586621679455595"><span class="hs-identifier hs-var">dist'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679455594"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455594"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679455593"><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679455593"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">SpreadDirection
</span><a href="#local-6989586621679455593"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455598"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679455594"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">HM.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap n SpreadDirection
</span><a href="#local-6989586621679455597"><span class="hs-identifier hs-var">dist</span></a></span><span>
</span><span id="line-655"></span><span>  </span><span id="local-6989586621679455592"><span class="annot"><span class="annottext">Edges n'
</span><a href="#local-6989586621679455592"><span class="hs-identifier hs-var">edges'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; Edges n -&gt; f (Edges n')
</span><a href="PVGrammar.html#edgesTraversePitch"><span class="hs-identifier hs-var">edgesTraversePitch</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679455598"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Edges n
</span><a href="#local-6989586621679455596"><span class="hs-identifier hs-var">edges</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall n. HashMap n SpreadDirection -&gt; Edges n -&gt; Spread n
</span><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-var">SpreadOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">[(n', SpreadDirection)]
</span><a href="#local-6989586621679455595"><span class="hs-identifier hs-var">dist'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Edges n'
</span><a href="#local-6989586621679455592"><span class="hs-identifier hs-var">edges'</span></a></span><span>
</span><span id="line-657"></span></pre></body></html>