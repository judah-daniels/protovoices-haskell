<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HeuristicParser</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">newtype</span><span> </span><span id="Slice"><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span></span><span> </span><span id="local-6989586621679455072"><span class="annot"><a href="#local-6989586621679455072"><span class="hs-identifier hs-type">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Slice"><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sContent"><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var hs-var">sContent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679455072"><span class="hs-identifier hs-type">ns</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454920"><span id="local-6989586621679454924"><span class="annot"><span class="annottext">Slice ns -&gt; Slice ns -&gt; Bool
forall ns. Eq ns =&gt; Slice ns -&gt; Slice ns -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Slice ns -&gt; Slice ns -&gt; Bool
$c/= :: forall ns. Eq ns =&gt; Slice ns -&gt; Slice ns -&gt; Bool
== :: Slice ns -&gt; Slice ns -&gt; Bool
$c== :: forall ns. Eq ns =&gt; Slice ns -&gt; Slice ns -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679454911"><span id="local-6989586621679454914"><span id="local-6989586621679455066"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679455066"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455066"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>  </span><span id="local-6989586621679454908"><span class="annot"><span class="annottext">show :: Slice ns -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454906"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454906"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454906"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">data</span><span> </span><span id="Trans"><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span></span><span> </span><span id="local-6989586621679455065"><span class="annot"><a href="#local-6989586621679455065"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Trans"><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="tContent"><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var hs-var">tContent</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679455065"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span id="t2nd"><span class="annot"><span class="annottext">forall es. Trans es -&gt; Bool
</span><a href="HeuristicParser.html#t2nd"><span class="hs-identifier hs-var hs-var">t2nd</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span id="tBoundary"><span class="annot"><span class="annottext">forall es. Trans es -&gt; Bool
</span><a href="HeuristicParser.html#tBoundary"><span class="hs-identifier hs-var hs-var">tBoundary</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454894"><span id="local-6989586621679454900"><span class="annot"><span class="annottext">Trans es -&gt; Trans es -&gt; Bool
forall es. Eq es =&gt; Trans es -&gt; Trans es -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Trans es -&gt; Trans es -&gt; Bool
$c/= :: forall es. Eq es =&gt; Trans es -&gt; Trans es -&gt; Bool
== :: Trans es -&gt; Trans es -&gt; Bool
$c== :: forall es. Eq es =&gt; Trans es -&gt; Trans es -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454882"><span id="local-6989586621679454884"><span id="local-6989586621679454892"><span class="annot"><span class="annottext">Int -&gt; Trans es -&gt; ShowS
forall es. Show es =&gt; Int -&gt; Trans es -&gt; ShowS
forall es. Show es =&gt; [Trans es] -&gt; ShowS
forall es. Show es =&gt; Trans es -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Trans es] -&gt; ShowS
$cshowList :: forall es. Show es =&gt; [Trans es] -&gt; ShowS
show :: Trans es -&gt; String
$cshow :: forall es. Show es =&gt; Trans es -&gt; String
showsPrec :: Int -&gt; Trans es -&gt; ShowS
$cshowsPrec :: forall es. Show es =&gt; Int -&gt; Trans es -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | The state of the search between steps</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- es' : Unparsed/frozen transitions</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- es  : Unfrozen transitions</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- ns  : Evaluated slice content</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- o   : Operation type</span><span>
</span><span id="line-28"></span><span class="hs-keyword">data</span><span> </span><span id="SearchState"><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-var">SearchState</span></a></span></span><span> </span><span id="local-6989586621679455061"><span class="annot"><a href="#local-6989586621679455061"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span id="local-6989586621679455060"><span class="annot"><a href="#local-6989586621679455060"><span class="hs-identifier hs-type">es'</span></a></span></span><span> </span><span id="local-6989586621679455059"><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span></span><span> </span><span id="local-6989586621679455058"><span class="annot"><a href="#local-6989586621679455058"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SSFrozen"><span class="annot"><a href="HeuristicParser.html#SSFrozen"><span class="hs-identifier hs-var">SSFrozen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679455060"><span class="hs-identifier hs-type">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Beginning of search - all frozen edges and slices</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SSSemiOpen"><span class="annot"><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span></span><span> </span><span class="hs-comment">-- Point between beginning and end of the path</span><span>
</span><span id="line-31"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | frozen transitions and slices from current point leftward</span><span>
</span><span id="line-32"></span><span>        </span><span id="_ssFrozen"><span class="annot"><span class="annottext">forall es es' ns o.
SearchState es es' ns o -&gt; Path (Maybe es', Bool) (Slice ns)
</span><a href="HeuristicParser.html#_ssFrozen"><span class="hs-identifier hs-var hs-var">_ssFrozen</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679455060"><span class="hs-identifier hs-type">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="hs-comment">-- | the slice at the current posision between gsFrozen and gsOpen</span><span>
</span><span id="line-34"></span><span>        </span><span id="_ssMidSlice"><span class="annot"><span class="annottext">forall es es' ns o. SearchState es es' ns o -&gt; Slice ns
</span><a href="HeuristicParser.html#_ssMidSlice"><span class="hs-identifier hs-var hs-var">_ssMidSlice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="hs-comment">-- | non-frozen transitions and slices from current point rightward</span><span>
</span><span id="line-36"></span><span>        </span><span id="_ssOpen"><span class="annot"><span class="annottext">forall es es' ns o.
SearchState es es' ns o -&gt; Path (Trans es) (Slice ns)
</span><a href="HeuristicParser.html#_ssOpen"><span class="hs-identifier hs-var hs-var">_ssOpen</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455061"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="hs-comment">-- | derivation from current reduction to original surface</span><span>
</span><span id="line-38"></span><span>        </span><span id="_ssDeriv"><span class="annot"><span class="annottext">forall es es' ns o. SearchState es es' ns o -&gt; [o]
</span><a href="HeuristicParser.html#_ssDeriv"><span class="hs-identifier hs-var hs-var">_ssDeriv</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679455058"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-39"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SSOpen"><span class="annot"><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455061"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455059"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679455058"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Single path with unfrozen transition,slices and history</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679454870"><span id="local-6989586621679454873"><span id="local-6989586621679455035"><span id="local-6989586621679455036"><span id="local-6989586621679455037"><span id="local-6989586621679455038"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679455038"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679455037"><span class="hs-identifier hs-type">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679455036"><span class="hs-identifier hs-type">ns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679455035"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455038"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455037"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455036"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455035"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679454854"><span class="annot"><span class="annottext">show :: SearchState es es' ns o -&gt; String
</span><a href="#local-6989586621679454854"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621679454853"><span class="annot"><span class="annottext">SearchState es es' ns o
</span><a href="#local-6989586621679454853"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SearchState es es' ns o
</span><a href="#local-6989586621679454853"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSFrozen"><span class="hs-identifier hs-type">SSFrozen</span></a></span><span> </span><span id="local-6989586621679454852"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454852"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Frozen: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454852"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-type">SSSemiOpen</span></a></span><span> </span><span id="local-6989586621679454851"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454851"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679454850"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454850"><span class="hs-identifier hs-var">midSlice</span></a></span></span><span> </span><span id="local-6989586621679454849"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454849"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679454848"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454848"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span>
</span><span id="line-46"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SemiOpen: \n&quot;</span></span><span> </span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Frozen: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454851"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nMid: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454850"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nOpen : &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454849"><span class="hs-identifier hs-var">open</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-type">SSOpen</span></a></span><span> </span><span id="local-6989586621679454847"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454847"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679454846"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454846"><span class="hs-identifier hs-var">deriv</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Open: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nPath: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454847"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nSteps: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454846"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Returns a list of possible next states given the current state.</span><span>
</span><span id="line-55"></span><span class="annot"><a href="HeuristicParser.html#exploreStates"><span class="hs-identifier hs-type">exploreStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679455027"><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span id="local-6989586621679455026"><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span></span><span> </span><span id="local-6989586621679455025"><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span></span><span> </span><span id="local-6989586621679455024"><span class="annot"><a href="#local-6989586621679455024"><span class="hs-identifier hs-type">ns'</span></a></span></span><span> </span><span id="local-6989586621679455023"><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455024"><span class="hs-identifier hs-type">ns'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span id="exploreStates"><span class="annot"><span class="annottext">exploreStates :: forall es es' ns ns' o.
Eval es es' ns ns' o
-&gt; SearchState es es' ns o -&gt; [SearchState es es' ns o]
</span><a href="HeuristicParser.html#exploreStates"><span class="hs-identifier hs-var hs-var">exploreStates</span></a></span></span><span> </span><span id="local-6989586621679454834"><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679454833"><span class="annot"><span class="annottext">SearchState es es' ns o
</span><a href="#local-6989586621679454833"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SearchState es es' ns o
</span><a href="#local-6989586621679454833"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="HeuristicParser.html#SSFrozen"><span class="hs-identifier hs-type">SSFrozen</span></a></span><span> </span><span id="local-6989586621679454832"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454832"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454832"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454830"><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454830"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454829"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454829"><span class="hs-identifier hs-var">boundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es} {o} {es'} {ns}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454828"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454827"><span class="hs-identifier hs-var">thawed</span></a></span><span>
</span><span id="line-59"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>        </span><span id="local-6989586621679454827"><span class="annot"><span class="annottext">thawed :: [(es, o)]
</span><a href="#local-6989586621679454827"><span class="hs-identifier hs-var hs-var">thawed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454830"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621679454828"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454828"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454823"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454823"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454822"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454822"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454823"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454829"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454822"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454820"><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454820"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454819"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454819"><span class="hs-identifier hs-var">boundary</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679454818"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454818"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679454817"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454817"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es} {o}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454816"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454815"><span class="hs-identifier hs-var">thawed</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>        </span><span id="local-6989586621679454815"><span class="annot"><span class="annottext">thawed :: [(es, o)]
</span><a href="#local-6989586621679454815"><span class="hs-identifier hs-var hs-var">thawed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454820"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454818"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-65"></span><span>        </span><span id="local-6989586621679454816"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454816"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454813"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454813"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454812"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454812"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454817"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454818"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454813"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454819"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454812"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-type">SSSemiOpen</span></a></span><span> </span><span id="local-6989586621679454811"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679454810"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span></span><span> </span><span id="local-6989586621679454809"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454809"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679454808"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454807"><span class="hs-identifier hs-var">thawOps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454806"><span class="hs-identifier hs-var">reductions</span></a></span><span> </span><span class="hs-comment">-- we can either unfreeze, or apply an operation to the open part</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>      </span><span id="local-6989586621679454807"><span class="annot"><span class="annottext">thawOps :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454807"><span class="hs-identifier hs-var hs-var">thawOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454805"><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454805"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454804"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454804"><span class="hs-identifier hs-var">boundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454803"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454802"><span class="hs-identifier hs-var">thawed</span></a></span><span>
</span><span id="line-71"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>            </span><span id="local-6989586621679454802"><span class="annot"><span class="annottext">thawed :: [(es, o)]
</span><a href="#local-6989586621679454802"><span class="hs-identifier hs-var hs-var">thawed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454805"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-73"></span><span>            </span><span id="local-6989586621679454803"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454803"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454801"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454801"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454800"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454800"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454801"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454804"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454809"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454800"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454799"><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454799"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454798"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454798"><span class="hs-identifier hs-var">boundary</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679454797"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454797"><span class="hs-identifier hs-var">frozenSlice</span></a></span></span><span> </span><span id="local-6989586621679454796"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454796"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454795"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454794"><span class="hs-identifier hs-var">thawed</span></a></span><span>
</span><span id="line-75"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>            </span><span id="local-6989586621679454794"><span class="annot"><span class="annottext">thawed :: [(es, o)]
</span><a href="#local-6989586621679454794"><span class="hs-identifier hs-var hs-var">thawed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe es'
</span><a href="#local-6989586621679454799"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-77"></span><span>            </span><span id="local-6989586621679454795"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454795"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454793"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454793"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454792"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454792"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454796"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454797"><span class="hs-identifier hs-var">frozenSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454793"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454798"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454809"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454792"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><a href="#local-6989586621679454806"><span class="hs-identifier hs-type">reductions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621679454806"><span class="annot"><span class="annottext">reductions :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454806"><span class="hs-identifier hs-var hs-var">reductions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454809"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-comment">-- A single transition - No operations</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans es
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-comment">-- Two open transitions: merge</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454791"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454791"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454790"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454790"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454789"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454789"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454788"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454788"><span class="hs-identifier hs-var">slice</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454787"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454787"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454786"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454786"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454789"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454785"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454784"><span class="hs-identifier hs-var">merged</span></a></span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>            </span><span id="local-6989586621679454784"><span class="annot"><span class="annottext">merged :: [(es, o)]
</span><a href="#local-6989586621679454784"><span class="hs-identifier hs-var hs-var">merged</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454791"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454788"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454787"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span id="local-6989586621679454785"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454785"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454781"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454781"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454780"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454780"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454781"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454790"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454786"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454780"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-comment">-- Three open transitions: mergeleft mergeRight or verticalise</span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454779"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454779"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454778"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454778"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454777"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454777"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454776"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454775"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454775"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679454774"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454774"><span class="hs-identifier hs-var">tm2nd</span></a></span></span><span> </span><span id="local-6989586621679454773"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454773"><span class="hs-identifier hs-var">tmBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454772"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454771"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454771"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679454770"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454770"><span class="hs-identifier hs-var">tr2nd</span></a></span></span><span> </span><span id="local-6989586621679454769"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454769"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454768"><span class="hs-identifier hs-var">leftMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454767"><span class="hs-identifier hs-var">rightMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454766"><span class="hs-identifier hs-var">vertStates</span></a></span><span>
</span><span id="line-91"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-93"></span><span>            </span><span id="local-6989586621679454768"><span class="annot"><span class="annottext">leftMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454768"><span class="hs-identifier hs-var hs-var">leftMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454765"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454764"><span class="hs-identifier hs-var">leftMerges</span></a></span><span>
</span><span id="line-94"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>                </span><span id="local-6989586621679454764"><span class="annot"><span class="annottext">leftMerges :: [(es, o)]
</span><a href="#local-6989586621679454764"><span class="hs-identifier hs-var hs-var">leftMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454779"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454775"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-96"></span><span>                </span><span id="local-6989586621679454765"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454765"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454762"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454762"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454761"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454761"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454762"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454778"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454777"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454771"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454770"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454769"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454761"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-99"></span><span>            </span><span id="local-6989586621679454767"><span class="annot"><span class="annottext">rightMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454767"><span class="hs-identifier hs-var hs-var">rightMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454774"><span class="hs-identifier hs-var">tm2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454773"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454758"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454757"><span class="hs-identifier hs-var">rightMerges</span></a></span><span>
</span><span id="line-100"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>                </span><span id="local-6989586621679454757"><span class="annot"><span class="annottext">rightMerges :: [(es, o)]
</span><a href="#local-6989586621679454757"><span class="hs-identifier hs-var hs-var">rightMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454775"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454771"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-102"></span><span>                </span><span id="local-6989586621679454758"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454758"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454755"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454755"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454754"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454754"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454779"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454778"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454777"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454755"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454769"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454754"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>            </span><span id="local-6989586621679454766"><span class="annot"><span class="annottext">vertStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454766"><span class="hs-identifier hs-var hs-var">vertStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454778"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454773"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>                  </span><span class="hs-comment">-- List</span><span>
</span><span id="line-109"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621679454747"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454747"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454746"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454746"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454775"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>                  </span><span id="local-6989586621679454743"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454743"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454779"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454776"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454747"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- Check boundaries TODO</span><span>
</span><span id="line-111"></span><span>                  </span><span id="local-6989586621679454741"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454741"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454772"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454771"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454747"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- TODO boundaris</span><span>
</span><span id="line-112"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {es}. es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454739"><span class="hs-identifier hs-var">getState</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454743"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454747"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454741"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454746"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-113"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>                </span><span id="local-6989586621679454739"><span class="annot"><span class="annottext">getState :: es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454739"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span id="local-6989586621679454738"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454738"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679454737"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454737"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679454736"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454736"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679454735"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454735"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454738"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454737"><span class="hs-identifier hs-var">sTop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454736"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454735"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454734"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454734"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454733"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454733"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454732"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454732"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454731"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454730"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454730"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679454729"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454729"><span class="hs-identifier hs-var">tm2nd</span></a></span></span><span> </span><span id="local-6989586621679454728"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454728"><span class="hs-identifier hs-var">tmBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454727"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454726"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454726"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679454725"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454725"><span class="hs-identifier hs-var">tr2nd</span></a></span></span><span> </span><span id="local-6989586621679454724"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454724"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679454723"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454723"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679454722"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454722"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454721"><span class="hs-identifier hs-var">leftMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454720"><span class="hs-identifier hs-var">rightMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454719"><span class="hs-identifier hs-var">vertStates</span></a></span><span>
</span><span id="line-117"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-119"></span><span>            </span><span id="local-6989586621679454721"><span class="annot"><span class="annottext">leftMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454721"><span class="hs-identifier hs-var hs-var">leftMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454718"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454717"><span class="hs-identifier hs-var">leftMerges</span></a></span><span>
</span><span id="line-120"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>                </span><span id="local-6989586621679454717"><span class="annot"><span class="annottext">leftMerges :: [(es, o)]
</span><a href="#local-6989586621679454717"><span class="hs-identifier hs-var hs-var">leftMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454734"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454730"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-122"></span><span>                </span><span id="local-6989586621679454718"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454718"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454716"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454716"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454715"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454715"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454716"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454733"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454732"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454726"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454725"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454724"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454715"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-125"></span><span>            </span><span id="local-6989586621679454720"><span class="annot"><span class="annottext">rightMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454720"><span class="hs-identifier hs-var hs-var">rightMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454729"><span class="hs-identifier hs-var">tm2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454728"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454714"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454713"><span class="hs-identifier hs-var">rightMerges</span></a></span><span>
</span><span id="line-126"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>                </span><span id="local-6989586621679454713"><span class="annot"><span class="annottext">rightMerges :: [(es, o)]
</span><a href="#local-6989586621679454713"><span class="hs-identifier hs-var hs-var">rightMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454734"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454730"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-128"></span><span>                </span><span id="local-6989586621679454714"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454714"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454712"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454712"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454711"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454711"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454734"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454733"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454732"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454712"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454724"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454711"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>            </span><span id="local-6989586621679454719"><span class="annot"><span class="annottext">vertStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454719"><span class="hs-identifier hs-var hs-var">vertStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454733"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454728"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span>
</span><span id="line-132"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>                  </span><span class="hs-comment">-- List</span><span>
</span><span id="line-135"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621679454706"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454705"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454705"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454730"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>                  </span><span id="local-6989586621679454704"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454704"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454734"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454731"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- Check boundaries TODO</span><span>
</span><span id="line-137"></span><span>                  </span><span id="local-6989586621679454703"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454703"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454727"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454726"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- TODO boundaris</span><span>
</span><span id="line-138"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454702"><span class="hs-identifier hs-var">getState</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454704"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454703"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454705"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-139"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>                </span><span id="local-6989586621679454702"><span class="annot"><span class="annottext">getState :: es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454702"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span id="local-6989586621679454701"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454701"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679454700"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454700"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679454699"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454699"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679454698"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454698"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Maybe es', Bool) (Slice ns)
-&gt; Slice ns
-&gt; Path (Trans es) (Slice ns)
-&gt; [o]
-&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-var">SSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679454811"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454810"><span class="hs-identifier hs-var">midSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454701"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454700"><span class="hs-identifier hs-var">sTop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454699"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454725"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454724"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454723"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454722"><span class="hs-identifier hs-var">rst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454698"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454808"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-type">SSOpen</span></a></span><span> </span><span id="local-6989586621679454697"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454697"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679454696"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SearchState es es' ns o]
</span><a href="#local-6989586621679454695"><span class="hs-identifier hs-var">reductions</span></a></span><span> </span><span class="hs-comment">-- we can either unfreeze, or apply an operation to the open part</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="#local-6989586621679454695"><span class="hs-identifier hs-type">reductions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455027"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455026"><span class="hs-identifier hs-type">es'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455025"><span class="hs-identifier hs-type">ns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679455023"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>      </span><span id="local-6989586621679454695"><span class="annot"><span class="annottext">reductions :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454695"><span class="hs-identifier hs-var hs-var">reductions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454697"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-comment">-- A single transition - No operations</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans es
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-comment">-- Two open transitions: merge</span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454694"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454694"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454693"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454693"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454692"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454692"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454691"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454691"><span class="hs-identifier hs-var">slice</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454690"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454690"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454689"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454689"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454692"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es} {es'} {ns}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454688"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454687"><span class="hs-identifier hs-var">merged</span></a></span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>            </span><span id="local-6989586621679454687"><span class="annot"><span class="annottext">merged :: [(es, o)]
</span><a href="#local-6989586621679454687"><span class="hs-identifier hs-var hs-var">merged</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454694"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454691"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454690"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span> </span><span class="hs-comment">-- Start as left slice correct?</span><span>
</span><span id="line-154"></span><span>            </span><span id="local-6989586621679454688"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454688"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454686"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454686"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454685"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454685"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454686"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454693"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454689"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454685"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-comment">-- Three open transitions: mergeleft mergeRight or verticalise</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454684"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454684"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454683"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454683"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454682"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454682"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454681"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454680"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454680"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679454679"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454679"><span class="hs-identifier hs-var">tm2nd</span></a></span></span><span> </span><span id="local-6989586621679454678"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454678"><span class="hs-identifier hs-var">tmBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454677"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454676"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454676"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679454675"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454675"><span class="hs-identifier hs-var">tr2nd</span></a></span></span><span> </span><span id="local-6989586621679454674"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454674"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454673"><span class="hs-identifier hs-var">leftMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454672"><span class="hs-identifier hs-var">rightMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454671"><span class="hs-identifier hs-var">vertStates</span></a></span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-160"></span><span>            </span><span id="local-6989586621679454673"><span class="annot"><span class="annottext">leftMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454673"><span class="hs-identifier hs-var hs-var">leftMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454670"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454669"><span class="hs-identifier hs-var">leftMerges</span></a></span><span>
</span><span id="line-161"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>                </span><span id="local-6989586621679454669"><span class="annot"><span class="annottext">leftMerges :: [(es, o)]
</span><a href="#local-6989586621679454669"><span class="hs-identifier hs-var hs-var">leftMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454684"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454680"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-163"></span><span>                </span><span id="local-6989586621679454670"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454670"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454668"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454668"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454667"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454667"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454668"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454683"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454682"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454676"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454675"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454674"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-166"></span><span>            </span><span id="local-6989586621679454672"><span class="annot"><span class="annottext">rightMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454672"><span class="hs-identifier hs-var hs-var">rightMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454679"><span class="hs-identifier hs-var">tm2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454678"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454666"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454665"><span class="hs-identifier hs-var">rightMerges</span></a></span><span>
</span><span id="line-167"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>                </span><span id="local-6989586621679454665"><span class="annot"><span class="annottext">rightMerges :: [(es, o)]
</span><a href="#local-6989586621679454665"><span class="hs-identifier hs-var hs-var">rightMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454684"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454680"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-169"></span><span>                </span><span id="local-6989586621679454666"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454666"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454664"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454664"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454663"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454663"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454684"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454683"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454682"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454664"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454674"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454663"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>            </span><span id="local-6989586621679454671"><span class="annot"><span class="annottext">vertStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454671"><span class="hs-identifier hs-var hs-var">vertStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454683"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454678"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>                  </span><span class="hs-comment">-- List</span><span>
</span><span id="line-176"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621679454658"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454658"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454657"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454657"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454680"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>                  </span><span id="local-6989586621679454656"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454656"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454684"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454681"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454658"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- Check boundaries TODO</span><span>
</span><span id="line-178"></span><span>                  </span><span id="local-6989586621679454655"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454655"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454677"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454676"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454658"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- TODO boundaris</span><span>
</span><span id="line-179"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {es} {ns} {es'}.
es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454654"><span class="hs-identifier hs-var">getState</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454656"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454658"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454655"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454657"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-180"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>                </span><span id="local-6989586621679454654"><span class="annot"><span class="annottext">getState :: es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454654"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span id="local-6989586621679454653"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454653"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679454652"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454652"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679454651"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454651"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679454650"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454650"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454653"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454652"><span class="hs-identifier hs-var">sTop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454651"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454650"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454649"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454649"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679454648"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454648"><span class="hs-identifier hs-var">tl2nd</span></a></span></span><span> </span><span id="local-6989586621679454647"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454647"><span class="hs-identifier hs-var">tlBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454646"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454645"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454645"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679454644"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454644"><span class="hs-identifier hs-var">tm2nd</span></a></span></span><span> </span><span id="local-6989586621679454643"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454643"><span class="hs-identifier hs-var">tmBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679454642"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span id="local-6989586621679454641"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454641"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679454640"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454640"><span class="hs-identifier hs-var">tr2nd</span></a></span></span><span> </span><span id="local-6989586621679454639"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454639"><span class="hs-identifier hs-var">trBoundary</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679454638"><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454638"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679454637"><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454637"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454636"><span class="hs-identifier hs-var">leftMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454635"><span class="hs-identifier hs-var">rightMergeStates</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. [SearchState es es' ns o]
</span><a href="#local-6989586621679454634"><span class="hs-identifier hs-var">vertStates</span></a></span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-186"></span><span>            </span><span id="local-6989586621679454636"><span class="annot"><span class="annottext">leftMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454636"><span class="hs-identifier hs-var hs-var">leftMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454633"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454632"><span class="hs-identifier hs-var">leftMerges</span></a></span><span>
</span><span id="line-187"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>                </span><span id="local-6989586621679454632"><span class="annot"><span class="annottext">leftMerges :: [(es, o)]
</span><a href="#local-6989586621679454632"><span class="hs-identifier hs-var hs-var">leftMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454649"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454645"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-189"></span><span>                </span><span id="local-6989586621679454633"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454633"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454631"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454631"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454630"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454630"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454631"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454648"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454647"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454641"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454640"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454639"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454630"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-comment">-- TODO consider 2nd and boundary</span><span>
</span><span id="line-192"></span><span>            </span><span id="local-6989586621679454635"><span class="annot"><span class="annottext">rightMergeStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454635"><span class="hs-identifier hs-var hs-var">rightMergeStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454644"><span class="hs-identifier hs-var">tm2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454643"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454629"><span class="hs-identifier hs-var">genState</span></a></span><span> </span><span class="annot"><span class="annottext">[(es, o)]
</span><a href="#local-6989586621679454628"><span class="hs-identifier hs-var">rightMerges</span></a></span><span>
</span><span id="line-193"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>                </span><span id="local-6989586621679454628"><span class="annot"><span class="annottext">rightMerges :: [(es, o)]
</span><a href="#local-6989586621679454628"><span class="hs-identifier hs-var hs-var">rightMerges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454649"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454645"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-195"></span><span>                </span><span id="local-6989586621679454629"><span class="annot"><span class="annottext">genState :: (es, o) -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454629"><span class="hs-identifier hs-var hs-var">genState</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454627"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454627"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454626"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454626"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454649"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454648"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454647"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454627"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454639"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454626"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>            </span><span id="local-6989586621679454634"><span class="annot"><span class="annottext">vertStates :: [SearchState es es' ns o]
</span><a href="#local-6989586621679454634"><span class="hs-identifier hs-var hs-var">vertStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454648"><span class="hs-identifier hs-var">tl2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454643"><span class="hs-identifier hs-var">tmBoundary</span></a></span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>                  </span><span class="hs-comment">-- List</span><span>
</span><span id="line-202"></span><span>                  </span><span class="hs-special">(</span><span id="local-6989586621679454621"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454621"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679454620"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454620"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadMiddle tr slc v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454645"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                  </span><span id="local-6989586621679454619"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454619"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadLeft tr slc
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454649"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454646"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454621"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- Check boundaries TODO</span><span>
</span><span id="line-204"></span><span>                  </span><span id="local-6989586621679454618"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454618"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall tr tr' slc slc' v.
Eval tr tr' slc slc' v -&gt; UnspreadRight tr slc
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval es es' ns ns' o
</span><a href="#local-6989586621679454834"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454642"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454641"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454621"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="hs-comment">-- TODO boundaris</span><span>
</span><span id="line-205"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {es'}. es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454617"><span class="hs-identifier hs-var">getState</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454619"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454621"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454618"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454620"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-206"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>                </span><span id="local-6989586621679454617"><span class="annot"><span class="annottext">getState :: es -&gt; ns -&gt; es -&gt; o -&gt; SearchState es es' ns o
</span><a href="#local-6989586621679454617"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span id="local-6989586621679454616"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454616"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679454615"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454615"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679454614"><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454614"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679454613"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454613"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o.
Path (Trans es) (Slice ns) -&gt; [o] -&gt; SearchState es es' ns o
</span><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-var">SSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454616"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454647"><span class="hs-identifier hs-var">tlBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ns. ns -&gt; Slice ns
</span><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-var">Slice</span></a></span><span> </span><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679454615"><span class="hs-identifier hs-var">sTop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. es -&gt; Bool -&gt; Bool -&gt; Trans es
</span><a href="HeuristicParser.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span><span> </span><span class="annot"><span class="annottext">es
</span><a href="#local-6989586621679454614"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454640"><span class="hs-identifier hs-var">tr2nd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679454639"><span class="hs-identifier hs-var">trBoundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Slice ns
</span><a href="#local-6989586621679454638"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Trans es) (Slice ns)
</span><a href="#local-6989586621679454637"><span class="hs-identifier hs-var">rst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679454613"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679454696"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Keep in mind we start at the very end of the piece to parse.</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Everytime we thaw a transition we send it the evaluator. Set t2nd upon an unspread, for use later for splits.</span><span>
</span><span id="line-211"></span></pre></body></html>