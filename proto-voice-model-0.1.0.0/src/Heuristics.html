<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Heuristics</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Csv</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.Split</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Display.html"><span class="hs-identifier">Display</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Evaluator.html"><span class="hs-identifier">Evaluator</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HeuristicParser.html"><span class="hs-identifier">HeuristicParser</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HeuristicSearch.html"><span class="hs-identifier">HeuristicSearch</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PBHModel.html"><span class="hs-identifier">PBHModel</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.DoNotation</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Core</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Music</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Pitch.Spelled</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PVGrammar.html"><span class="hs-identifier">PVGrammar</span></a></span><span> </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PVGrammar.html#slicesFromFile"><span class="hs-identifier">slicesFromFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PVGrammar.Generate.html"><span class="hs-identifier">PVGrammar.Generate</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PVGrammar.Parse.html"><span class="hs-identifier">PVGrammar.Parse</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Monad</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-identifier">lift</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-identifier">pure</span></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwE</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><a href="Heuristics.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HeuristicParser.html#SearchState"><span class="hs-identifier hs-type">SearchState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Edges"><span class="hs-identifier hs-type">Edges</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PVGrammar.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#Notes"><span class="hs-identifier hs-type">Notes</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVLeftmost"><span class="hs-identifier hs-type">PVLeftmost</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Heuristics.html#applyHeuristic"><span class="hs-identifier hs-type">applyHeuristic</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVLeftmost"><span class="hs-identifier hs-type">PVLeftmost</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span> </span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Heuristics.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Heuristics.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-48"></span><span id="applyHeuristic"><span class="annot"><span class="annottext">applyHeuristic :: (Maybe (PVLeftmost SPitch) -&gt; State -&gt; ExceptT String IO Float)
-&gt; State -&gt; IO Float
</span><a href="Heuristics.html#applyHeuristic"><span class="hs-identifier hs-var hs-var">applyHeuristic</span></a></span></span><span> </span><span id="local-6989586621679474652"><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch) -&gt; State -&gt; ExceptT String IO Float
</span><a href="#local-6989586621679474652"><span class="hs-identifier hs-var">heuristic</span></a></span></span><span> </span><span id="local-6989586621679474651"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474651"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679474650"><span class="annot"><span class="annottext">Either String Float
</span><a href="#local-6989586621679474650"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch) -&gt; State -&gt; ExceptT String IO Float
</span><a href="#local-6989586621679474652"><span class="hs-identifier hs-var">heuristic</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch)
</span><a href="#local-6989586621679474649"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474651"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String Float
</span><a href="#local-6989586621679474650"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474648"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474648"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474648"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1000.0</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679474646"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679474646"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679474646"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-55"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679474645"><span class="annot"><span class="annottext">ops :: [PVLeftmost SPitch]
</span><a href="#local-6989586621679474645"><span class="hs-identifier hs-var hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall es es' ns o. SearchState es es' ns o -&gt; [o]
</span><a href="HeuristicParser.html#getOpsFromState"><span class="hs-identifier hs-var">getOpsFromState</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474651"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679474649"><span class="annot"><span class="annottext">op :: Maybe (PVLeftmost SPitch)
</span><a href="#local-6989586621679474649"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[PVLeftmost SPitch]
</span><a href="#local-6989586621679474645"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679474643"><span class="annot"><span class="annottext">PVLeftmost SPitch
</span><a href="#local-6989586621679474643"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[PVLeftmost SPitch]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PVLeftmost SPitch
</span><a href="#local-6989586621679474643"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="#local-6989586621679474642"><span class="hs-identifier hs-type">remainingOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679474642"><span class="annot"><span class="annottext">remainingOps :: Float
</span><a href="#local-6989586621679474642"><span class="hs-identifier hs-var hs-var">remainingOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall es es' ns o. SearchState es es' ns o -&gt; Int
</span><a href="HeuristicParser.html#getPathLengthFromState"><span class="hs-identifier hs-var">getPathLengthFromState</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474651"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- ActionDouble (&#8906;,|{},{F5,C5,A3},|{F5-F5,C5-C5},{F5,C5,G4}) (LMDoubleSplitLeft regular:{}, passing:{}, ls:{}, rs:{[A4:LeftRepeat]&lt;=A3,[C5:LeftRepeat]&lt;=C5,[F3:LeftRepeat,F5:LeftRepeat]&lt;=F5}, kl:{}, kr:{F5-F5,C5-C5}, pl:{}, pr:{})</span><span>
</span><span id="line-66"></span><span id="testOp"><span class="annot"><span class="annottext">testOp :: ActionDouble ns tr (Split SPC) f h
</span><a href="Heuristics.html#testOp"><span class="hs-identifier hs-var hs-var">testOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">forall ns tr s f h.
(StartStop ns, Trans tr, ns, Trans tr, StartStop ns)
-&gt; LeftmostDouble s f h -&gt; ActionDouble ns tr s f h
</span><a href="HeuristicParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span> </span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">forall s f h. s -&gt; LeftmostDouble s f h
</span><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-var">LMDoubleSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall n a. Writer (Split n) a -&gt; Split n
</span><a href="PVGrammar.Generate.html#mkSplit"><span class="hs-identifier hs-var">mkSplit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="annottext">forall n.
(Ord n, Hashable n) =&gt;
n -&gt; n -&gt; LeftOrnament -&gt; Bool -&gt; Writer (Split n) ()
</span><a href="PVGrammar.Generate.html#addToRight"><span class="hs-identifier hs-var">addToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Accidental -&gt; SPC
</span><span class="hs-identifier hs-var">c'</span></span><span> </span><span class="annot"><span class="annottext">Accidental
</span><span class="hs-identifier hs-var">nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Accidental -&gt; SPC
</span><span class="hs-identifier hs-var">c'</span></span><span> </span><span class="annot"><span class="annottext">Accidental
</span><span class="hs-identifier hs-var">nat</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftOrnament
</span><a href="PVGrammar.html#LeftRepeat"><span class="hs-identifier hs-var">LeftRepeat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="Heuristics.html#testHeuristic"><span class="hs-identifier hs-type">testHeuristic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PBHModel.html#HarmonicProfileData"><span class="hs-identifier hs-type">HarmonicProfileData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#PVLeftmost"><span class="hs-identifier hs-type">PVLeftmost</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SPitch</span></span><span> </span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Heuristics.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-73"></span><span id="testHeuristic"><span class="annot"><span class="annottext">testHeuristic :: HarmonicProfileData
-&gt; Maybe (PVLeftmost SPitch) -&gt; State -&gt; ExceptT String IO Float
</span><a href="Heuristics.html#testHeuristic"><span class="hs-identifier hs-var hs-var">testHeuristic</span></a></span></span><span> </span><span id="local-6989586621679474616"><span class="annot"><span class="annottext">HarmonicProfileData
</span><a href="#local-6989586621679474616"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679474615"><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch)
</span><a href="#local-6989586621679474615"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679474614"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch)
</span><a href="#local-6989586621679474615"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">100.0</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PVLeftmost SPitch)
</span><a href="#local-6989586621679474615"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">-- Freezing</span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-comment">-- no unfreeze if there are 3 open non boundary transition</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span id="local-6989586621679474611"><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679474611"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679474610"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474610"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {c} {es'} {d} {o}.
MonadError String m =&gt;
SearchState c es' d o -&gt; m (c, d, c, d)
</span><a href="#local-6989586621679474609"><span class="hs-identifier hs-var">getParentDouble</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Eq (IntervalOf n), HasPitch n) =&gt;
Freeze -&gt; Edges n -&gt; Either String (Edges n)
</span><a href="PVGrammar.Generate.html#applyFreeze"><span class="hs-identifier hs-var">applyFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679474611"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474610"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-82"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474607"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474607"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474607"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-83"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679474606"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474606"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.2</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-comment">-- Spreading</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- Calculate for each chord possibility, the likelihood that they are all the same chord</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-comment">-- Splitting Right</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-comment">{-
                              split:
      ..=[_]----pl----[slc]-==----pr---[_]....
            \cl      /     \          /cr
             \      /       \        /
              [slcl]----cm---[ slcr ]
      -}</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-type">LMDoubleSpread</span></a></span><span> </span><span id="local-6989586621679474604"><span class="annot"><span class="annottext">spreadOp :: Spread SPitch
</span><a href="#local-6989586621679474604"><span class="hs-identifier hs-var">spreadOp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="PVGrammar.html#SpreadOp"><span class="hs-identifier hs-type">SpreadOp</span></a></span><span> </span><span id="local-6989586621679474602"><span class="annot"><span class="annottext">HashMap SPitch SpreadDirection
</span><a href="#local-6989586621679474602"><span class="hs-identifier hs-var">spreads</span></a></span></span><span> </span><span id="local-6989586621679474601"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474601"><span class="hs-identifier hs-var">edges</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679474600"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474600"><span class="hs-identifier hs-var">parentl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474599"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474599"><span class="hs-identifier hs-var">slc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474598"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474598"><span class="hs-identifier hs-var">parentr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {c} {es'} {d} {o}.
MonadError String m =&gt;
SearchState c es' d o -&gt; m (c, d, c, d)
</span><a href="#local-6989586621679474609"><span class="hs-identifier hs-var">getParentDouble</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Ord n, Notation n, Hashable n) =&gt;
Spread n
-&gt; Edges n
-&gt; Notes n
-&gt; Edges n
-&gt; Either String (Edges n, Notes n, Edges n, Notes n, Edges n)
</span><a href="PVGrammar.Generate.html#applySpread"><span class="hs-identifier hs-var">applySpread</span></a></span><span> </span><span class="annot"><span class="annottext">Spread SPitch
</span><a href="#local-6989586621679474604"><span class="hs-identifier hs-var">spreadOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474600"><span class="hs-identifier hs-var">parentl</span></a></span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474599"><span class="hs-identifier hs-var">slc</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474598"><span class="hs-identifier hs-var">parentr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474596"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474596"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474596"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474595"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474595"><span class="hs-identifier hs-var">childl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474594"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474594"><span class="hs-identifier hs-var">slcl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474593"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474593"><span class="hs-identifier hs-var">childm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474592"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474592"><span class="hs-identifier hs-var">slcr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474591"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474591"><span class="hs-identifier hs-var">childr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Evaluating Spread operation:&quot;</span></span><span>
</span><span id="line-101"></span><span>            </span><span class="hs-comment">-- lift $ print (childl,slcl,childm,slcr,childr)</span><span>
</span><span id="line-102"></span><span>            </span><span class="hs-comment">-- lift $ print (parentl, slc, parentr)</span><span>
</span><span id="line-103"></span><span>            </span><span class="hs-comment">-- lift $ print &quot;parent:&quot;</span><span>
</span><span id="line-104"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474590"><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474590"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474589"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474589"><span class="hs-identifier hs-var">chordType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474588"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474588"><span class="hs-identifier hs-var">cProb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData -&gt; Notes SPitch -&gt; (SIC, String, Double)
</span><a href="PBHModel.html#mostLikelyChordFromSlice"><span class="hs-identifier hs-var">mostLikelyChordFromSlice</span></a></span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData
</span><a href="#local-6989586621679474616"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474599"><span class="hs-identifier hs-var">slc</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-comment">-- lift $ print &quot;left:&quot;</span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-comment">-- lift $ print $ mostLikelyChordFromSlice params slcl</span><span>
</span><span id="line-107"></span><span>            </span><span class="hs-comment">-- lift $ print &quot;right:&quot;</span><span>
</span><span id="line-108"></span><span>            </span><span class="hs-comment">-- lift $ print $ mostLikelyChordFromSlice params slcr</span><span>
</span><span id="line-109"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474586"><span class="annot"><span class="annottext">mu :: Double
</span><a href="#local-6989586621679474586"><span class="hs-identifier hs-var hs-var">mu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData -&gt; ChordLabel -&gt; Notes SIC -&gt; Double
</span><a href="PBHModel.html#sliceChordLogLikelihood"><span class="hs-identifier hs-var">sliceChordLogLikelihood</span></a></span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData
</span><a href="#local-6989586621679474616"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SIC -&gt; String -&gt; ChordLabel
</span><a href="#local-6989586621679474584"><span class="hs-identifier hs-var">mkLbl</span></a></span><span> </span><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474590"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474589"><span class="hs-identifier hs-var">chordType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Notes SPitch -&gt; Notes SIC
</span><a href="PBHModel.html#transformSlice"><span class="hs-identifier hs-var">transformSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474599"><span class="hs-identifier hs-var">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474582"><span class="annot"><span class="annottext">wu :: Double
</span><a href="#local-6989586621679474582"><span class="hs-identifier hs-var hs-var">wu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData -&gt; ChordLabel -&gt; Notes SIC -&gt; Double
</span><a href="PBHModel.html#sliceChordLogLikelihood"><span class="hs-identifier hs-var">sliceChordLogLikelihood</span></a></span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData
</span><a href="#local-6989586621679474616"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SIC -&gt; String -&gt; ChordLabel
</span><a href="#local-6989586621679474584"><span class="hs-identifier hs-var">mkLbl</span></a></span><span> </span><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474590"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474589"><span class="hs-identifier hs-var">chordType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Notes SPitch -&gt; Notes SIC
</span><a href="PBHModel.html#transformSlice"><span class="hs-identifier hs-var">transformSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474594"><span class="hs-identifier hs-var">slcl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474581"><span class="annot"><span class="annottext">ru :: Double
</span><a href="#local-6989586621679474581"><span class="hs-identifier hs-var hs-var">ru</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData -&gt; ChordLabel -&gt; Notes SIC -&gt; Double
</span><a href="PBHModel.html#sliceChordLogLikelihood"><span class="hs-identifier hs-var">sliceChordLogLikelihood</span></a></span><span> </span><span class="annot"><span class="annottext">HarmonicProfileData
</span><a href="#local-6989586621679474616"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SIC -&gt; String -&gt; ChordLabel
</span><a href="#local-6989586621679474584"><span class="hs-identifier hs-var">mkLbl</span></a></span><span> </span><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474590"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474589"><span class="hs-identifier hs-var">chordType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Notes SPitch -&gt; Notes SIC
</span><a href="PBHModel.html#transformSlice"><span class="hs-identifier hs-var">transformSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474592"><span class="hs-identifier hs-var">slcr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474576"><span class="annot"><span class="annottext">pu :: Double
</span><a href="#local-6989586621679474576"><span class="hs-identifier hs-var hs-var">pu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474586"><span class="hs-identifier hs-var">mu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474582"><span class="hs-identifier hs-var">wu</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474581"><span class="hs-identifier hs-var">ru</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474581"><span class="hs-identifier hs-var">ru</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mu: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474586"><span class="hs-identifier hs-var">mu</span></a></span><span>
</span><span id="line-114"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;val: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679474576"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2.0</span></span><span>
</span><span id="line-117"></span><span>           </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-comment">-- trace (show $ mostLikelyChordFromSlice params parent ) -2.0</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>            </span><span id="local-6989586621679474584"><span class="annot"><span class="annottext">mkLbl :: SIC -&gt; String -&gt; ChordLabel
</span><a href="#local-6989586621679474584"><span class="hs-identifier hs-var hs-var">mkLbl</span></a></span></span><span> </span><span id="local-6989586621679474573"><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474573"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679474572"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474572"><span class="hs-identifier hs-var">chordType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SIC -&gt; SPC -&gt; ChordLabel
</span><a href="PBHModel.html#ChordLabel"><span class="hs-identifier hs-var">ChordLabel</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474572"><span class="hs-identifier hs-var">chordType</span></a></span><span> </span><span class="annot"><span class="annottext">SIC
</span><a href="#local-6989586621679474573"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SPC
</span><span class="hs-identifier hs-var">spc</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-comment">-- predChord = mostLikelyChord hpData parent</span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-comment">-- jointLogLikelihood =</span><span>
</span><span id="line-123"></span><span>            </span><span class="hs-comment">--     sliceChordLogLikelihood childl</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-comment">--   + sliceChordLogLikelihood childr</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-comment">--   - sliceChordLogLikelihood predChord</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-comment">-- jointLikelihood</span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><a href="#local-6989586621679474569"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PVGrammar.html#SpreadDirection"><span class="hs-identifier hs-type">SpreadDirection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-129"></span><span>            </span><span id="local-6989586621679474569"><span class="annot"><span class="annottext">go :: SpreadDirection -&gt; Float
</span><a href="#local-6989586621679474569"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- Freezing (Terminate)</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- numSlices From  SSFrozen with 1 or 1+ transitions</span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span id="local-6989586621679474566"><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679474566"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621679474565"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474565"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {es'} {ns} {o}.
MonadError String m =&gt;
SearchState a es' ns o -&gt; m a
</span><a href="#local-6989586621679474564"><span class="hs-identifier hs-var">getParentSingle</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Eq (IntervalOf n), HasPitch n) =&gt;
Freeze -&gt; Edges n -&gt; Either String (Edges n)
</span><a href="PVGrammar.Generate.html#applyFreeze"><span class="hs-identifier hs-var">applyFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Freeze
</span><a href="#local-6989586621679474566"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474565"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474563"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474563"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474563"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679474562"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474562"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.2</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">-- Splitting Only</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-comment">{-
                                      split:
                             ..=[mS]--parent---end
                                  cl\        /cr
                                      [slc]
      -}</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span id="local-6989586621679474560"><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474560"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679474559"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474559"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {es'} {ns} {o}.
MonadError String m =&gt;
SearchState a es' ns o -&gt; m a
</span><a href="#local-6989586621679474564"><span class="hs-identifier hs-var">getParentSingle</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Ord n, Notation n, Hashable n) =&gt;
Split n -&gt; Edges n -&gt; Either String (Edges n, Notes n, Edges n)
</span><a href="PVGrammar.Generate.html#applySplit"><span class="hs-identifier hs-var">applySplit</span></a></span><span> </span><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474560"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474559"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474557"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474557"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474557"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-150"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474556"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474556"><span class="hs-identifier hs-var">childl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474555"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474555"><span class="hs-identifier hs-var">slc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474554"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474554"><span class="hs-identifier hs-var">childr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.0</span></span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-comment">-- Splitting Left</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">{-
                                      split:
                             ..=[mS]--parent---[slcl]--tr--[slcr]...
                                  cl\        /cr
                                      [slc]
      -}</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span id="local-6989586621679474553"><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474553"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Splitting Left&quot;</span></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679474552"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474552"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474551"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474551"><span class="hs-identifier hs-var">slcl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474550"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474550"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474549"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474549"><span class="hs-identifier hs-var">slcr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {c} {es'} {d} {o}.
MonadError String m =&gt;
SearchState c es' d o -&gt; m (c, d, c, d)
</span><a href="#local-6989586621679474609"><span class="hs-identifier hs-var">getParentDouble</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Ord n, Notation n, Hashable n) =&gt;
Split n -&gt; Edges n -&gt; Either String (Edges n, Notes n, Edges n)
</span><a href="PVGrammar.Generate.html#applySplit"><span class="hs-identifier hs-var">applySplit</span></a></span><span> </span><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474553"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474552"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474548"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474548"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474548"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-163"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474547"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474547"><span class="hs-identifier hs-var">childl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474546"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474546"><span class="hs-identifier hs-var">slice</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474545"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474545"><span class="hs-identifier hs-var">childr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2.0</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-comment">-- Splitting Right</span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-comment">{-
                                      split:
              ..=[mS]--tl---[slcl]---parent---[slcr]....
                               cl\           /cr
                                  \         /
                                    [ slc ]
      -}</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-type">LMDoubleSplitRight</span></a></span><span> </span><span id="local-6989586621679474543"><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474543"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679474542"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474542"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474541"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474541"><span class="hs-identifier hs-var">slcl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474540"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474540"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474539"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474539"><span class="hs-identifier hs-var">slcr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {c} {es'} {d} {o}.
MonadError String m =&gt;
SearchState c es' d o -&gt; m (c, d, c, d)
</span><a href="#local-6989586621679474609"><span class="hs-identifier hs-var">getParentDouble</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679474614"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall n.
(Ord n, Notation n, Hashable n) =&gt;
Split n -&gt; Edges n -&gt; Either String (Edges n, Notes n, Edges n)
</span><a href="PVGrammar.Generate.html#applySplit"><span class="hs-identifier hs-var">applySplit</span></a></span><span> </span><span class="annot"><span class="annottext">Split SPitch
</span><a href="#local-6989586621679474543"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474540"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679474538"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474538"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679474538"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474537"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474537"><span class="hs-identifier hs-var">childl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474536"><span class="annot"><span class="annottext">Notes SPitch
</span><a href="#local-6989586621679474536"><span class="hs-identifier hs-var">slice</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474535"><span class="annot"><span class="annottext">Edges SPitch
</span><a href="#local-6989586621679474535"><span class="hs-identifier hs-var">childr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.5</span></span><span>
</span><span id="line-178"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679474609"><span class="annot"><span class="annottext">getParentDouble :: SearchState c es' d o -&gt; m (c, d, c, d)
</span><a href="#local-6989586621679474609"><span class="hs-identifier hs-var hs-var">getParentDouble</span></a></span></span><span> </span><span id="local-6989586621679474519"><span class="annot"><span class="annottext">SearchState c es' d o
</span><a href="#local-6989586621679474519"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SearchState c es' d o
</span><a href="#local-6989586621679474519"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSFrozen"><span class="hs-identifier hs-type">SSFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice d)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ERRORMSG&quot;</span></span><span> </span><span class="hs-comment">-- SSFrozen can only be the frist state.</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-type">SSOpen</span></a></span><span> </span><span id="local-6989586621679474516"><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474516"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679474515"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679474515"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474516"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474513"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474513"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679474512"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474512"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474511"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474511"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679474510"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474510"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679474509"><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474509"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474513"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474512"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474511"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474510"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- SSOpen only case is a split from  two open transitions.</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474506"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474506"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679474505"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474505"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;illegal double spread&quot;</span></span><span> </span><span class="hs-comment">-- illegal?</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;illegal double spread&quot;</span></span><span> </span><span class="hs-comment">-- SSOpen only case is a split from  two open transitions.</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-type">SSSemiOpen</span></a></span><span> </span><span id="local-6989586621679474502"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice d)
</span><a href="#local-6989586621679474502"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679474500"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679474500"><span class="hs-identifier hs-var">midSlice</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679474499"><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474499"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679474498"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679474498"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474499"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- From two open transitions only</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474497"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474497"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679474496"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474496"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474495"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474495"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679474494"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474494"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679474493"><span class="annot"><span class="annottext">Path (Trans c) (Slice d)
</span><a href="#local-6989586621679474493"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474497"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474496"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474495"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474494"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- SSOpen only case is a split from  two open transitions.</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679474492"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474492"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679474491"><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474491"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679474490"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474490"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474492"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall ns. Slice ns -&gt; ns
</span><a href="HeuristicParser.html#sContent"><span class="hs-identifier hs-var">sContent</span></a></span><span> </span><span class="annot"><span class="annottext">Slice d
</span><a href="#local-6989586621679474491"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474490"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- SSOpen only case is a split from  two open transitions.</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679474489"><span class="annot"><span class="annottext">Trans c
</span><a href="#local-6989586621679474489"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This case I believe never occurs?&quot;</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679474564"><span class="annot"><span class="annottext">getParentSingle :: SearchState a es' ns o -&gt; m a
</span><a href="#local-6989586621679474564"><span class="hs-identifier hs-var hs-var">getParentSingle</span></a></span></span><span> </span><span id="local-6989586621679474479"><span class="annot"><span class="annottext">SearchState a es' ns o
</span><a href="#local-6989586621679474479"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SearchState a es' ns o
</span><a href="#local-6989586621679474479"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSFrozen"><span class="hs-identifier hs-type">SSFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wtf&quot;</span></span><span> </span><span class="hs-comment">-- SSFrozen can only be the frist state.</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSOpen"><span class="hs-identifier hs-type">SSOpen</span></a></span><span> </span><span id="local-6989586621679474478"><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><a href="#local-6989586621679474478"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679474477"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679474477"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><a href="#local-6989586621679474478"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679474476"><span class="annot"><span class="annottext">Trans a
</span><a href="#local-6989586621679474476"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans a
</span><a href="#local-6989586621679474476"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-comment">-- SSOpen only case is a split from  two open transitions.</span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal single &quot;</span></span><span> </span><span class="hs-comment">-- illegal state</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="HeuristicParser.html#SSSemiOpen"><span class="hs-identifier hs-type">SSSemiOpen</span></a></span><span> </span><span id="local-6989586621679474475"><span class="annot"><span class="annottext">Path (Maybe es', Bool) (Slice ns)
</span><a href="#local-6989586621679474475"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HeuristicParser.html#Slice"><span class="hs-identifier hs-type">Slice</span></a></span><span> </span><span id="local-6989586621679474474"><span class="annot"><span class="annottext">ns
</span><a href="#local-6989586621679474474"><span class="hs-identifier hs-var">midSlice</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679474473"><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><a href="#local-6989586621679474473"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679474472"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679474472"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><a href="#local-6989586621679474473"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- From two open transitions only</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679474471"><span class="annot"><span class="annottext">Trans a
</span><a href="#local-6989586621679474471"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (x :: * -&gt; *) a. PureSyntax x =&gt; a -&gt; x a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall es. Trans es -&gt; es
</span><a href="HeuristicParser.html#tContent"><span class="hs-identifier hs-var">tContent</span></a></span><span> </span><span class="annot"><span class="annottext">Trans a
</span><a href="#local-6989586621679474471"><span class="hs-identifier hs-var">parent</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">Path (Trans a) (Slice ns)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal single&quot;</span></span><span> </span><span class="hs-comment">-- illegal state</span><span>
</span><span id="line-202"></span></pre></body></html>