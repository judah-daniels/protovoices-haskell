<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Streamly.Internal.Data.Parser.ParserK.Type</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">streamly-0.8.1.1: Dataflow programming and declarative concurrency</span><ul class="links" id="page-menu"><li><a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2020 Composewell Technologies</td></tr><tr><th>License</th><td>BSD-3-Clause</td></tr><tr><th>Maintainer</th><td>streamly@composewell.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>GHC</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Streamly.Internal.Data.Parser.ParserK.Type</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Conversion</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>CPS style implementation of parsers.</p><p>The CPS representation allows linear performance for Applicative, sequenceA,
 Monad, sequence, and Alternative, choice operations compared to the
 quadratic complexity of the corresponding direct style operations. However,
 direct style operations allow fusion with ~10x better performance than CPS.</p><p>The direct style representation does not allow for recursive definitions of
 &quot;some&quot; and &quot;many&quot; whereas CPS allows that.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">newtype</span> <a href="#t:Parser">Parser</a> m a b = <a href="#v:MkParser">MkParser</a> {<ul class="subs"><li><a href="#v:runParser">runParser</a> :: <span class="keyword">forall</span> r. <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; ((<a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; Parse b -&gt; m (Driver m a r)) -&gt; m (Driver m a r)</li></ul>}</li><li class="src short"><a href="#v:fromPure">fromPure</a> :: b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b</li><li class="src short"><a href="#v:fromEffect">fromEffect</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; m b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b</li><li class="src short"><a href="#v:die">die</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b</li><li class="src short"><a href="#v:toParserK">toParserK</a> :: <a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadCatch" title="Control.Monad.Catch">MonadCatch</a> m =&gt; <a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b</li><li class="src short"><a href="#v:fromParserK">fromParserK</a> :: <a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m =&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a> m a b</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Parser" class="def">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#Parser" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></p><div class="doc"><p>A continuation passing style parser representation.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MkParser" class="def">MkParser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:runParser" class="def">runParser</a> :: <span class="keyword">forall</span> r. <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; ((<a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) -&gt; Parse b -&gt; m (Driver m a r)) -&gt; m (Driver m a r)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Parser">Instances</h4><details id="i:Parser" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:MonadReader:1"></span> (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m, <a href="../mtl-2.2.2/Control-Monad-Reader-Class.html#t:MonadReader" title="Control.Monad.Reader.Class">MonadReader</a> r m, <a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadCatch" title="Control.Monad.Catch">MonadCatch</a> m) =&gt; <a href="../mtl-2.2.2/Control-Monad-Reader-Class.html#t:MonadReader" title="Control.Monad.Reader.Class">MonadReader</a> r (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-418" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Parser:MonadReader:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:ask">ask</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a r <a href="#v:ask" class="selflink">#</a></p><p class="src"><a href="#v:local">local</a> :: (r -&gt; r) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:local" class="selflink">#</a></p><p class="src"><a href="#v:reader">reader</a> :: (r -&gt; a0) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:reader" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:MonadState:2"></span> (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m, <a href="../mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> s m) =&gt; <a href="../mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> s (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-426" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Parser:MonadState:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:get">get</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a s <a href="#v:get" class="selflink">#</a></p><p class="src"><a href="#v:put">put</a> :: s -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a () <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:state">state</a> :: (s -&gt; (a0, s)) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:state" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:MonadFail:3"></span> <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Control-Monad-Fail.html#t:MonadFail" title="Control.Monad.Fail">MonadFail</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-413" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Parser:MonadFail:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:fail" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:MonadIO:4"></span> (<a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m, <a href="../base-4.16.4.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m) =&gt; <a href="../base-4.16.4.0/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-433" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Parser:MonadIO:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftIO">liftIO</a> :: <a href="../base-4.16.4.0/System-IO.html#t:IO" title="System.IO">IO</a> a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:liftIO" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:Alternative:5"></span> <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-454" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc"><p><code><a href="../base-4.16.4.0/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a></code> form of <code><a href="Streamly-Internal-Data-Parser.html#v:alt" title="Streamly.Internal.Data.Parser">alt</a></code>. Backtrack and
 run the second parser if the first one fails.</p><p>The &quot;some&quot; and &quot;many&quot; operations of alternative accumulate results in a pure
 list which is not scalable and streaming. Instead use
 <code><a href="Streamly-Internal-Data-Parser.html#v:some" title="Streamly.Internal.Data.Parser">some</a></code> and
 <code><a href="Streamly-Internal-Data-Parser.html#v:many" title="Streamly.Internal.Data.Parser">many</a></code> for fusible operations with composable
 accumulation of results.</p><p>See also <code><a href="Streamly-Internal-Data-Parser.html#v:alt" title="Streamly.Internal.Data.Parser">alt</a></code>. This <code><a href="../base-4.16.4.0/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a></code> instance
 does not fuse, use <code><a href="Streamly-Internal-Data-Parser.html#v:alt" title="Streamly.Internal.Data.Parser">alt</a></code> when you need
 fusion.</p></td></tr><tr><td colspan="2"><details id="i:id:Parser:Alternative:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:empty">empty</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:empty" class="selflink">#</a></p><p class="src"><a href="#v:-60--124--62-">(&lt;|&gt;)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:-60--124--62-" class="selflink">#</a></p><p class="src"><a href="#v:some">some</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a [a0] <a href="#v:some" class="selflink">#</a></p><p class="src"><a href="#v:many">many</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a [a0] <a href="#v:many" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:Applicative:6"></span> <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-308" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc"><p><code><a href="../base-4.16.4.0/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a></code> form of <code><a href="Streamly-Internal-Data-Parser.html#v:serialWith" title="Streamly.Internal.Data.Parser">serialWith</a></code>. Note that
 this operation does not fuse, use <code><a href="Streamly-Internal-Data-Parser.html#v:serialWith" title="Streamly.Internal.Data.Parser">serialWith</a></code>
 when fusion is important.</p></td></tr><tr><td colspan="2"><details id="i:id:Parser:Applicative:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a (a0 -&gt; b) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:liftA2">liftA2</a> :: (a0 -&gt; b -&gt; c) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a c <a href="#v:liftA2" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:-60--42-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:Functor:7"></span> <a href="../base-4.16.4.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="../base-4.16.4.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-276" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc"><p>Maps a function over the output of the parser.</p></td></tr><tr><td colspan="2"><details id="i:id:Parser:Functor:7"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a0 -&gt; b) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:Monad:8"></span> <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-392" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc"><p>Monad composition can be used for lookbehind parsers, we can make the
 future parses depend on the previously parsed values.</p><p>If we have to parse &quot;a9&quot; or &quot;9a&quot; but not &quot;99&quot; or &quot;aa&quot; we can use the
 following parser:</p><pre>backtracking :: MonadCatch m =&gt; PR.Parser m Char String
backtracking =
    sequence [PR.satisfy isDigit, PR.satisfy isAlpha]
    <code><a href="../base-4.16.4.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code>
    sequence [PR.satisfy isAlpha, PR.satisfy isDigit]
</pre><p>We know that if the first parse resulted in a digit at the first place then
 the second parse is going to fail.  However, we waste that information and
 parse the first character again in the second parse only to know that it is
 not an alphabetic char.  By using lookbehind in a <code><a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a></code> composition we can
 avoid redundant work:</p><pre>data DigitOrAlpha = Digit Char | Alpha Char

lookbehind :: MonadCatch m =&gt; PR.Parser m Char String
lookbehind = do
    x1 &lt;-    Digit <code><a href="../base-4.16.4.0/Data-Functor.html#v:-60--36--62-" title="Data.Functor">&lt;$&gt;</a></code> PR.satisfy isDigit
         <code><a href="../base-4.16.4.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> Alpha <code><a href="../base-4.16.4.0/Data-Functor.html#v:-60--36--62-" title="Data.Functor">&lt;$&gt;</a></code> PR.satisfy isAlpha

    -- Note: the parse depends on what we parsed already
    x2 &lt;- case x1 of
        Digit _ -&gt; PR.satisfy isAlpha
        Alpha _ -&gt; PR.satisfy isDigit

    return $ case x1 of
        Digit x -&gt; [x,x2]
        Alpha x -&gt; [x,x2]
</pre><p>See also <code><a href="Streamly-Internal-Data-Parser.html#v:concatMap" title="Streamly.Internal.Data.Parser">concatMap</a></code>. This monad instance
 does not fuse, use <code><a href="Streamly-Internal-Data-Parser.html#v:concatMap" title="Streamly.Internal.Data.Parser">concatMap</a></code> when you need
 fusion.</p></td></tr><tr><td colspan="2"><details id="i:id:Parser:Monad:8"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; (a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b) -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:return" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Parser:MonadPlus:9"></span> <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> (<a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a)</span> <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#line-489" class="link">Source</a> <a href="#t:Parser" class="selflink">#</a></td><td class="doc"><p><code><a href="../base-4.16.4.0/Control-Monad.html#v:mzero" title="Control.Monad">mzero</a></code> is same as <code><a href="../base-4.16.4.0/Control-Applicative.html#v:empty" title="Control.Applicative">empty</a></code>, it aborts the parser. <code><a href="../base-4.16.4.0/Control-Monad.html#v:mplus" title="Control.Monad">mplus</a></code> is same as
 <code><a href="../base-4.16.4.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code>, it selects the first succeeding parser.</p><p><em>Pre-release</em></p></td></tr><tr><td colspan="2"><details id="i:id:Parser:MonadPlus:9"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Parser-ParserK-Type.html">Streamly.Internal.Data.Parser.ParserK.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mzero">mzero</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:mzero" class="selflink">#</a></p><p class="src"><a href="#v:mplus">mplus</a> :: <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a a0 <a href="#v:mplus" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:fromPure" class="def">fromPure</a> :: b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#fromPure" class="link">Source</a> <a href="#v:fromPure" class="selflink">#</a></p><div class="doc"><p>A parser that always yields a pure value without consuming any input.</p><p><em>Pre-release</em></p></div></div><div class="top"><p class="src"><a id="v:fromEffect" class="def">fromEffect</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; m b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#fromEffect" class="link">Source</a> <a href="#v:fromEffect" class="selflink">#</a></p><div class="doc"><p>See <code><a href="Streamly-Internal-Data-Parser.html#v:fromEffect" title="Streamly.Internal.Data.Parser">fromEffect</a></code>.</p><p><em>Pre-release</em></p></div></div><div class="top"><p class="src"><a id="v:die" class="def">die</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#die" class="link">Source</a> <a href="#v:die" class="selflink">#</a></p><div class="doc"><p>A parser that always fails with an error message without consuming
 any input.</p><p><em>Pre-release</em></p></div></div><a href="#g:1" id="g:1"><h1>Conversion</h1></a><div class="top"><p class="src"><a id="v:toParserK" class="def">toParserK</a> :: <a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadCatch" title="Control.Monad.Catch">MonadCatch</a> m =&gt; <a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#toParserK" class="link">Source</a> <a href="#v:toParserK" class="selflink">#</a></p><div class="doc"><p>Convert a direct style <code><a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a></code> to a CPS style <code><a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a></code>.</p><p><em>Pre-release</em></p></div></div><div class="top"><p class="src"><a id="v:fromParserK" class="def">fromParserK</a> :: <a href="../exceptions-0.10.4/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m =&gt; <a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a> m a b -&gt; <a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a> m a b <a href="src/Streamly.Internal.Data.Parser.ParserK.Type.html#fromParserK" class="link">Source</a> <a href="#v:fromParserK" class="selflink">#</a></p><div class="doc"><p>Convert a CPS style <code><a href="Streamly-Internal-Data-Parser-ParserK-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserK.Type">Parser</a></code> to a direct style <code><a href="Streamly-Internal-Data-Parser-ParserD-Type.html#t:Parser" title="Streamly.Internal.Data.Parser.ParserD.Type">Parser</a></code>.</p><p>&quot;initial&quot; returns a continuation which can be called one input at a time
 using the &quot;step&quot; function.</p><p><em>Pre-release</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>