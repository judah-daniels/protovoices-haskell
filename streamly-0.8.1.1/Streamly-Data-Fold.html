<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Streamly.Data.Fold</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">streamly-0.8.1.1: Dataflow programming and declarative concurrency</span><ul class="links" id="page-menu"><li><a href="src/Streamly.Data.Fold.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2019 Composewell Technologies</td></tr><tr><th>License</th><td>BSD-3-Clause</td></tr><tr><th>Maintainer</th><td>streamly@composewell.com</td></tr><tr><th>Stability</th><td>released</td></tr><tr><th>Portability</th><td>GHC</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Streamly.Data.Fold</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fold Type</a></li><li><a href="#g:2">Constructors</a></li><li><a href="#g:3">Folds</a><ul><li><a href="#g:4">Accumulators</a></li><li><a href="#g:5">Terminating Folds</a></li></ul></li><li><a href="#g:6">Combinators</a><ul><li><a href="#g:7">Mapping on output</a></li><li><a href="#g:8">Mapping on Input</a></li><li><a href="#g:9">Filtering</a></li><li><a href="#g:10">Trimming</a></li><li><a href="#g:11">Serial Append</a></li><li><a href="#g:12">Parallel Distribution</a></li><li><a href="#g:13">Partitioning</a></li><li><a href="#g:14">Unzipping</a></li><li><a href="#g:15">Splitting</a></li><li><a href="#g:16">Nesting</a></li></ul></li><li><a href="#g:17">Deprecated</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> is a sink or a consumer of a stream of values.  The <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> type
 consists of an accumulator and an effectful action that absorbs a value into
 the accumulator.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import Data.Function ((&amp;))
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import qualified Streamly.Data.Fold as Fold
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import qualified Streamly.Prelude as Stream
</code></strong></pre><p>For example, a <code><a href="Streamly-Data-Fold.html#v:sum" title="Streamly.Data.Fold">sum</a></code> Fold represents adding the input to the accumulated
 sum.  A fold driver e.g. <code><a href="Streamly-Prelude.html#v:fold" title="Streamly.Prelude">fold</a></code> pushes values from a stream
 to the <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> one at a time, reducing the stream to a single value.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold Fold.sum $ Stream.fromList [1..100]
</code></strong>5050
</pre><p>Conceptually, a <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> is a data type that can mimic a strict left fold
 (<code><a href="../base-4.16.4.0/Data-List.html#v:foldl" title="Data.List">foldl</a></code>) as well as lazy right fold (<code><a href="../base-4.16.4.0/Prelude.html#v:foldr" title="Prelude">foldr</a></code>).  The above
 example is similar to a left fold using <code>(+)</code> as the step and <code>0</code> as the
 initial value of the accumulator:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Data.List.foldl' (+) 0 [1..100]
</code></strong>5050
</pre><p><code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code>s have an early termination capability e.g. the <code><a href="Streamly-Data-Fold.html#v:head" title="Streamly.Data.Fold">head</a></code> fold would
 terminate on an infinite stream:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold Fold.head $ Stream.fromList [1..]
</code></strong>Just 1
</pre><p>The above example is similar to the following right fold:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Prelude.foldr (\x _ -&gt; Just x) Nothing [1..]
</code></strong>Just 1
</pre><p><code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code>s can be combined together using combinators. For example, to create a
 fold that sums first two elements in a stream:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>sumTwo = Fold.take 2 Fold.sum
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold sumTwo $ Stream.fromList [1..100]
</code></strong>3
</pre><p>Folds can be combined to run in parallel on the same input. For example, to
 compute the average of numbers in a stream without going through the stream
 twice:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>avg = Fold.teeWith (/) Fold.sum (fmap fromIntegral Fold.length)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold avg $ Stream.fromList [1.0..100.0]
</code></strong>50.5
</pre><p>Folds can be combined so as to partition the input stream over multiple
 folds. For example, to count even and odd numbers in a stream:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>split n = if even n then Left n else Right n
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>stream = Stream.map split $ Stream.fromList [1..100]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>countEven = fmap ((&quot;Even &quot; ++) . show) Fold.length
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>countOdd = fmap ((&quot;Odd &quot;  ++) . show) Fold.length
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f = Fold.partition countEven countOdd
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold f stream
</code></strong>(&quot;Even 50&quot;,&quot;Odd 50&quot;)
</pre><p>Terminating folds can be combined to parse the stream serially such that the
 first fold consumes the input until it terminates and the second fold
 consumes the rest of the input until it terminates:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f = Fold.serialWith (,) (Fold.take 8 Fold.toList) (Fold.takeEndBy (== '\n') Fold.toList)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold f $ Stream.fromList &quot;header: hello\n&quot;
</code></strong>(&quot;header: &quot;,&quot;hello\n&quot;)
</pre><p>A <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> can be applied repeatedly on a stream to transform it to a stream
 of fold results. To split a stream on newlines:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f = Fold.takeEndBy (== '\n') Fold.toList
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.toList $ Stream.foldMany f $ Stream.fromList &quot;Hello there!\nHow are you\n&quot;
</code></strong>[&quot;Hello there!\n&quot;,&quot;How are you\n&quot;]
</pre><p>Similarly, we can split the input of a fold too:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.many f Fold.toList) $ Stream.fromList &quot;Hello there!\nHow are you\n&quot;
</code></strong>[&quot;Hello there!\n&quot;,&quot;How are you\n&quot;]
</pre><p>Please see <a href="Streamly-Internal-Data-Fold.html">Streamly.Internal.Data.Fold</a> for additional <code>Pre-release</code>
 functions.</p><h1>Folds vs. Streams</h1><p>We can often use streams or folds to achieve the same goal. However, streams
 are more efficient in composition of producers (e.g.
 <code><a href="Streamly-Prelude.html#v:serial" title="Streamly.Prelude">serial</a></code> or <code><a href="Streamly-Prelude.html#v:mergeBy" title="Streamly.Prelude">mergeBy</a></code>) whereas folds are
 more efficient in composition of consumers (e.g.  <code><a href="Streamly-Data-Fold.html#v:serialWith" title="Streamly.Data.Fold">serialWith</a></code>, <code><a href="Streamly-Data-Fold.html#v:partition" title="Streamly.Data.Fold">partition</a></code>
 or <code><a href="Streamly-Data-Fold.html#v:teeWith" title="Streamly.Data.Fold">teeWith</a></code>).</p><p>Streams are producers, transformations on streams happen on the output side:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:{
</code></strong> f stream =
       Stream.filter odd stream
     &amp; Stream.map (+1)
     &amp; Stream.sum
:}
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f $ Stream.fromList [1..100 :: Int]
</code></strong>2550
</pre><p>Folds are stream consumers with an input stream and an output value, stream
 transformations on folds happen on the input side:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:{
</code></strong>f =
       Fold.filter odd
     $ Fold.lmap (+1)
     $ Fold.sum
:}
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold f $ Stream.fromList [1..100 :: Int]
</code></strong>2550
</pre><p>Notice the similiarity in the definition of <code>f</code> in both cases, the only
 difference is the composition by <code>&amp;</code> vs <code>$</code> and the use <code>lmap</code> vs <code>map</code>, the
 difference is due to output vs input side transformations.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Fold">Fold</a> m a b</li><li class="src short"><a href="#v:foldl-39-">foldl'</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:foldlM-39-">foldlM'</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; a -&gt; m b) -&gt; m b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:foldr">foldr</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:sconcat">sconcat</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="Streamly.html#t:Semigroup" title="Streamly">Semigroup</a> a) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:mconcat">mconcat</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:foldMap">foldMap</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> b) =&gt; (a -&gt; b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:foldMapM">foldMapM</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> b) =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:drain">drain</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a ()</li><li class="src short"><a href="#v:drainBy">drainBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a ()</li><li class="src short"><a href="#v:last">last</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:length">length</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:sum">sum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Num" title="Prelude">Num</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:product">product</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Num" title="Prelude">Num</a> a, <a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:maximumBy">maximumBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; a -&gt; <a href="../base-4.16.4.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:maximum">maximum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:minimumBy">minimumBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; a -&gt; <a href="../base-4.16.4.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:minimum">minimum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:mean">mean</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:variance">variance</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:stdDev">stdDev</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a</li><li class="src short"><a href="#v:rollingHash">rollingHash</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Enum" title="Prelude">Enum</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></li><li class="src short"><a href="#v:rollingHashWithSalt">rollingHashWithSalt</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Enum" title="Prelude">Enum</a> a) =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></li><li class="src short"><a href="#v:toList">toList</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [a]</li><li class="src short"><a href="#v:toListRev">toListRev</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [a]</li><li class="src short"><a href="#v:index">index</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:head">head</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:find">find</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:lookup">lookup</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (a, b) (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b)</li><li class="src short"><a href="#v:findIndex">findIndex</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li class="src short"><a href="#v:elemIndex">elemIndex</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>)</li><li class="src short"><a href="#v:null">null</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:elem">elem</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:notElem">notElem</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:all">all</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:any">any</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:and">and</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:or">or</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:rmapM">rmapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; m c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c</li><li class="src short"><a href="#v:lmap">lmap</a> :: (a -&gt; b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r</li><li class="src short"><a href="#v:lmapM">lmapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r</li><li class="src short"><a href="#v:filter">filter</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r</li><li class="src short"><a href="#v:filterM">filterM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r</li><li class="src short"><a href="#v:catMaybes">catMaybes</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) b</li><li class="src short"><a href="#v:mapMaybe">mapMaybe</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r</li><li class="src short"><a href="#v:take">take</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:takeEndBy_">takeEndBy_</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:takeEndBy">takeEndBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:serialWith">serialWith</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x c</li><li class="src short"><a href="#v:teeWith">teeWith</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x c</li><li class="src short"><a href="#v:tee">tee</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (b, c)</li><li class="src short"><a href="#v:distribute">distribute</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; [<a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b] -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [b]</li><li class="src short"><a href="#v:partition">partition</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b x -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m c y -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (<a href="../base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> b c) (x, y)</li><li class="src short"><a href="#v:unzip">unzip</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a x -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b y -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (a, b) (x, y)</li><li class="src short"><a href="#v:many">many</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c</li><li class="src short"><a href="#v:chunksOf">chunksOf</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c</li><li class="src short"><a href="#v:concatMap">concatMap</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c</li><li class="src short"><a href="#v:sequence">sequence</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b</li><li class="src short"><a href="#v:mapM">mapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; m c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fold Type</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Fold" class="def">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.Type.html#Fold" class="link">Source</a> <a href="#t:Fold" class="selflink">#</a></p><div class="doc"><p>The type <code>Fold m a b</code> having constructor <code>Fold step initial extract</code>
 represents a fold over an input stream of values of type <code>a</code> to a final
 value of type <code>b</code> in <code><a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a></code> <code>m</code>.</p><p>The fold uses an intermediate state <code>s</code> as accumulator, the type <code>s</code> is
 internal to the specific fold definition. The initial value of the fold
 state <code>s</code> is returned by <code>initial</code>. The <code>step</code> function consumes an input
 and either returns the final result <code>b</code> if the fold is done or the next
 intermediate state (see <code><a href="Streamly-Internal-Data-Fold-Step.html#t:Step" title="Streamly.Internal.Data.Fold.Step">Step</a></code>). At any point the fold driver can extract
 the result from the intermediate state using the <code>extract</code> function.</p><p>NOTE: The constructor is not yet exposed via exposed modules, smart
 constructors are provided to create folds.  If you think you need the
 constructor of this type please consider using the smart constructors in
 <a href="Streamly-Internal-Data-Fold.html">Streamly.Internal.Data.Fold</a> instead.</p><p><em>since 0.8.0 (type changed)</em></p><p><em>Since: 0.7.0</em></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Fold">Instances</h4><details id="i:Fold" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Fold:Functor:1"></span> <a href="../base-4.16.4.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="../base-4.16.4.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a)</span> <a href="src/Streamly.Internal.Data.Fold.Type.html#line-578" class="link">Source</a> <a href="#t:Fold" class="selflink">#</a></td><td class="doc"><p>Maps a function on the output of the fold (the type <code>b</code>).</p></td></tr><tr><td colspan="2"><details id="i:id:Fold:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Streamly-Internal-Data-Fold-Type.html">Streamly.Internal.Data.Fold.Type</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a0 -&gt; b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a0 -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a0 -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a0 <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Constructors</h1></a><div class="top"><p class="src"><a id="v:foldl-39-" class="def">foldl'</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.Type.html#foldl%27" class="link">Source</a> <a href="#v:foldl-39-" class="selflink">#</a></p><div class="doc"><p>Make a fold from a left fold style pure step function and initial value of
 the accumulator.</p><p>If your <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> returns only <code><a href="Streamly-Internal-Data-Fold-Step.html#v:Partial" title="Streamly.Internal.Data.Fold.Step">Partial</a></code> (i.e. never returns a <code><a href="Streamly-Internal-Data-Fold-Step.html#v:Done" title="Streamly.Internal.Data.Fold.Step">Done</a></code>) then you
 can use <code>foldl'*</code> constructors.</p><p>A fold with an extract function can be expressed using fmap:</p><pre>mkfoldlx :: Monad m =&gt; (s -&gt; a -&gt; s) -&gt; s -&gt; (s -&gt; b) -&gt; Fold m a b
mkfoldlx step initial extract = fmap extract (foldl' step initial)
</pre><p>See also: <code>Streamly.Prelude.foldl'</code></p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:foldlM-39-" class="def">foldlM'</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; a -&gt; m b) -&gt; m b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.Type.html#foldlM%27" class="link">Source</a> <a href="#v:foldlM-39-" class="selflink">#</a></p><div class="doc"><p>Make a fold from a left fold style monadic step function and initial value
 of the accumulator.</p><p>A fold with an extract function can be expressed using rmapM:</p><pre>mkFoldlxM :: Functor m =&gt; (s -&gt; a -&gt; m s) -&gt; m s -&gt; (s -&gt; m b) -&gt; Fold m a b
mkFoldlxM step initial extract = rmapM extract (foldlM' step initial)
</pre><p>See also: <code>Streamly.Prelude.foldlM'</code></p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:foldr" class="def">foldr</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.Type.html#foldr" class="link">Source</a> <a href="#v:foldr" class="selflink">#</a></p><div class="doc"><p>Make a fold using a right fold style step function and a terminal value.
 It performs a strict right fold via a left fold using function composition.
 Note that this is strict fold, it can only be useful for constructing strict
 structures in memory. For reductions this will be very inefficient.</p><p>For example,</p><pre>toList = foldr (:) []</pre><p>See also: <code><a href="Streamly-Prelude.html#v:foldr" title="Streamly.Prelude">foldr</a></code></p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:3" id="g:3"><h1>Folds</h1></a><a href="#g:4" id="g:4"><h2>Accumulators</h2></a><div class="doc"><p>Folds that never terminate, these folds are much like strict left
 folds. <code><a href="Streamly-Data-Fold.html#v:mconcat" title="Streamly.Data.Fold">mconcat</a></code> is the fundamental accumulator.  All other accumulators
 can be expressed in terms of <code><a href="Streamly-Data-Fold.html#v:mconcat" title="Streamly.Data.Fold">mconcat</a></code> using a suitable Monoid.  Instead
 of writing folds we could write Monoids and turn them into folds.</p></div><div class="top"><p class="src"><a id="v:sconcat" class="def">sconcat</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="Streamly.html#t:Semigroup" title="Streamly">Semigroup</a> a) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#sconcat" class="link">Source</a> <a href="#v:sconcat" class="selflink">#</a></p><div class="doc"><p>Append the elements of an input stream to a provided starting value.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.sconcat 10) (Stream.map Data.Monoid.Sum $ Stream.enumerateFromTo 1 10)
</code></strong>Sum {getSum = 65}
</pre><pre>sconcat = Fold.foldl' (&lt;&gt;)
</pre><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:mconcat" class="def">mconcat</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#mconcat" class="link">Source</a> <a href="#v:mconcat" class="selflink">#</a></p><div class="doc"><p>Fold an input stream consisting of monoidal elements using <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mappend" title="Data.Monoid">mappend</a></code>
 and <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mempty" title="Data.Monoid">mempty</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold Fold.mconcat (Stream.map Data.Monoid.Sum $ Stream.enumerateFromTo 1 10)
</code></strong>Sum {getSum = 55}
</pre><pre>mconcat = Fold.sconcat mempty</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:foldMap" class="def">foldMap</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> b) =&gt; (a -&gt; b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.html#foldMap" class="link">Source</a> <a href="#v:foldMap" class="selflink">#</a></p><div class="doc"><pre>foldMap f = Fold.lmap f Fold.mconcat</pre><p>Make a fold from a pure function that folds the output of the function
 using <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mappend" title="Data.Monoid">mappend</a></code> and <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mempty" title="Data.Monoid">mempty</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.foldMap Data.Monoid.Sum) $ Stream.enumerateFromTo 1 10
</code></strong>Sum {getSum = 55}
</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:foldMapM" class="def">foldMapM</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> b) =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.html#foldMapM" class="link">Source</a> <a href="#v:foldMapM" class="selflink">#</a></p><div class="doc"><pre>foldMapM f = Fold.lmapM f Fold.mconcat</pre><p>Make a fold from a monadic function that folds the output of the function
 using <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mappend" title="Data.Monoid">mappend</a></code> and <code><a href="../base-4.16.4.0/Data-Monoid.html#v:mempty" title="Data.Monoid">mempty</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.foldMapM (return . Data.Monoid.Sum)) $ Stream.enumerateFromTo 1 10
</code></strong>Sum {getSum = 55}
</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:drain" class="def">drain</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a () <a href="src/Streamly.Internal.Data.Fold.Type.html#drain" class="link">Source</a> <a href="#v:drain" class="selflink">#</a></p><div class="doc"><p>A fold that drains all its input, running the effects and discarding the
 results.</p><pre>drain = drainBy (const (return ()))</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:drainBy" class="def">drainBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a () <a href="src/Streamly.Internal.Data.Fold.html#drainBy" class="link">Source</a> <a href="#v:drainBy" class="selflink">#</a></p><div class="doc"><pre>drainBy f = lmapM f drain
drainBy = Fold.foldMapM (void . f)</pre><p>Drain all input after passing it through a monadic function. This is the
 dual of mapM_ on stream producers.</p><p>See also: <code><a href="Streamly-Prelude.html#v:mapM_" title="Streamly.Prelude">mapM_</a></code></p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:last" class="def">last</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#last" class="link">Source</a> <a href="#v:last" class="selflink">#</a></p><div class="doc"><p>Extract the last element of the input stream, if any.</p><pre>last = fmap getLast $ Fold.foldMap (Last . Just)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:length" class="def">length</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Streamly.Internal.Data.Fold.html#length" class="link">Source</a> <a href="#v:length" class="selflink">#</a></p><div class="doc"><p>Determine the length of the input stream.</p><pre>length = fmap getSum $ Fold.foldMap (Sum . const  1)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:sum" class="def">sum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Num" title="Prelude">Num</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#sum" class="link">Source</a> <a href="#v:sum" class="selflink">#</a></p><div class="doc"><p>Determine the sum of all elements of a stream of numbers. Returns additive
 identity (<code>0</code>) when the stream is empty. Note that this is not numerically
 stable for floating point numbers.</p><pre>sum = fmap getSum $ Fold.foldMap Sum</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:product" class="def">product</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Num" title="Prelude">Num</a> a, <a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#product" class="link">Source</a> <a href="#v:product" class="selflink">#</a></p><div class="doc"><p>Determine the product of all elements of a stream of numbers. Returns
 multiplicative identity (<code>1</code>) when the stream is empty. The fold terminates
 when it encounters (<code>0</code>) in its input.</p><p>Compare with <code>Fold.foldMap Product</code>.</p><p><em>Since 0.8.0 (Added <code><a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a></code> constraint)</em></p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:maximumBy" class="def">maximumBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; a -&gt; <a href="../base-4.16.4.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#maximumBy" class="link">Source</a> <a href="#v:maximumBy" class="selflink">#</a></p><div class="doc"><p>Determine the maximum element in a stream using the supplied comparison
 function.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:maximum" class="def">maximum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#maximum" class="link">Source</a> <a href="#v:maximum" class="selflink">#</a></p><div class="doc"><pre>maximum = Fold.maximumBy compare
</pre><p>Determine the maximum element in a stream.</p><p>Compare with <code>Fold.foldMap Max</code>.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:minimumBy" class="def">minimumBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; a -&gt; <a href="../base-4.16.4.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#minimumBy" class="link">Source</a> <a href="#v:minimumBy" class="selflink">#</a></p><div class="doc"><p>Computes the minimum element with respect to the given comparison function</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:minimum" class="def">minimum</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#minimum" class="link">Source</a> <a href="#v:minimum" class="selflink">#</a></p><div class="doc"><p>Determine the minimum element in a stream using the supplied comparison
 function.</p><pre>minimum = <code><a href="Streamly-Data-Fold.html#v:minimumBy" title="Streamly.Data.Fold">minimumBy</a></code> compare
</pre><p>Compare with <code>Fold.foldMap Min</code>.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:mean" class="def">mean</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#mean" class="link">Source</a> <a href="#v:mean" class="selflink">#</a></p><div class="doc"><p>Compute a numerically stable arithmetic mean of all elements in the input
 stream.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:variance" class="def">variance</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#variance" class="link">Source</a> <a href="#v:variance" class="selflink">#</a></p><div class="doc"><p>Compute a numerically stable (population) variance over all elements in
 the input stream.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:stdDev" class="def">stdDev</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Numeric.html#t:Floating" title="Numeric">Floating</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a a <a href="src/Streamly.Internal.Data.Fold.html#stdDev" class="link">Source</a> <a href="#v:stdDev" class="selflink">#</a></p><div class="doc"><p>Compute a numerically stable (population) standard deviation over all
 elements in the input stream.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:rollingHash" class="def">rollingHash</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Enum" title="Prelude">Enum</a> a) =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> <a href="src/Streamly.Internal.Data.Fold.html#rollingHash" class="link">Source</a> <a href="#v:rollingHash" class="selflink">#</a></p><div class="doc"><p>Compute an <code><a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a></code> sized polynomial rolling hash of a stream.</p><pre>rollingHash = Fold.rollingHashWithSalt defaultSalt</pre><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:rollingHashWithSalt" class="def">rollingHashWithSalt</a> :: (<a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.16.4.0/Prelude.html#t:Enum" title="Prelude">Enum</a> a) =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> <a href="src/Streamly.Internal.Data.Fold.html#rollingHashWithSalt" class="link">Source</a> <a href="#v:rollingHashWithSalt" class="selflink">#</a></p><div class="doc"><p>Compute an <code><a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a></code> sized polynomial rolling hash</p><pre>H = salt * k ^ n + c1 * k ^ (n - 1) + c2 * k ^ (n - 2) + ... + cn * k ^ 0</pre><p>Where <code>c1</code>, <code>c2</code>, <code>cn</code> are the elements in the input stream and <code>k</code> is a
 constant.</p><p>This hash is often used in Rabin-Karp string search algorithm.</p><p>See <a href="https://en.wikipedia.org/wiki/Rolling_hash">https://en.wikipedia.org/wiki/Rolling_hash</a></p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:toList" class="def">toList</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [a] <a href="src/Streamly.Internal.Data.Fold.Type.html#toList" class="link">Source</a> <a href="#v:toList" class="selflink">#</a></p><div class="doc"><p>Folds the input stream to a list.</p><p><em>Warning!</em> working on large lists accumulated as buffers in memory could be
 very inefficient, consider using <a href="Streamly-Data-Array-Foreign.html">Streamly.Data.Array.Foreign</a>
 instead.</p><pre>toList = foldr (:) []</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:toListRev" class="def">toListRev</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [a] <a href="src/Streamly.Internal.Data.Fold.html#toListRev" class="link">Source</a> <a href="#v:toListRev" class="selflink">#</a></p><div class="doc"><p>Buffers the input stream to a list in the reverse order of the input.</p><pre>toListRev = Fold.foldl' (flip (:)) []</pre><p><em>Warning!</em> working on large lists accumulated as buffers in memory could be
 very inefficient, consider using <a href="Streamly-Array.html">Streamly.Array</a> instead.</p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:5" id="g:5"><h2>Terminating Folds</h2></a><div class="doc"><p>These are much like lazy right folds.</p></div><div class="top"><p class="src"><a id="v:index" class="def">index</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#index" class="link">Source</a> <a href="#v:index" class="selflink">#</a></p><div class="doc"><p>Lookup the element at the given index.</p><p>See also: <code><a href="Streamly-Prelude.html#v:-33--33-" title="Streamly.Prelude">!!</a></code></p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:head" class="def">head</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#head" class="link">Source</a> <a href="#v:head" class="selflink">#</a></p><div class="doc"><p>Extract the first element of the stream, if any.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:find" class="def">find</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/Streamly.Internal.Data.Fold.html#find" class="link">Source</a> <a href="#v:find" class="selflink">#</a></p><div class="doc"><p>Returns the first element that satisfies the given predicate.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:lookup" class="def">lookup</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (a, b) (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b) <a href="src/Streamly.Internal.Data.Fold.html#lookup" class="link">Source</a> <a href="#v:lookup" class="selflink">#</a></p><div class="doc"><p>In a stream of (key-value) pairs <code>(a, b)</code>, return the value <code>b</code> of the
 first pair where the key equals the given value <code>a</code>.</p><pre>lookup = snd &lt;$&gt; Fold.find ((==) . fst)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:findIndex" class="def">findIndex</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) <a href="src/Streamly.Internal.Data.Fold.html#findIndex" class="link">Source</a> <a href="#v:findIndex" class="selflink">#</a></p><div class="doc"><p>Returns the first index that satisfies the given predicate.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:elemIndex" class="def">elemIndex</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a>) <a href="src/Streamly.Internal.Data.Fold.html#elemIndex" class="link">Source</a> <a href="#v:elemIndex" class="selflink">#</a></p><div class="doc"><p>Returns the first index where a given value is found in the stream.</p><pre>elemIndex a = Fold.findIndex (== a)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:null" class="def">null</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#null" class="link">Source</a> <a href="#v:null" class="selflink">#</a></p><div class="doc"><p>Return <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if the input stream is empty.</p><pre>null = fmap isJust Fold.head</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:elem" class="def">elem</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#elem" class="link">Source</a> <a href="#v:elem" class="selflink">#</a></p><div class="doc"><p>Return <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if the given element is present in the stream.</p><pre>elem a = Fold.any (== a)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:notElem" class="def">notElem</a> :: (<a href="../base-4.16.4.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#notElem" class="link">Source</a> <a href="#v:notElem" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if the given element is not present in the stream.</p><pre>notElem a = Fold.all (/= a)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:all" class="def">all</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#all" class="link">Source</a> <a href="#v:all" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if all elements of a stream satisfy a predicate.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.all (== 0)) $ Stream.fromList [1,0,1]
</code></strong>False
</pre><pre>all p = Fold.lmap p Fold.and</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:any" class="def">any</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#any" class="link">Source</a> <a href="#v:any" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if any of the elements of a stream satisfies a predicate.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.any (== 0)) $ Stream.fromList [1,0,1]
</code></strong>True
</pre><pre>any p = Fold.lmap p Fold.or</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:and" class="def">and</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#and" class="link">Source</a> <a href="#v:and" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if all elements are <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code>, <code><a href="../base-4.16.4.0/Data-Bool.html#v:False" title="Data.Bool">False</a></code> otherwise</p><pre>and = Fold.all (== True)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:or" class="def">or</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Streamly.Internal.Data.Fold.html#or" class="link">Source</a> <a href="#v:or" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if any element is <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code>, <code><a href="../base-4.16.4.0/Data-Bool.html#v:False" title="Data.Bool">False</a></code> otherwise</p><pre>or = Fold.any (== True)</pre><p><em>Since: 0.7.0</em></p></div></div><a href="#g:6" id="g:6"><h1>Combinators</h1></a><div class="doc"><p>Combinators are modifiers of folds.  In the type <code>Fold m a b</code>, <code>a</code> is
 the input type and <code>b</code> is the output type.  Transformations can be
 applied either on the input side or on the output side.  Therefore,
 combinators are of one of the following general shapes:</p><ul><li><code>... -&gt; Fold m a b -&gt; Fold m c b</code> (input transformation)</li><li><code>... -&gt; Fold m a b -&gt; Fold m a c</code> (output transformation)</li></ul><p>Output transformations are also known as covariant transformations, and
 input transformations are also known as contravariant transformations.
 The input side transformations are more interesting for folds.  Most of
 the following sections describe the input transformation operations on a
 fold.  The names and signatures of the operations are consistent with
 corresponding operations in <a href="Streamly-Prelude.html">Streamly.Prelude</a>. When an operation makes
 sense on both input and output side we use the prefix <code>l</code> (for left) for
 input side operations and the prefix <code>r</code> (for right) for output side
 operations.</p></div><a href="#g:7" id="g:7"><h2>Mapping on output</h2></a><div class="doc"><p>The <code><a href="../base-4.16.4.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a></code> instance of a fold maps on the output of the fold:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (fmap show Fold.sum) (Stream.enumerateFromTo 1 100)
</code></strong>&quot;5050&quot;
</pre></div><div class="top"><p class="src"><a id="v:rmapM" class="def">rmapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; m c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c <a href="src/Streamly.Internal.Data.Fold.Type.html#rmapM" class="link">Source</a> <a href="#v:rmapM" class="selflink">#</a></p><div class="doc"><p>Map a monadic function on the output of a fold.</p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:8" id="g:8"><h2>Mapping on Input</h2></a><div class="top"><p class="src"><a id="v:lmap" class="def">lmap</a> :: (a -&gt; b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r <a href="src/Streamly.Internal.Data.Fold.Type.html#lmap" class="link">Source</a> <a href="#v:lmap" class="selflink">#</a></p><div class="doc"><p><code>lmap f fold</code> maps the function <code>f</code> on the input of the fold.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.lmap (\x -&gt; x * x) Fold.sum) (Stream.enumerateFromTo 1 100)
</code></strong>338350
</pre><pre>lmap = Fold.lmapM return</pre><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:lmapM" class="def">lmapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r <a href="src/Streamly.Internal.Data.Fold.Type.html#lmapM" class="link">Source</a> <a href="#v:lmapM" class="selflink">#</a></p><div class="doc"><p><code>lmapM f fold</code> maps the monadic function <code>f</code> on the input of the fold.</p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:9" id="g:9"><h2>Filtering</h2></a><div class="top"><p class="src"><a id="v:filter" class="def">filter</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r <a href="src/Streamly.Internal.Data.Fold.Type.html#filter" class="link">Source</a> <a href="#v:filter" class="selflink">#</a></p><div class="doc"><p>Include only those elements that pass a predicate.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.filter (&gt; 5) Fold.sum) $ Stream.fromList [1..10]
</code></strong>40
</pre><pre>filter f = Fold.filterM (return . f)</pre><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:filterM" class="def">filterM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; m <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r <a href="src/Streamly.Internal.Data.Fold.Type.html#filterM" class="link">Source</a> <a href="#v:filterM" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Streamly-Data-Fold.html#v:filter" title="Streamly.Data.Fold">filter</a></code> but with a monadic predicate.</p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:catMaybes" class="def">catMaybes</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (<a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) b <a href="src/Streamly.Internal.Data.Fold.Type.html#catMaybes" class="link">Source</a> <a href="#v:catMaybes" class="selflink">#</a></p><div class="doc"><p>Modify a fold to receive a <code><a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a></code> input, the <code><a href="../base-4.16.4.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code> values are unwrapped
 and sent to the original fold, <code><a href="../base-4.16.4.0/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> values are discarded.</p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:mapMaybe" class="def">mapMaybe</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b r -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a r <a href="src/Streamly.Internal.Data.Fold.html#mapMaybe" class="link">Source</a> <a href="#v:mapMaybe" class="selflink">#</a></p><div class="doc"><p><code>mapMaybe f fold</code> maps a <code><a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a></code> returning function <code>f</code> on the input of
 the fold, filters out <code><a href="../base-4.16.4.0/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> elements, and return the values extracted
 from <code><a href="../base-4.16.4.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f x = if even x then Just x else Nothing
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fld = Fold.mapMaybe f Fold.toList
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold fld (Stream.enumerateFromTo 1 10)
</code></strong>[2,4,6,8,10]
</pre><p><em>Since: 0.8.0</em></p></div></div><a href="#g:10" id="g:10"><h2>Trimming</h2></a><div class="top"><p class="src"><a id="v:take" class="def">take</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.Type.html#take" class="link">Source</a> <a href="#v:take" class="selflink">#</a></p><div class="doc"><p>Take at most <code>n</code> input elements and fold them using the supplied fold. A
 negative count is treated as 0.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.take 2 Fold.toList) $ Stream.fromList [1..10]
</code></strong>[1,2]
</pre><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:takeEndBy_" class="def">takeEndBy_</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.html#takeEndBy_" class="link">Source</a> <a href="#v:takeEndBy_" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Streamly-Data-Fold.html#v:takeEndBy" title="Streamly.Data.Fold">takeEndBy</a></code> but drops the element on which the predicate succeeds.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.takeEndBy_ (== '\n') Fold.toList) $ Stream.fromList &quot;hello\nthere\n&quot;
</code></strong>&quot;hello&quot;
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.toList $ Stream.foldMany (Fold.takeEndBy_ (== '\n') Fold.toList) $ Stream.fromList &quot;hello\nthere\n&quot;
</code></strong>[&quot;hello&quot;,&quot;there&quot;]
</pre><pre>Stream.splitOnSuffix p f = Stream.foldMany (Fold.takeEndBy_ p f)</pre><p>See <code><a href="Streamly-Prelude.html#v:splitOnSuffix" title="Streamly.Prelude">splitOnSuffix</a></code> for more details on splitting a
 stream using <code><a href="Streamly-Data-Fold.html#v:takeEndBy_" title="Streamly.Data.Fold">takeEndBy_</a></code>.</p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:takeEndBy" class="def">takeEndBy</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.html#takeEndBy" class="link">Source</a> <a href="#v:takeEndBy" class="selflink">#</a></p><div class="doc"><p>Take the input, stop when the predicate succeeds taking the succeeding
 element as well.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.takeEndBy (== '\n') Fold.toList) $ Stream.fromList &quot;hello\nthere\n&quot;
</code></strong>&quot;hello\n&quot;
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.toList $ Stream.foldMany (Fold.takeEndBy (== '\n') Fold.toList) $ Stream.fromList &quot;hello\nthere\n&quot;
</code></strong>[&quot;hello\n&quot;,&quot;there\n&quot;]
</pre><pre>Stream.splitWithSuffix p f = Stream.foldMany (Fold.takeEndBy p f)</pre><p>See <code><a href="Streamly-Prelude.html#v:splitWithSuffix" title="Streamly.Prelude">splitWithSuffix</a></code> for more details on splitting a
 stream using <code><a href="Streamly-Data-Fold.html#v:takeEndBy" title="Streamly.Data.Fold">takeEndBy</a></code>.</p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:11" id="g:11"><h2>Serial Append</h2></a><div class="top"><p class="src"><a id="v:serialWith" class="def">serialWith</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x c <a href="src/Streamly.Internal.Data.Fold.Type.html#serialWith" class="link">Source</a> <a href="#v:serialWith" class="selflink">#</a></p><div class="doc"><p>Sequential fold application. Apply two folds sequentially to an input
 stream.  The input is provided to the first fold, when it is done - the
 remaining input is provided to the second fold. When the second fold is done
 or if the input stream is over, the outputs of the two folds are combined
 using the supplied function.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f = Fold.serialWith (,) (Fold.take 8 Fold.toList) (Fold.takeEndBy (== '\n') Fold.toList)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold f $ Stream.fromList &quot;header: hello\n&quot;
</code></strong>(&quot;header: &quot;,&quot;hello\n&quot;)
</pre><p>Note: This is dual to appending streams using <code><a href="Streamly-Prelude.html#v:serial" title="Streamly.Prelude">serial</a></code>.</p><p>Note: this implementation allows for stream fusion but has quadratic time
 complexity, because each composition adds a new branch that each subsequent
 fold's input element has to traverse, therefore, it cannot scale to a large
 number of compositions. After around 100 compositions the performance starts
 dipping rapidly compared to a CPS style implementation.</p><p><em>Time: O(n^2) where n is the number of compositions.</em></p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:12" id="g:12"><h2>Parallel Distribution</h2></a><div class="doc"><p>For applicative composition using distribution see
 <a href="Streamly-Internal-Data-Fold-Tee.html">Streamly.Internal.Data.Fold.Tee</a>.</p></div><div class="top"><p class="src"><a id="v:teeWith" class="def">teeWith</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (a -&gt; b -&gt; c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x a -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m x c <a href="src/Streamly.Internal.Data.Fold.Type.html#teeWith" class="link">Source</a> <a href="#v:teeWith" class="selflink">#</a></p><div class="doc"><p><code>teeWith k f1 f2</code> distributes its input to both <code>f1</code> and <code>f2</code> until both
 of them terminate and combines their output using <code>k</code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>avg = Fold.teeWith (/) Fold.sum (fmap fromIntegral Fold.length)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold avg $ Stream.fromList [1.0..100.0]
</code></strong>50.5
</pre><pre>teeWith k f1 f2 = fmap (uncurry k) ((Fold.tee f1 f2)</pre><p>For applicative composition using this combinator see
 <a href="Streamly-Internal-Data-Fold-Tee.html">Streamly.Internal.Data.Fold.Tee</a>.</p><p>See also: <a href="Streamly-Internal-Data-Fold-Tee.html">Streamly.Internal.Data.Fold.Tee</a></p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:tee" class="def">tee</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (b, c) <a href="src/Streamly.Internal.Data.Fold.html#tee" class="link">Source</a> <a href="#v:tee" class="selflink">#</a></p><div class="doc"><p>Distribute one copy of the stream to each fold and zip the results.</p><pre>                |-------Fold m a b--------|
---stream m a---|                         |---m (b,c)
                |-------Fold m a c--------|
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.tee Fold.sum Fold.length) (Stream.enumerateFromTo 1.0 100.0)
</code></strong>(5050.0,100)
</pre><pre>tee = teeWith (,)</pre><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:distribute" class="def">distribute</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; [<a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b] -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a [b] <a href="src/Streamly.Internal.Data.Fold.html#distribute" class="link">Source</a> <a href="#v:distribute" class="selflink">#</a></p><div class="doc"><p>Distribute one copy of the stream to each fold and collect the results in
 a container.</p><pre>
                |-------Fold m a b--------|
---stream m a---|                         |---m [b]
                |-------Fold m a b--------|
                |                         |
                           ...
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.distribute [Fold.sum, Fold.length]) (Stream.enumerateFromTo 1 5)
</code></strong>[15,5]
</pre><pre>distribute = Prelude.foldr (Fold.teeWith (:)) (Fold.fromPure [])</pre><p>This is the consumer side dual of the producer side <code><a href="Streamly-Data-Fold.html#v:sequence" title="Streamly.Data.Fold">sequence</a></code> operation.</p><p>Stops when all the folds stop.</p><p><em>Since: 0.7.0</em></p></div></div><a href="#g:13" id="g:13"><h2>Partitioning</h2></a><div class="doc"><p>Direct items in the input stream to different folds using a binary
 fold selector.</p></div><div class="top"><p class="src"><a id="v:partition" class="def">partition</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b x -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m c y -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (<a href="../base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> b c) (x, y) <a href="src/Streamly.Internal.Data.Fold.html#partition" class="link">Source</a> <a href="#v:partition" class="selflink">#</a></p><div class="doc"><p>Compose two folds such that the combined fold accepts a stream of <code><a href="../base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a></code>
 and routes the <code><a href="../base-4.16.4.0/Data-Either.html#v:Left" title="Data.Either">Left</a></code> values to the first fold and <code><a href="../base-4.16.4.0/Data-Either.html#v:Right" title="Data.Either">Right</a></code> values to the
 second fold.</p><pre>partition = partitionBy id</pre><p><em>Since: 0.7.0</em></p></div></div><a href="#g:14" id="g:14"><h2>Unzipping</h2></a><div class="top"><p class="src"><a id="v:unzip" class="def">unzip</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a x -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b y -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m (a, b) (x, y) <a href="src/Streamly.Internal.Data.Fold.html#unzip" class="link">Source</a> <a href="#v:unzip" class="selflink">#</a></p><div class="doc"><p>Send the elements of tuples in a stream of tuples through two different
 folds.</p><pre>
                          |-------Fold m a x--------|
---------stream of (a,b)--|                         |----m (x,y)
                          |-------Fold m b y--------|

</pre><pre>unzip = Fold.unzipWith id</pre><p>This is the consumer side dual of the producer side <code><a href="Streamly-Internal-Data-Fold.html#v:zip" title="Streamly.Internal.Data.Fold">zip</a></code> operation.</p><p><em>Since: 0.7.0</em></p></div></div><a href="#g:15" id="g:15"><h2>Splitting</h2></a><div class="top"><p class="src"><a id="v:many" class="def">many</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c <a href="src/Streamly.Internal.Data.Fold.Type.html#many" class="link">Source</a> <a href="#v:many" class="selflink">#</a></p><div class="doc"><p>Collect zero or more applications of a fold.  <code>many split collect</code> applies
 the <code>split</code> fold repeatedly on the input stream and accumulates zero or more
 fold results using <code>collect</code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>two = Fold.take 2 Fold.toList
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>twos = Fold.many two Fold.toList
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold twos $ Stream.fromList [1..10]
</code></strong>[[1,2],[3,4],[5,6],[7,8],[9,10]]
</pre><p>Stops when <code>collect</code> stops.</p><p>See also: <code><a href="Streamly-Prelude.html#v:concatMap" title="Streamly.Prelude">concatMap</a></code>, <code><a href="Streamly-Prelude.html#v:foldMany" title="Streamly.Prelude">foldMany</a></code></p><p><em>Since: 0.8.0</em></p></div></div><div class="top"><p class="src"><a id="v:chunksOf" class="def">chunksOf</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m b c -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c <a href="src/Streamly.Internal.Data.Fold.Type.html#chunksOf" class="link">Source</a> <a href="#v:chunksOf" class="selflink">#</a></p><div class="doc"><p><code>chunksOf n split collect</code> repeatedly applies the <code>split</code> fold to chunks
 of <code>n</code> items in the input stream and supplies the result to the <code>collect</code>
 fold.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>twos = Fold.chunksOf 2 Fold.toList Fold.toList
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold twos $ Stream.fromList [1..10]
</code></strong>[[1,2],[3,4],[5,6],[7,8],[9,10]]
</pre><pre>chunksOf n split = many (take n split)</pre><p>Stops when <code>collect</code> stops.</p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:16" id="g:16"><h2>Nesting</h2></a><div class="top"><p class="src"><a id="v:concatMap" class="def">concatMap</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c <a href="src/Streamly.Internal.Data.Fold.Type.html#concatMap" class="link">Source</a> <a href="#v:concatMap" class="selflink">#</a></p><div class="doc"><p>Map a <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> returning function on the result of a <code><a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a></code> and run the
 returned fold. This operation can be used to express data dependencies
 between fold operations.</p><p>Let's say the first element in the stream is a count of the following
 elements that we have to add, then:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import Data.Maybe (fromJust)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>count = fmap fromJust Fold.head
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>total n = Fold.take n Fold.sum
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Stream.fold (Fold.concatMap total count) $ Stream.fromList [10,9..1]
</code></strong>45
</pre><p><em>Time: O(n^2) where <code>n</code> is the number of compositions.</em></p><p>See also: <code><a href="Streamly-Internal-Data-Stream-IsStream.html#v:foldIterateM" title="Streamly.Internal.Data.Stream.IsStream">foldIterateM</a></code></p><p><em>Since: 0.8.0</em></p></div></div><a href="#g:17" id="g:17"><h1>Deprecated</h1></a><div class="top"><p class="src"><a id="v:sequence" class="def">sequence</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a (m b) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b <a href="src/Streamly.Internal.Data.Fold.html#sequence" class="link">Source</a> <a href="#v:sequence" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: Use &quot;rmapM id&quot; instead</p></div><p>Flatten the monadic output of a fold to pure output.</p><p><em>Since: 0.7.0</em></p></div></div><div class="top"><p class="src"><a id="v:mapM" class="def">mapM</a> :: <a href="../base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (b -&gt; m c) -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a b -&gt; <a href="Streamly-Data-Fold.html#t:Fold" title="Streamly.Data.Fold">Fold</a> m a c <a href="src/Streamly.Internal.Data.Fold.html#mapM" class="link">Source</a> <a href="#v:mapM" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: Use rmapM instead</p></div><p>Map a monadic function on the output of a fold.</p><p><em>Since: 0.7.0</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>